(self.webpackChunk_3nRow=self.webpackChunk_3nRow||[]).push([[767],{408:function(e,t){function n(e,t){t.headers=e.headers||{},t.statusMessage=e.statusText,t.statusCode=e.status,t.data=e.response}t.send=function(e,t,r){return new Promise((function(i,o){var s,a,c,u;r=r||{};var f=new XMLHttpRequest,h=r.headers||{};for(s in r.timeout&&(f.timeout=r.timeout),f.ontimeout=f.onerror=function(e){e.timeout="timeout"==e.type,o(e)},f.open(e,t.href||t),f.onload=function(){for(u=f.getAllResponseHeaders().trim().split(/[\r\n]+/),n(f,f);c=u.shift();)c=c.split(": "),f.headers[c.shift().toLowerCase()]=c.join(": ");if((c=f.headers["content-type"])&&~c.indexOf("application/json"))try{f.data=JSON.parse(f.data,r.reviver)}catch(e){return n(f,e),o(e)}(f.status>=400?o:i)(f)},(a=r.body)&&"object"==typeof a&&(h["content-type"]="application/json",a=JSON.stringify(a)),f.withCredentials=!!r.withCredentials,h)f.setRequestHeader(s,h[s]);f.send(a)}))},t.get=t.send.bind(t.send,"GET"),t.post=t.send.bind(t.send,"POST"),t.patch=t.send.bind(t.send,"PATCH"),t.del=t.send.bind(t.send,"DELETE"),t.put=t.send.bind(t.send,"PUT")},785:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.Reflection=t.ReflectionType=t.ReflectionField=void 0;var s=n(598),a=n(898),c=n(31),u=n(421),f=new s.Context,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),o([s.type("string",f)],t.prototype,"name",void 0),o([s.type("string",f)],t.prototype,"type",void 0),o([s.type("number",f)],t.prototype,"referencedType",void 0),t}(a.Schema);t.ReflectionField=h;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fields=new c.ArraySchema,t}return i(t,e),o([s.type("number",f)],t.prototype,"id",void 0),o([s.type([h],f)],t.prototype,"fields",void 0),t}(a.Schema);t.ReflectionType=l;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.types=new c.ArraySchema,t}return i(t,e),t.encode=function(e){var n=e.constructor,r=new t;r.rootType=n._typeid;var i=function(e,t){for(var n in t){var i=new h;i.name=n;var o=void 0;if("string"==typeof t[n])o=t[n];else{var s=t[n],c=void 0;a.Schema.is(s)?(o="ref",c=t[n]):"string"==typeof s[o=Object.keys(s)[0]]?o+=":"+s[o]:c=s[o],i.referencedType=c?c._typeid:-1}i.type=o,e.fields.push(i)}r.types.push(e)},o=n._context.types;for(var s in o){var c=new l;c.id=Number(s),i(c,o[s]._definition.schema)}return r.encodeAll()},t.decode=function(e,n){var r=new s.Context,o=new t;o.decode(e,n);var c=o.types.reduce((function(e,t){var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(a.Schema),o=t.id;return e[o]=n,r.add(n,o),e}),{});o.types.forEach((function(e){var t=c[e.id];e.fields.forEach((function(e){var n;if(void 0!==e.referencedType){var i=e.type,o=c[e.referencedType];if(!o){var a=e.type.split(":");i=a[0],o=a[1]}"ref"===i?s.type(o,r)(t.prototype,e.name):s.type(((n={})[i]=o,n),r)(t.prototype,e.name)}else s.type(e.type,r)(t.prototype,e.name)}))}));var f=c[o.rootType],h=new f;for(var l in f._definition.schema){var p=f._definition.schema[l];"string"!=typeof p&&(h[l]="function"==typeof p?new p:new(u.getType(Object.keys(p)[0]).constructor))}return h},o([s.type([l],f)],t.prototype,"types",void 0),o([s.type("number",f)],t.prototype,"rootType",void 0),t}(a.Schema);t.Reflection=p},898:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.Schema=void 0;var s=n(787),a=n(598),c=n(163),u=n(357),f=n(31),h=n(582),l=n(611),p=n(317),d=n(377),y=n(624),v=n(376),g=n(421),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(Error);function _(e,t,n,r){if(!(e instanceof t))throw new m("a '"+t.name+"' was expected, but '"+e.constructor.name+"' was provided in "+n.constructor.name+"#"+r)}function b(e,t,n,r,i){!function(e,t,n,r){var i,o=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":i="number",isNaN(e)&&console.log('trying to encode "NaN" in '+n.constructor.name+"#"+r);break;case"string":i="string",o=!0;break;case"boolean":return}if(typeof e!==i&&(!o||o&&null!==e)){var s="'"+JSON.stringify(e)+"'"+(e&&e.constructor&&" ("+e.constructor.name+")"||"");throw new m("a '"+i+"' was expected, but "+s+" was provided in "+n.constructor.name+"#"+r)}}(n,e,r,i);var o=c[e];if(!o)throw new m("a '"+e+"' was expected, but "+n+" was provided in "+r.constructor.name+"#"+i);o(t,n)}function w(e,t,n){return u[e](t,n)}var O=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object.defineProperties(this,{$changes:{value:new d.ChangeTree(this,void 0,new d.Root),enumerable:!1,writable:!0},$listeners:{value:{},enumerable:!1,writable:!0}});var n=this._definition.descriptors;n&&Object.defineProperties(this,n),e[0]&&this.assign(e[0])}return e.onError=function(e){console.error(e)},e.is=function(e){return e._definition&&void 0!==e._definition.schema},e.prototype.assign=function(e){return Object.assign(this,e),this},Object.defineProperty(e.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),e.prototype.listen=function(e,t){var n=this;return this.$listeners[e]||(this.$listeners[e]=new y.EventEmitter),this.$listeners[e].register(t),function(){return n.$listeners[e].remove(t)}},e.prototype.decode=function(t,n,r,i){void 0===n&&(n={offset:0}),void 0===r&&(r=this),void 0===i&&(i=new Map);var a=this.$changes.root,c=t.length,d=0,y=[];for(a.refs.set(d,this),i.set(d,y);n.offset<c;){var v=t[n.offset++];if(v!=s.SWITCH_TO_STRUCTURE){var m=r.$changes,_=void 0!==r._definition,b=_?v>>6<<6:v;if(b!==s.OPERATION.CLEAR){var O=_?v%(b||255):u.number(t,n),A=_?r._definition.fieldsByIndex[O]:"",E=m.getType(O),I=void 0,$=void 0,S=void 0;if(_?$=r["_"+A]:($=r.getByIndex(O),(b&s.OPERATION.ADD)===s.OPERATION.ADD?(S=r instanceof h.MapSchema?u.string(t,n):O,r.setIndex(O,S)):S=r.getIndex(O)),(b&s.OPERATION.DELETE)===s.OPERATION.DELETE&&(b!==s.OPERATION.DELETE_AND_ADD&&r.deleteByIndex(O),$&&$.$changes&&a.removeRef($.$changes.refId),I=null),void 0!==A){if(b===s.OPERATION.DELETE);else if(e.is(E)){var P=u.number(t,n);if(I=a.refs.get(P),b!==s.OPERATION.REPLACE){var C=this.getSchemaType(t,n,E);I||((I=this.createTypeInstance(C)).$changes.refId=P,$&&(I.onChange=$.onChange,I.onRemove=$.onRemove,I.$listeners=$.$listeners,$.$changes.refId&&P!==$.$changes.refId&&a.removeRef($.$changes.refId))),a.addRef(P,I,I!==$)}}else if("string"==typeof E)I=w(E,t,n);else{var x=g.getType(Object.keys(E)[0]),R=u.number(t,n),T=a.refs.has(R)?$:new x.constructor;if((I=T.clone(!0)).$changes.refId=R,$&&(I.onAdd=$.onAdd,I.onRemove=$.onRemove,I.onChange=$.onChange,$.$changes.refId&&R!==$.$changes.refId)){a.removeRef($.$changes.refId);for(var M=[],k=$.entries(),j=void 0;(j=k.next())&&!j.done;){var N=o(j.value,2),D=N[0],U=N[1];M.push({op:s.OPERATION.DELETE,field:D,value:void 0,previousValue:U})}i.set($.$changes.refId,M)}a.addRef(R,I,T!==$),x.getProxy&&(I=x.getProxy(I))}var L=$!==I;if(null!=I)if(I.$changes&&I.$changes.setParent(m.ref,m.root,O),r instanceof e)r[A]=I;else if(r instanceof h.MapSchema)D=S,r.$items.set(D,I);else if(r instanceof f.ArraySchema)r.setAt(O,I);else if(r instanceof l.CollectionSchema||r instanceof p.SetSchema){var z=r.add(I);r.setIndex(O,z)}L&&y.push({op:b,field:A,dynamicIndex:S,value:I,previousValue:$})}else{console.warn("@colyseus/schema: definition mismatch");for(var F={offset:n.offset};n.offset<c&&(!u.switchStructureCheck(t,n)||(F.offset=n.offset+1,!a.refs.has(u.number(t,F))));)n.offset++}}else r.clear(!0)}else{d=u.number(t,n);var B=a.refs.get(d);if(!B)throw new Error('"refId" not found: '+d);r=B,y=[],i.set(d,y)}}return this._triggerChanges(i),a.garbageCollectDeletedRefs(),i},e.prototype.encode=function(t,n,r){void 0===t&&(t=!1),void 0===n&&(n=[]),void 0===r&&(r=!1);for(var i=this.$changes,o=new WeakSet,a=[i],u=1,f=0;f<u;f++){var l=a[f],p=l.ref,d=p instanceof e;l.ensureRefId(),o.add(l),l!==i&&(l.changed||t)&&(c.uint8(n,s.SWITCH_TO_STRUCTURE),c.number(n,l.refId));for(var y=t?Array.from(l.allChanges):Array.from(l.changes.values()),v=0,m=y.length;v<m;v++){var w=t?{op:s.OPERATION.ADD,index:y[v]}:y[v],O=w.index,A=d?p._definition.fieldsByIndex&&p._definition.fieldsByIndex[O]:O,E=n.length;if(w.op!==s.OPERATION.TOUCH)if(d)c.uint8(n,O|w.op);else{if(c.uint8(n,w.op),w.op===s.OPERATION.CLEAR)continue;c.number(n,O)}if(!d&&(w.op&s.OPERATION.ADD)==s.OPERATION.ADD&&p instanceof h.MapSchema){var I=l.ref.$indexes.get(O);c.string(n,I)}if(w.op!==s.OPERATION.DELETE){var $=l.getType(O),S=l.getValue(O);if(S&&S.$changes&&!o.has(S.$changes)&&(a.push(S.$changes),S.$changes.ensureRefId(),u++),w.op!==s.OPERATION.TOUCH){if(e.is($))_(S,$,p,A),c.number(n,S.$changes.refId),(w.op&s.OPERATION.ADD)===s.OPERATION.ADD&&this.tryEncodeTypeId(n,$,S.constructor);else if("string"==typeof $)b($,n,S,p,A);else{var P=g.getType(Object.keys($)[0]);_(p["_"+A],P.constructor,p,A),c.number(n,S.$changes.refId)}r&&l.cache(O,n.slice(E))}}}t||r||l.discard()}return n},e.prototype.encodeAll=function(e){return this.encode(!0,[],e)},e.prototype.applyFilters=function(t,n){void 0===n&&(n=!1);for(var r=this,i=new Set,o=v.ClientState.get(t),a=[this.$changes],u=1,f=[],l=function(l){var p=a[l];if(i.has(p.refId))return"continue";var d=p.ref,y=d instanceof e;c.uint8(f,s.SWITCH_TO_STRUCTURE),c.number(f,p.refId);var v=o.refIds.has(p),g=n||!v;o.addRefId(p);var m=o.containerIndexes.get(p),_=g?Array.from(p.allChanges):Array.from(p.changes.values());!n&&y&&d._definition.indexesWithFilters&&d._definition.indexesWithFilters.forEach((function(e){!m.has(e)&&p.allChanges.has(e)&&(g?_.push(e):_.push({op:s.OPERATION.ADD,index:e}))}));for(var b=0,w=_.length;b<w;b++){var O=g?{op:s.OPERATION.ADD,index:_[b]}:_[b];if(O.op!==s.OPERATION.CLEAR){var A=O.index;if(O.op!==s.OPERATION.DELETE){var E=p.getValue(A),I=p.getType(A);if(y){if(($=d._definition.filters&&d._definition.filters[A])&&!$.call(d,t,E,r)){E&&E.$changes&&i.add(E.$changes.refId);continue}}else{var $,S=p.parent;if(($=p.getChildrenFilter())&&!$.call(S,t,d.$indexes.get(A),E,r)){E&&E.$changes&&i.add(E.$changes.refId);continue}}if(E.$changes&&(a.push(E.$changes),u++),O.op!==s.OPERATION.TOUCH)if(O.op===s.OPERATION.ADD||y)f=f.concat(p.caches[A]),m.add(A);else if(m.has(A))f=f.concat(p.caches[A]);else{if(m.add(A),c.uint8(f,s.OPERATION.ADD),c.number(f,A),d instanceof h.MapSchema){var P=p.ref.$indexes.get(A);c.string(f,P)}E.$changes?c.number(f,E.$changes.refId):c[I](f,E)}else E.$changes&&!y&&(c.uint8(f,s.OPERATION.ADD),c.number(f,A),d instanceof h.MapSchema&&(P=p.ref.$indexes.get(A),c.string(f,P)),c.number(f,E.$changes.refId))}else y?c.uint8(f,O.op|A):(c.uint8(f,O.op),c.number(f,A))}else c.uint8(f,O.op)}},p=0;p<u;p++)l(p);return f},e.prototype.clone=function(){var e=new this.constructor,t=this._definition.schema;for(var n in t)"object"==typeof this[n]&&"function"==typeof this[n].clone?e[n]=this[n].clone():e[n]=this[n];return e},e.prototype.triggerAll=function(){if(0!==this.$changes.root.refs.size){var t=new Map;e.prototype._triggerAllFillChanges.call(this,this,t);try{e.prototype._triggerChanges.call(this,t)}catch(t){e.onError(t)}}},e.prototype.toJSON=function(){var e=this._definition.schema,t=this._definition.deprecated,n={};for(var r in e)t[r]||null===this[r]||void 0===this[r]||(n[r]="function"==typeof this[r].toJSON?this[r].toJSON():this["_"+r]);return n},e.prototype.discardAllChanges=function(){this.$changes.discardAll()},e.prototype.getByIndex=function(e){return this[this._definition.fieldsByIndex[e]]},e.prototype.deleteByIndex=function(e){this[this._definition.fieldsByIndex[e]]=void 0},e.prototype.tryEncodeTypeId=function(e,t,n){t._typeid!==n._typeid&&(c.uint8(e,s.TYPE_ID),c.number(e,n._typeid))},e.prototype.getSchemaType=function(e,t,n){var r;return e[t.offset]===s.TYPE_ID&&(t.offset++,r=this.constructor._context.get(u.number(e,t))),r||n},e.prototype.createTypeInstance=function(e){var t=new e;return t.$changes.root=this.$changes.root,t},e.prototype._triggerAllFillChanges=function(t,n){if(!n.has(t.$changes.refId)){var r=[];if(n.set(t.$changes.refId||0,r),t instanceof e){var i=t._definition.schema;for(var a in i)void 0!==(l=t["_"+a])&&(r.push({op:s.OPERATION.ADD,field:a,value:l,previousValue:void 0}),void 0!==l.$changes&&e.prototype._triggerAllFillChanges.call(this,l,n))}else for(var c=t.entries(),u=void 0;(u=c.next())&&!u.done;){var f=o(u.value,2),h=f[0],l=f[1];r.push({op:s.OPERATION.ADD,field:h,dynamicIndex:h,value:l,previousValue:void 0}),void 0!==l.$changes&&e.prototype._triggerAllFillChanges.call(this,l,n)}}},e.prototype._triggerChanges=function(t){var n=this;t.forEach((function(t,r){var i,o,a,c,u,f,h,l,p,d,y,v;if(t.length>0){for(var g=n.$changes.root.refs.get(r),m=g instanceof e,_=0;_<t.length;_++){var b=t[_],w=g.$listeners&&g.$listeners[b.field];if(m||(b.op===s.OPERATION.ADD&&void 0===b.previousValue?null===(o=(i=g).onAdd)||void 0===o||o.call(i,b.value,null!==(a=b.dynamicIndex)&&void 0!==a?a:b.field):b.op===s.OPERATION.DELETE?void 0!==b.previousValue&&(null===(u=(c=g).onRemove)||void 0===u||u.call(c,b.previousValue,null!==(f=b.dynamicIndex)&&void 0!==f?f:b.field)):b.op===s.OPERATION.DELETE_AND_ADD?(void 0!==b.previousValue&&(null===(l=(h=g).onRemove)||void 0===l||l.call(h,b.previousValue,b.dynamicIndex)),null===(d=(p=g).onAdd)||void 0===d||d.call(p,b.value,b.dynamicIndex)):b.op!==s.OPERATION.REPLACE&&b.value===b.previousValue||null===(v=(y=g).onChange)||void 0===v||v.call(y,b.value,b.dynamicIndex)),(b.op&s.OPERATION.DELETE)===s.OPERATION.DELETE&&b.previousValue instanceof e&&b.previousValue.onRemove&&b.previousValue.onRemove(),w)try{w.invoke(b.value,b.previousValue)}catch(t){e.onError(t)}}if(m&&g.onChange)try{g.onChange(t)}catch(t){e.onError(t)}}}))},e._definition=a.SchemaDefinition.create(),e}();t.Schema=O},598:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.defineTypes=t.deprecated=t.filterChildren=t.filter=t.type=t.globalContext=t.Context=t.hasFilter=t.SchemaDefinition=void 0;var o=n(898),s=n(31),a=n(582),c=n(421),u=function(){function e(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return e.create=function(t){var n=new e;return n.schema=Object.assign({},t&&t.schema||{}),n.indexes=Object.assign({},t&&t.indexes||{}),n.fieldsByIndex=Object.assign({},t&&t.fieldsByIndex||{}),n.descriptors=Object.assign({},t&&t.descriptors||{}),n.deprecated=Object.assign({},t&&t.deprecated||{}),n},e.prototype.addField=function(e,t){var n=this.getNextFieldIndex();this.fieldsByIndex[n]=e,this.indexes[e]=n,this.schema[e]=Array.isArray(t)?{array:t[0]}:t},e.prototype.addFilter=function(e,t){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=t,this.indexesWithFilters.push(this.indexes[e]),!0},e.prototype.addChildrenFilter=function(e,t){var n=this.indexes[e],r=this.schema[e];if(c.getType(Object.keys(r)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[n]=t,!0;console.warn("@filterChildren: field '"+e+"' can't have children. Ignoring filter.")},e.prototype.getChildrenFilter=function(e){return this.childFilters&&this.childFilters[this.indexes[e]]},e.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},e}();t.SchemaDefinition=u,t.hasFilter=function(e){return e._context&&e._context.useFilters};var f=function(){function e(){this.types={},this.schemas=new Map,this.useFilters=!1}return e.prototype.has=function(e){return this.schemas.has(e)},e.prototype.get=function(e){return this.types[e]},e.prototype.add=function(e,t){void 0===t&&(t=this.schemas.size),e._definition=u.create(e._definition),e._typeid=t,this.types[t]=e,this.schemas.set(e,t)},e.create=function(t){return void 0===t&&(t=new e),function(e){return h(e,t)}},e}();function h(e,n){return void 0===n&&(n=t.globalContext),function(t,r){var c=t.constructor;c._context=n,n.has(c)||n.add(c);var u=c._definition;if(u.addField(r,e),!u.descriptors[r]){var f=s.ArraySchema.is(e),h=!f&&a.MapSchema.is(e);if("string"!=typeof e&&!o.Schema.is(e)){var l=Object.values(e)[0];"string"==typeof l||n.has(l)||n.add(l)}var p="_"+r;u.descriptors[p]={enumerable:!1,configurable:!1,writable:!0},u.descriptors[r]={get:function(){return this[p]},set:function(e){e!==this[p]&&(null!=e?(!f||e instanceof s.ArraySchema||(e=new(s.ArraySchema.bind.apply(s.ArraySchema,i([void 0],e)))),!h||e instanceof a.MapSchema||(e=new a.MapSchema(e)),void 0===e.$proxy&&(h?e=a.getMapProxy(e):f&&(e=s.getArrayProxy(e))),this.$changes.change(r),e.$changes&&e.$changes.setParent(this,this.$changes.root,this._definition.indexes[r])):this.$changes.delete(r),this[p]=e)},enumerable:!0,configurable:!0}}}}t.Context=f,t.globalContext=new f,t.type=h,t.filter=function(e){return function(t,n){var r=t.constructor;r._definition.addFilter(n,e)&&(r._context.useFilters=!0)}},t.filterChildren=function(e){return function(t,n){var r=t.constructor;r._definition.addChildrenFilter(n,e)&&(r._context.useFilters=!0)}},t.deprecated=function(e,n){return void 0===e&&(e=!0),void 0===n&&(n=t.globalContext),function(t,n){var r=t.constructor._definition;r.deprecated[n]=!0,e&&(r.descriptors[n]={get:function(){throw new Error(n+" is deprecated.")},set:function(e){},enumerable:!1,configurable:!0})}},t.defineTypes=function(e,n,r){for(var i in void 0===r&&(r=e._context||t.globalContext),n)h(n[i],r)(e.prototype,i);return e}},377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeTree=t.Root=void 0;var r=n(787),i=n(898),o=function(){function e(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return e.prototype.getNextUniqueId=function(){return this.nextUniqueId++},e.prototype.addRef=function(e,t,n){void 0===n&&(n=!0),this.refs.set(e,t),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1)},e.prototype.removeRef=function(e){this.refCounts[e]=this.refCounts[e]-1,this.deletedRefs.add(e)},e.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},e.prototype.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach((function(t){if(e.refCounts[t]<=0){var n=e.refs.get(t);if(n instanceof i.Schema)for(var r in n._definition.schema)"string"!=typeof n._definition.schema[r]&&n[r]&&n[r].$changes&&e.removeRef(n[r].$changes.refId);else{var o=n.$changes.parent._definition,s=o.schema[o.fieldsByIndex[n.$changes.parentIndex]];"function"==typeof Object.values(s)[0]&&Array.from(n.values()).forEach((function(t){return e.removeRef(t.$changes.refId)}))}e.refs.delete(t),delete e.refCounts[t]}})),this.deletedRefs.clear()},e}();t.Root=o;var s=function(){function e(e,t,n){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(t,n)}return e.prototype.setParent=function(e,t,n){var r=this;if(this.indexes||(this.indexes=this.ref instanceof i.Schema?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=n,t)if(this.root=t,this.ref instanceof i.Schema){var o=this.ref._definition;for(var s in o.schema){var a=this.ref[s];if(a&&a.$changes){var c=o.indexes[s];a.$changes.setParent(this.ref,t,c)}}}else"object"==typeof this.ref&&this.ref.forEach((function(e,t){if(e instanceof i.Schema){var n=e.$changes,o=r.ref.$changes.indexes[t];n.setParent(r.ref,r.root,o)}}))},e.prototype.operation=function(e){this.changes.set(--this.currentCustomOperation,e)},e.prototype.change=function(e,t){void 0===t&&(t=r.OPERATION.ADD);var n="number"==typeof e?e:this.indexes[e];this.assertValidIndex(n,e);var i=this.changes.get(n);i&&i.op!==r.OPERATION.DELETE&&i.op!==r.OPERATION.TOUCH||this.changes.set(n,{op:i&&i.op===r.OPERATION.DELETE?r.OPERATION.DELETE_AND_ADD:t,index:n}),this.allChanges.add(n),this.changed=!0,this.touchParents()},e.prototype.touch=function(e){var t="number"==typeof e?e:this.indexes[e];this.assertValidIndex(t,e),this.changes.has(t)||this.changes.set(t,{op:r.OPERATION.TOUCH,index:t}),this.allChanges.add(t),this.touchParents()},e.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},e.prototype.getType=function(e){if(this.ref._definition)return(t=this.ref._definition).schema[t.fieldsByIndex[e]];var t,n=(t=this.parent._definition).schema[t.fieldsByIndex[this.parentIndex]];return Object.values(n)[0]},e.prototype.getChildrenFilter=function(){var e=this.parent._definition.childFilters;return e&&e[this.parentIndex]},e.prototype.getValue=function(e){return this.ref.getByIndex(e)},e.prototype.delete=function(e){var t="number"==typeof e?e:this.indexes[e];if(void 0!==t){var n=this.getValue(t);this.changes.set(t,{op:r.OPERATION.DELETE,index:t}),this.allChanges.delete(t),delete this.caches[t],n&&n.$changes&&(n.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema "+this.ref.constructor.name+": trying to delete non-existing index: "+e+" ("+t+")")},e.prototype.discard=function(e,t){var n=this;void 0===e&&(e=!1),void 0===t&&(t=!1),this.ref instanceof i.Schema||this.changes.forEach((function(e){if(e.op===r.OPERATION.DELETE){var t=n.ref.getIndex(e.index);delete n.indexes[t]}})),this.changes.clear(),this.changed=e,t&&this.allChanges.clear(),this.currentCustomOperation=0},e.prototype.discardAll=function(){var e=this;this.changes.forEach((function(t){var n=e.getValue(t.index);n&&n.$changes&&n.$changes.discardAll()})),this.discard()},e.prototype.cache=function(e,t){this.caches[e]=t},e.prototype.clone=function(){return new e(this.ref,this.parent,this.root)},e.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},e.prototype.assertValidIndex=function(e,t){if(void 0===e)throw new Error('ChangeTree: missing index for field "'+t+'"')},e}();t.ChangeTree=s},357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchStructureCheck=t.arrayCheck=t.numberCheck=t.number=t.stringCheck=t.string=t.boolean=t.readFloat64=t.readFloat32=t.uint64=t.int64=t.float64=t.float32=t.uint32=t.int32=t.uint16=t.int16=t.uint8=t.int8=void 0;var r=n(787);function i(e,t){return o(e,t)<<24>>24}function o(e,t){return e[t.offset++]}function s(e,t){return a(e,t)<<16>>16}function a(e,t){return e[t.offset++]|e[t.offset++]<<8}function c(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function u(e,t){return c(e,t)>>>0}function f(e,t){var n=u(e,t);return c(e,t)*Math.pow(2,32)+n}function h(e,t){var n=u(e,t);return u(e,t)*Math.pow(2,32)+n}t.int8=i,t.uint8=o,t.int16=s,t.uint16=a,t.int32=c,t.uint32=u,t.float32=function(e,t){return y(e,t)},t.float64=function(e,t){return v(e,t)},t.int64=f,t.uint64=h;var l=new Int32Array(2),p=new Float32Array(l.buffer),d=new Float64Array(l.buffer);function y(e,t){return l[0]=c(e,t),p[0]}function v(e,t){return l[0]=c(e,t),l[1]=c(e,t),d[0]}t.readFloat32=y,t.readFloat64=v,t.boolean=function(e,t){return o(e,t)>0},t.string=function(e,t){var n,r=e[t.offset++];r<192?n=31&r:217===r?n=o(e,t):218===r?n=a(e,t):219===r&&(n=u(e,t));var i=function(e,t,n){for(var r="",i=0,o=t,s=t+n;o<s;o++){var a=e[o];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(i=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i):r+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0):r+=String.fromCharCode((31&a)<<6|63&e[++o]):r+=String.fromCharCode(a)}return r}(e,t.offset,n);return t.offset+=n,i},t.stringCheck=function(e,t){var n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n},t.number=function(e,t){var n=e[t.offset++];return n<128?n:202===n?y(e,t):203===n?v(e,t):204===n?o(e,t):205===n?a(e,t):206===n?u(e,t):207===n?h(e,t):208===n?i(e,t):209===n?s(e,t):210===n?c(e,t):211===n?f(e,t):n>223?-1*(255-n+1):void 0},t.numberCheck=function(e,t){var n=e[t.offset];return n<128||n>=202&&n<=211},t.arrayCheck=function(e,t){return e[t.offset]<160},t.switchStructureCheck=function(e,t){return e[t.offset-1]===r.SWITCH_TO_STRUCTURE&&(e[t.offset]<128||e[t.offset]>=202&&e[t.offset]<=211)}},163:function(e,t){"use strict";function n(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e[t++]=r:r<2048?(e[t++]=192|r>>6,e[t++]=128|63&r):r<55296||r>=57344?(e[t++]=224|r>>12,e[t++]=128|r>>6&63,e[t++]=128|63&r):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e[t++]=240|r>>18,e[t++]=128|r>>12&63,e[t++]=128|r>>6&63,e[t++]=128|63&r)}function r(e,t){e.push(255&t)}function i(e,t){e.push(255&t)}function o(e,t){e.push(255&t),e.push(t>>8&255)}function s(e,t){e.push(255&t),e.push(t>>8&255)}function a(e,t){e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255)}function c(e,t){var n=t>>24,r=t>>16,i=t>>8,o=t;e.push(255&o),e.push(255&i),e.push(255&r),e.push(255&n)}function u(e,t){var n=Math.floor(t/Math.pow(2,32));c(e,t>>>0),c(e,n)}function f(e,t){var n=t/Math.pow(2,32)>>0;c(e,t>>>0),c(e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.number=t.string=t.boolean=t.writeFloat64=t.writeFloat32=t.float64=t.float32=t.uint64=t.int64=t.uint32=t.int32=t.uint16=t.int16=t.uint8=t.int8=t.utf8Write=void 0,t.utf8Write=n,t.int8=r,t.uint8=i,t.int16=o,t.uint16=s,t.int32=a,t.uint32=c,t.int64=u,t.uint64=f,t.float32=function(e,t){d(e,t)},t.float64=function(e,t){y(e,t)};var h=new Int32Array(2),l=new Float32Array(h.buffer),p=new Float64Array(h.buffer);function d(e,t){l[0]=t,a(e,h[0])}function y(e,t){p[0]=t,a(e,h[0]),a(e,h[1])}t.writeFloat32=d,t.writeFloat64=y,t.boolean=function(e,t){return i(e,t?1:0)},t.string=function(e,t){t||(t="");var r=function(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t),o=0;if(r<32)e.push(160|r),o=1;else if(r<256)e.push(217),i(e,r),o=2;else if(r<65536)e.push(218),s(e,r),o=3;else{if(!(r<4294967296))throw new Error("String too long");e.push(219),c(e,r),o=5}return n(e,e.length,t),o+r},t.number=function e(t,n){return isNaN(n)?e(t,0):isFinite(n)?n!==(0|n)?(t.push(203),y(t,n),9):n>=0?n<128?(i(t,n),1):n<256?(t.push(204),i(t,n),2):n<65536?(t.push(205),s(t,n),3):n<4294967296?(t.push(206),c(t,n),5):(t.push(207),f(t,n),9):n>=-32?(t.push(224|n+32),1):n>=-128?(t.push(208),r(t,n),2):n>=-32768?(t.push(209),o(t,n),3):n>=-2147483648?(t.push(210),a(t,n),5):(t.push(211),u(t,n),9):e(t,n>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}},624:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},r=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var i=function(){function e(){this.handlers=[]}return e.prototype.register=function(e,t){return void 0===t&&(t=!1),this.handlers.push(e),this},e.prototype.invoke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.handlers.forEach((function(t){return t.apply(void 0,r(e))}))},e.prototype.invokeAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.handlers.map((function(t){return t.apply(void 0,r(e))})))},e.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},e.prototype.clear=function(){this.handlers=[]},e}();t.EventEmitter=i},376:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientState=void 0;var n=function(){function e(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return e.prototype.addRefId=function(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))},e.get=function(t){return void 0===t.$filterState&&(t.$filterState=new e),t.$filterState},e}();t.ClientState=n},715:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerType=t.SetSchema=t.CollectionSchema=t.ArraySchema=t.MapSchema=void 0;var r=n(898);Object.defineProperty(t,"Schema",{enumerable:!0,get:function(){return r.Schema}});var i=n(582);Object.defineProperty(t,"MapSchema",{enumerable:!0,get:function(){return i.MapSchema}});var o=n(31);Object.defineProperty(t,"ArraySchema",{enumerable:!0,get:function(){return o.ArraySchema}});var s=n(611);Object.defineProperty(t,"CollectionSchema",{enumerable:!0,get:function(){return s.CollectionSchema}});var a=n(317);Object.defineProperty(t,"SetSchema",{enumerable:!0,get:function(){return a.SetSchema}});var c=n(421);Object.defineProperty(t,"registerType",{enumerable:!0,get:function(){return c.registerType}}),c.registerType("map",{constructor:i.MapSchema,getProxy:i.getMapProxy}),c.registerType("array",{constructor:o.ArraySchema,getProxy:o.getArrayProxy}),c.registerType("set",{constructor:a.SetSchema}),c.registerType("collection",{constructor:s.CollectionSchema});var u=n(793);Object.defineProperty(t,"dumpChanges",{enumerable:!0,get:function(){return u.dumpChanges}});var f=n(785);Object.defineProperty(t,"Reflection",{enumerable:!0,get:function(){return f.Reflection}}),Object.defineProperty(t,"ReflectionType",{enumerable:!0,get:function(){return f.ReflectionType}}),Object.defineProperty(t,"ReflectionField",{enumerable:!0,get:function(){return f.ReflectionField}});var h=n(598);Object.defineProperty(t,"type",{enumerable:!0,get:function(){return h.type}}),Object.defineProperty(t,"deprecated",{enumerable:!0,get:function(){return h.deprecated}}),Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return h.filter}}),Object.defineProperty(t,"filterChildren",{enumerable:!0,get:function(){return h.filterChildren}}),Object.defineProperty(t,"defineTypes",{enumerable:!0,get:function(){return h.defineTypes}}),Object.defineProperty(t,"hasFilter",{enumerable:!0,get:function(){return h.hasFilter}}),Object.defineProperty(t,"SchemaDefinition",{enumerable:!0,get:function(){return h.SchemaDefinition}}),Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return h.Context}});var l=n(787);Object.defineProperty(t,"OPERATION",{enumerable:!0,get:function(){return l.OPERATION}})},787:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OPERATION=t.TYPE_ID=t.SWITCH_TO_STRUCTURE=void 0,t.SWITCH_TO_STRUCTURE=255,t.TYPE_ID=213,(n=t.OPERATION||(t.OPERATION={}))[n.ADD=128]="ADD",n[n.REPLACE=0]="REPLACE",n[n.DELETE=64]="DELETE",n[n.DELETE_AND_ADD=192]="DELETE_AND_ADD",n[n.TOUCH=1]="TOUCH",n[n.CLEAR=10]="CLEAR"},31:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.ArraySchema=t.getArrayProxy=void 0;var o=n(377),s=n(787),a=n(898),c=function(e,t){var n=e.toString(),r=t.toString();return n<r?-1:n>r?1:0};t.getArrayProxy=function(e){return e.$proxy=!0,new Proxy(e,{get:function(e,t){return"symbol"==typeof t||isNaN(t)?e[t]:e.at(t)},set:function(e,t,n){if("symbol"==typeof t||isNaN(t))e[t]=n;else{var r=Array.from(e.$items.keys()),i=parseInt(r[t]||t);null==n?e.deleteAt(i):e.setAt(i,n)}return!0},deleteProperty:function(e,t){return"number"==typeof t?e.deleteAt(t):delete e[t],!0}})};var u=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.$changes=new o.ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,i(e))}return e.is=function(e){return Array.isArray(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this.$items.size},set:function(e){0===e?this.clear():this.splice(e,this.length-e)},enumerable:!1,configurable:!0}),e.prototype.push=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){e=t.$refId++,t.setAt(e,n)})),e},e.prototype.pop=function(){var e=Array.from(this.$indexes.values()).pop();if(void 0!==e){this.$changes.delete(e),this.$indexes.delete(e);var t=this.$items.get(e);return this.$items.delete(e),t}},e.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},e.prototype.setAt=function(e,t){var n,r;void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,e);var i=null!==(r=null===(n=this.$changes.indexes[e])||void 0===n?void 0:n.op)&&void 0!==r?r:s.OPERATION.ADD;this.$changes.indexes[e]=e,this.$indexes.set(e,e),this.$items.set(e,t),this.$changes.change(e,i)},e.prototype.deleteAt=function(e){var t=Array.from(this.$items.keys())[e];return void 0!==t&&this.$deleteAt(t)},e.prototype.$deleteAt=function(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)},e.prototype.clear=function(e){var t=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){t.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:s.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.concat=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new(e.bind.apply(e,i([void 0],(t=Array.from(this.$items.values())).concat.apply(t,i(n)))))},e.prototype.join=function(e){return Array.from(this.$items.values()).join(e)},e.prototype.reverse=function(){var e=this,t=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(n,r){e.setAt(t[r],n)})),this},e.prototype.shift=function(){var e=Array.from(this.$items.keys()).shift();if(void 0!==e){var t=this.$items.get(e);return this.$deleteAt(e),t}},e.prototype.slice=function(t,n){return new(e.bind.apply(e,i([void 0],Array.from(this.$items.values()).slice(t,n))))},e.prototype.sort=function(e){var t=this;void 0===e&&(e=c);var n=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(e).forEach((function(e,r){t.setAt(n[r],e)})),this},e.prototype.splice=function(e,t){void 0===t&&(t=this.length-e);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var i=Array.from(this.$items.keys()),o=[],s=e;s<e+t;s++)o.push(this.$items.get(i[s])),this.$deleteAt(i[s]);return o},e.prototype.unshift=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.length,i=t.length,o=Array.from(this.$items.values());return t.forEach((function(t,n){e.setAt(n,t)})),o.forEach((function(t,n){e.setAt(i+n,t)})),r+i},e.prototype.indexOf=function(e,t){return Array.from(this.$items.values()).indexOf(e,t)},e.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=this.length-1),Array.from(this.$items.values()).lastIndexOf(e,t)},e.prototype.every=function(e,t){return Array.from(this.$items.values()).every(e,t)},e.prototype.some=function(e,t){return Array.from(this.$items.values()).some(e,t)},e.prototype.forEach=function(e,t){Array.from(this.$items.values()).forEach(e,t)},e.prototype.map=function(e,t){return Array.from(this.$items.values()).map(e,t)},e.prototype.filter=function(e,t){return Array.from(this.$items.values()).filter(e,t)},e.prototype.reduce=function(e,t){return Array.from(this.$items.values()).reduce(e,t)},e.prototype.reduceRight=function(e,t){return Array.from(this.$items.values()).reduceRight(e,t)},e.prototype.find=function(e,t){return Array.from(this.$items.values()).find(e,t)},e.prototype.findIndex=function(e,t){return Array.from(this.$items.values()).findIndex(e,t)},e.prototype.fill=function(e,t,n){throw new Error("ArraySchema#fill() not implemented")},e.prototype.copyWithin=function(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")},e.prototype.toString=function(){return this.$items.toString()},e.prototype.toLocaleString=function(){return this.$items.toLocaleString()},e.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},e.prototype[Symbol.unscopables]=function(){return this.$items[Symbol.unscopables]()},e.prototype.entries=function(){return this.$items.entries()},e.prototype.keys=function(){return this.$items.keys()},e.prototype.values=function(){return this.$items.values()},e.prototype.includes=function(e,t){return Array.from(this.$items.values()).includes(e,t)},e.prototype.flatMap=function(e,t){throw new Error("ArraySchema#flatMap() is not supported.")},e.prototype.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},e.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},e.prototype.getIndex=function(e){return this.$indexes.get(e)},e.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},e.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){return this.toArray().map((function(e){return"function"==typeof e.toJSON?e.toJSON():e}))},e.prototype.clone=function(t){return t?new(e.bind.apply(e,i([void 0],Array.from(this.$items.values())))):new(e.bind.apply(e,i([void 0],this.map((function(e){return e.$changes?e.clone():e})))))},e.prototype.triggerAll=function(){a.Schema.prototype.triggerAll.apply(this)},e}();t.ArraySchema=u},611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionSchema=void 0;var r=n(377),i=n(787),o=n(898),s=function(){function e(e){var t=this;this.$changes=new r.ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return e.is=function(e){return void 0!==e.collection},e.prototype.add=function(e){var t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t},e.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},e.prototype.entries=function(){return this.$items.entries()},e.prototype.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},e.prototype.clear=function(e){var t=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){t.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:i.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(e){return Array.from(this.$items.values()).some((function(t){return t===e}))},e.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},e.prototype.getIndex=function(e){return this.$indexes.get(e)},e.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},e.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},e.prototype.clone=function(t){var n;if(t)n=Object.assign(new e,this);else{var r=new e;this.forEach((function(e){e.$changes?r.add(e.clone()):r.add(e)}))}return n},e.prototype.triggerAll=function(){o.Schema.prototype.triggerAll.apply(this)},e}();t.CollectionSchema=s},582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapSchema=t.getMapProxy=void 0;var r=n(377),i=n(787),o=n(898);t.getMapProxy=function(e){return e.$proxy=!0,new Proxy(e,{get:function(e,t){return"symbol"!=typeof t&&void 0===e[t]?e.get(t):e[t]},set:function(e,t,n){return"symbol"!=typeof t&&-1===t.indexOf("$")&&"onAdd"!==t&&"onRemove"!==t&&"onChange"!==t?e.set(t,n):e[t]=n,!0},deleteProperty:function(e,t){return e.delete(t),!0}})};var s=function(){function e(e){var t=this;if(this.$changes=new r.ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map)e.forEach((function(e,n){return t.set(n,e)}));else for(var n in e)this.set(n,e[n])}return e.is=function(e){return void 0!==e.map},e.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){var n=void 0!==this.$changes.indexes[e],r=n?this.$changes.indexes[e]:this.$refId++,o=n?i.OPERATION.REPLACE:i.OPERATION.ADD,s=void 0!==t.$changes;return s&&t.$changes.setParent(this,this.$changes.root,r),n?s&&this.$items.get(e)!==t&&(o=i.OPERATION.ADD):(this.$changes.indexes[e]=r,this.$indexes.set(r,e)),this.$items.set(e,t),this.$changes.change(e,o),this},e.prototype.get=function(e){return this.$items.get(e)},e.prototype.delete=function(e){return this.$changes.delete(e),this.$items.delete(e)},e.prototype.clear=function(e){var t=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){t.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:i.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(e){return this.$items.has(e)},e.prototype.forEach=function(e){this.$items.forEach(e)},e.prototype.entries=function(){return this.$items.entries()},e.prototype.keys=function(){return this.$items.keys()},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},e.prototype.getIndex=function(e){return this.$indexes.get(e)},e.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},e.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},e.prototype.toJSON=function(){var e={};return this.forEach((function(t,n){e[n]="function"==typeof t.toJSON?t.toJSON():t})),e},e.prototype.clone=function(t){var n;if(t)n=Object.assign(new e,this);else{var r=new e;this.forEach((function(e,t){e.$changes?r.set(t,e.clone()):r.set(t,e)}))}return n},e.prototype.triggerAll=function(){o.Schema.prototype.triggerAll.apply(this)},e}();t.MapSchema=s},317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetSchema=void 0;var r=n(377),i=n(787),o=n(898),s=function(){function e(e){var t=this;this.$changes=new r.ChangeTree(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return e.is=function(e){return void 0!==e.set},e.prototype.add=function(e){if(this.has(e))return!1;var t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t},e.prototype.entries=function(){return this.$items.entries()},e.prototype.delete=function(e){for(var t,n,r=this.$items.entries();(n=r.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},e.prototype.clear=function(e){var t=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){t.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:i.OPERATION.CLEAR}),this.$changes.touchParents()},e.prototype.has=function(e){for(var t,n=this.$items.values(),r=!1;(t=n.next())&&!t.done;)if(e===t.value){r=!0;break}return r},e.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,r,i){return e(n,r,t)}))},e.prototype.values=function(){return this.$items.values()},Object.defineProperty(e.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},e.prototype.getIndex=function(e){return this.$indexes.get(e)},e.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},e.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},e.prototype.toArray=function(){return Array.from(this.$items.values())},e.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},e.prototype.clone=function(t){var n;if(t)n=Object.assign(new e,this);else{var r=new e;this.forEach((function(e){e.$changes?r.add(e.clone()):r.add(e)}))}return n},e.prototype.triggerAll=function(){o.Schema.prototype.triggerAll.apply(this)},e}();t.SetSchema=s},421:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getType=t.registerType=void 0;var n={};t.registerType=function(e,t){n[e]=t},t.getType=function(e){return n[e]}},793:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dumpChanges=void 0,t.dumpChanges=function(e){for(var t=[e.$changes],n={},r=n,i=function(e){var n=t[e];n.changes.forEach((function(e){var t=n.ref,i=e.index,o=t._definition?t._definition.fieldsByIndex[i]:t.$indexes.get(i);r[o]=n.getValue(i)}))},o=0;o<1;o++)i(o);return n}},416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(127),i=function(){function e(e){this.listeners=[],this.matcherPlaceholders={":id":/^([a-zA-Z0-9\-_]+)$/,":number":/^([0-9]+)$/,":string":/^(\w+)$/,":axis":/^([xyz])$/,":*":/(.*)/},this.state=e,this.reset()}return e.prototype.set=function(e){var t=r.compare(this.state,e);return this.state=e,this.checkPatches(t,this.listeners,this.defaultListener),t},e.prototype.registerPlaceholder=function(e,t){this.matcherPlaceholders[e]=t},e.prototype.listen=function(e,t,n){var i,o=this;"function"==typeof e?(i=[],t=e):i=e.split("/"),t.length>1&&console.warn(".listen() accepts only one parameter.");var s={callback:t,rawRules:i,rules:i.map((function(e){return"string"==typeof e?0===e.indexOf(":")?o.matcherPlaceholders[e]||o.matcherPlaceholders[":*"]:new RegExp("^"+e+"$"):e}))};return 0===i.length?this.defaultListener=s:this.listeners.push(s),n&&this.checkPatches(r.compare({},this.state),[s]),s},e.prototype.removeListener=function(e){for(var t=this.listeners.length-1;t>=0;t--)this.listeners[t]===e&&this.listeners.splice(t,1)},e.prototype.removeAllListeners=function(){this.reset()},e.prototype.checkPatches=function(e,t,n){for(var r=0,i=t.length;r<i;r++)for(var o=t[r],s=e.length-1;s>=0;s--){var a=o&&this.getPathVariables(e[s],o);a&&(o.callback({path:a,rawPath:e[s].path,operation:e[s].operation,value:e[s].value}),e[s].matched=!0)}if(n)for(s=e.length-1;s>=0;s--)e[s].matched||n.callback(e[s])},e.prototype.getPathVariables=function(e,t){if(e.path.length!==t.rules.length)return!1;for(var n={},r=0,i=t.rules.length;r<i;r++){var o=e.path[r].match(t.rules[r]);if(!o||0===o.length||o.length>2)return!1;":"===t.rawRules[r].substr(0,1)&&(n[t.rawRules[r].substr(1)]=o[1])}return n},e.prototype.reset=function(){this.listeners=[]},e}();t.StateContainer=i},127:function(e,t){"use strict";function n(e,t){var n=e.slice();return n.push(t),n}function r(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(i);return r}function i(e,t,o,s){for(var a=r(t),c=r(e),u=!1,f=c.length-1;f>=0;f--){var h=e[p=c[f]];if(!t.hasOwnProperty(p)||void 0===t[p]&&void 0!==h&&!1===Array.isArray(t))o.push({operation:"remove",path:n(s,p)}),u=!0;else{var l=t[p];"object"==typeof h&&null!=h&&"object"==typeof l&&null!=l?i(h,l,o,n(s,p)):h!==l&&o.push({operation:"replace",path:n(s,p),value:l,previousValue:h})}}if(u||a.length!=c.length)for(f=a.length-1;f>=0;f--){var p=a[f];if(!e.hasOwnProperty(p)&&void 0!==t[p]){l=t[p];var d=n(s,p);"object"==typeof l&&null!=l&&i({},l,o,d),o.push({operation:"add",path:d,value:l})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.compare=function(e,t){var n=[];return i(e,t,n,[]),n}},449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(416);t.StateContainer=r.StateContainer},677:function(e,t){"use strict";t.R=function(e,t){return new r(n[e],t)};var n={exponential:function(e,t){return Math.floor(Math.random()*Math.pow(2,e)*t)},fibonacci:function(e,t){if(e>(r=1))for(var n=1,r=2,i=2;i<e;i++){var o=n+r;n=r,r=o}return Math.floor(Math.random()*r*t)}};function r(e,t){this.func=e,this.attempts=0,this.delay=void 0!==t.initialDelay?t.initialDelay:100}r.prototype.backoff=function(){setTimeout(this.onReady,this.func(++this.attempts,this.delay))}},73:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(677).R,s="undefined"!=typeof WebSocket?WebSocket:n(588),a=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,e),this.url=t,this.protocols=n,this.reconnectEnabled=!0,this.listeners={},this.backoff=o(r.backoff||"exponential",r),this.backoff.onReady=this.onBackoffReady.bind(this),(void 0===r.connect||r.connect)&&this.open()}return r(e,[{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isReconnect=e;var t=this.ws&&this.ws.binaryType;this.ws=new s(this.url,this.protocols),this.ws.onclose=this.onCloseCallback.bind(this),this.ws.onerror=this.onErrorCallback.bind(this),this.ws.onmessage=this.onMessageCallback.bind(this),this.ws.onopen=this.onOpenCallback.bind(this),t&&(this.ws.binaryType=t)}},{key:"onBackoffReady",value:function(e,t){this.open(!0)}},{key:"onCloseCallback",value:function(e){!this.isReconnect&&this.listeners.onclose&&this.listeners.onclose.apply(null,arguments),this.reconnectEnabled&&e.code<3e3&&this.backoff.backoff()}},{key:"onErrorCallback",value:function(){this.listeners.onerror&&this.listeners.onerror.apply(null,arguments)}},{key:"onMessageCallback",value:function(){this.listeners.onmessage&&this.listeners.onmessage.apply(null,arguments)}},{key:"onOpenCallback",value:function(){this.listeners.onopen&&this.listeners.onopen.apply(null,arguments),this.isReconnect&&this.listeners.onreconnect&&this.listeners.onreconnect.apply(null,arguments),this.isReconnect=!1}},{key:"close",value:function(e,t){void 0===e&&(e=1e3),this.reconnectEnabled=!1,this.ws.close(e,t)}},{key:"send",value:function(e){this.ws.send(e)}},{key:"bufferedAmount",get:function(){return this.ws.bufferedAmount}},{key:"readyState",get:function(){return this.ws.readyState}},{key:"binaryType",get:function(){return this.ws.binaryType},set:function(e){this.ws.binaryType=e}},{key:"extensions",get:function(){return this.ws.extensions},set:function(e){this.ws.extensions=e}},{key:"protocol",get:function(){return this.ws.protocol},set:function(e){this.ws.protocol=e}},{key:"onclose",set:function(e){this.listeners.onclose=e},get:function(){return this.listeners.onclose}},{key:"onerror",set:function(e){this.listeners.onerror=e},get:function(){return this.listeners.onerror}},{key:"onmessage",set:function(e){this.listeners.onmessage=e},get:function(){return this.listeners.onmessage}},{key:"onopen",set:function(e){this.listeners.onopen=e},get:function(){return this.listeners.onopen}},{key:"onreconnect",set:function(e){this.listeners.onreconnect=e},get:function(){return this.listeners.onreconnect}}]),e}();a.CONNECTING=s.CONNECTING,a.OPEN=s.OPEN,a.CLOSING=s.CLOSING,a.CLOSED=s.CLOSED,t.default=a},63:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Auth=t.Platform=void 0;var c,u=o(n(408)),f=n(723),h="colyseus-auth-token";(c=t.Platform||(t.Platform={})).ios="ios",c.android="android";var l=function(){function e(e){var t=this;this._id=void 0,this.username=void 0,this.displayName=void 0,this.avatarUrl=void 0,this.isAnonymous=void 0,this.email=void 0,this.lang=void 0,this.location=void 0,this.timezone=void 0,this.metadata=void 0,this.devices=void 0,this.facebookId=void 0,this.twitterId=void 0,this.googleId=void 0,this.gameCenterId=void 0,this.steamId=void 0,this.friendIds=void 0,this.blockedUserIds=void 0,this.createdAt=void 0,this.updatedAt=void 0,this.token=void 0,this.endpoint=e.replace("ws","http"),f.getItem(h,(function(e){return t.token=e}))}return Object.defineProperty(e.prototype,"hasToken",{get:function(){return!!this.token},enumerable:!1,configurable:!0}),e.prototype.login=function(e){return void 0===e&&(e={}),s(this,void 0,void 0,(function(){var t,n,r;return a(this,(function(i){switch(i.label){case 0:return t=Object.assign({},e),this.hasToken&&(t.token=this.token),[4,this.request("post","/auth",t)];case 1:for(r in n=i.sent(),this.token=n.token,f.setItem(h,this.token),n)this.hasOwnProperty(r)&&(this[r]=n[r]);return this.registerPingService(),[2,this]}}))}))},e.prototype.save=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone})];case 1:return e.sent(),[2,this]}}))}))},e.prototype.getFriends=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/all")];case 1:return[2,e.sent()]}}))}))},e.prototype.getOnlineFriends=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/online")];case 1:return[2,e.sent()]}}))}))},e.prototype.getFriendRequests=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/requests")];case 1:return[2,e.sent()]}}))}))},e.prototype.sendFriendRequest=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.acceptFriendRequest=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.declineFriendRequest=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.request("del","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.blockUser=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.unblockUser=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.request=function(e,t,n,r,i){return void 0===n&&(n={}),void 0===i&&(i={}),s(this,void 0,void 0,(function(){var o,s,c,f;return a(this,(function(a){switch(a.label){case 0:for(s in i.Accept="application/json",this.hasToken&&(i.Authorization="Bearer "+this.token),o=[],n)o.push(s+"="+n[s]);return c=o.length>0?"?"+o.join("&"):"",f={headers:i},r&&(f.body=r),[4,u[e](""+this.endpoint+t+c,f)];case 1:return[2,a.sent().data]}}))}))},e.prototype.logout=function(){this.token=void 0,f.removeItem(h),this.unregisterPingService()},e.prototype.registerPingService=function(e){var t=this;void 0===e&&(e=15e3),this.unregisterPingService(),this.keepOnlineInterval=setInterval((function(){return t.request("get","/auth")}),e)},e.prototype.unregisterPingService=function(){clearInterval(this.keepOnlineInterval)},e}();t.Auth=l},705:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Client=t.MatchMakeError=void 0;var a=n(408),c=n(199),u=n(270),f=n(63),h=n(742),l=function(e){function t(n,r){var i=e.call(this,n)||this;return i.code=r,Object.setPrototypeOf(i,t.prototype),i}return i(t,e),t}(Error);t.MatchMakeError=l;var p=function(){function e(e){void 0===e&&(e=location.protocol.replace("http","ws")+"//"+location.hostname+(location.port&&":"+location.port)),this.endpoint=e,this.auth=new f.Auth(this.endpoint),this.push=new h.Push(this.endpoint)}return e.prototype.joinOrCreate=function(e,t,n){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.create=function(e,t,n){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("create",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.join=function(e,t,n){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("join",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.joinById=function(e,t,n){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,t,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.reconnect=function(e,t,n){return o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,{sessionId:t},n)];case 1:return[2,r.sent()]}}))}))},e.prototype.getAvailableRooms=function(e){return void 0===e&&(e=""),o(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=this.endpoint.replace("ws","http")+"/matchmake/"+e,[4,a.get(t,{headers:{Accept:"application/json"}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.consumeSeatReservation=function(e,t){return o(this,void 0,void 0,(function(){var n;return s(this,(function(r){return(n=this.createRoom(e.room.name,t)).id=e.room.roomId,n.sessionId=e.sessionId,n.connect(this.buildEndpoint(e.room,{sessionId:n.sessionId})),[2,new Promise((function(e,t){var r=function(e,n){return t(new c.ServerError(e,n))};n.onError.once(r),n.onJoin.once((function(){n.onError.remove(r),e(n)}))}))]}))}))},e.prototype.createMatchMakeRequest=function(e,t,n,r){return void 0===n&&(n={}),o(this,void 0,void 0,(function(){var i,o;return s(this,(function(s){switch(s.label){case 0:return i=this.endpoint.replace("ws","http")+"/matchmake/"+e+"/"+t,this.auth.hasToken&&(n.token=this.auth.token),[4,a.post(i,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:if((o=s.sent().data).error)throw new l(o.error,o.code);return[2,this.consumeSeatReservation(o,r)]}}))}))},e.prototype.createRoom=function(e,t){return new u.Room(e,t)},e.prototype.buildEndpoint=function(e,t){void 0===t&&(t={});var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(r+"="+t[r]);return this.endpoint+"/"+e.processId+"/"+e.roomId+"?"+n.join("&")},e}();t.Client=p},826:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var s=o(n(73)),a=function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t,void 0,{connect:n})||this;return r._enqueuedCalls=[],r}return i(t,e),t.prototype.onOpenCallback=function(t){if(e.prototype.onOpenCallback.call(this),this.binaryType="arraybuffer",this._enqueuedCalls.length>0){for(var n=0,r=this._enqueuedCalls;n<r.length;n++){var i=r[n],o=i[0],s=i[1];this[o].apply(this,s)}this._enqueuedCalls=[]}},t.prototype.send=function(t){if(this.ws.readyState===s.default.OPEN){if(t instanceof ArrayBuffer)return e.prototype.send.call(this,t);if(Array.isArray(t))return e.prototype.send.call(this,new Uint8Array(t).buffer)}else this._enqueuedCalls.push(["send",[t]])},t}(s.default);t.Connection=a},845:function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.utf8Length=t.utf8Read=t.ErrorCode=t.Protocol=void 0,(r=t.Protocol||(t.Protocol={}))[r.HANDSHAKE=9]="HANDSHAKE",r[r.JOIN_ROOM=10]="JOIN_ROOM",r[r.ERROR=11]="ERROR",r[r.LEAVE_ROOM=12]="LEAVE_ROOM",r[r.ROOM_DATA=13]="ROOM_DATA",r[r.ROOM_STATE=14]="ROOM_STATE",r[r.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",r[r.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",(n=t.ErrorCode||(t.ErrorCode={}))[n.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",n[n.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",n[n.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",n[n.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",n[n.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",n[n.AUTH_FAILED=4215]="AUTH_FAILED",n[n.APPLICATION_ERROR=4216]="APPLICATION_ERROR",t.utf8Read=function(e,t){for(var n=e[t++],r="",i=0,o=t,s=t+n;o<s;o++){var a=e[o];if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(i=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0);else r+=String.fromCharCode((31&a)<<6|63&e[++o]);else r+=String.fromCharCode(a)}return r},t.utf8Length=function(e){void 0===e&&(e="");for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n+1}},742:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Push=void 0;var i=function(){function e(e){this.endpoint=e.replace("ws","http")}return e.prototype.register=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return this.check(),[4,this.registerServiceWorker()];case 1:return e.sent(),[4,this.requestNotificationPermission()];case 2:return e.sent(),[2]}}))}))},e.prototype.registerServiceWorker=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,navigator.serviceWorker.register(this.endpoint+"/push")];case 1:return[2,e.sent()]}}))}))},e.prototype.requestNotificationPermission=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,window.Notification.requestPermission()];case 1:if("granted"!==e.sent())throw new Error("Permission not granted for Notification");return[2]}}))}))},e.prototype.check=function(){if(!("serviceWorker"in navigator))throw new Error("No Service Worker support!");if(!("PushManager"in window))throw new Error("No Push API Support!")},e}();t.Push=i},270:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Room=void 0;var s=o(n(736)),a=n(703),c=n(972),u=n(826),f=n(944),h=n(845),l=o(n(163)),p=o(n(357)),d=function(){function e(e,t){var n=this;this.onStateChange=a.createSignal(),this.onError=a.createSignal(),this.onLeave=a.createSignal(),this.onJoin=a.createSignal(),this.hasJoined=!1,this.onMessageHandlers=c.createNanoEvents(),this.id=null,this.name=e,t&&(this.serializer=new(f.getSerializer("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError((function(e,t){return console.warn("colyseus.js - onError => ("+e+") "+t)})),this.onLeave((function(){return n.removeAllListeners()}))}return e.prototype.connect=function(e){var t=this;this.connection=new u.Connection(e,!1),this.connection.reconnectEnabled=!1,this.connection.onmessage=this.onMessageCallback.bind(this),this.connection.onclose=function(e){if(!t.hasJoined)return console.warn("Room connection was closed unexpectedly ("+e.code+"): "+e.reason),void t.onError.invoke(e.code,e.reason);t.onLeave.invoke(e.code),t.destroy()},this.connection.onerror=function(e){console.warn("Room, onError ("+e.code+"): "+e.reason),t.onError.invoke(e.code,e.reason)},this.connection.open()},e.prototype.leave=function(e){void 0===e&&(e=!0),this.connection?e?this.connection.send([h.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(4e3)},e.prototype.onMessage=function(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)},e.prototype.send=function(e,t){var n,r=[h.Protocol.ROOM_DATA];if("string"==typeof e?l.string(r,e):l.number(r,e),void 0!==t){var i=s.encode(t);(n=new Uint8Array(r.length+i.byteLength)).set(new Uint8Array(r),0),n.set(new Uint8Array(i),r.length)}else n=new Uint8Array(r);this.connection.send(n.buffer)},Object.defineProperty(e.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),e.prototype.listen=function(e,t,n){if("schema"!==this.serializerId)return this.serializerId||console.warn("room.Listen() should be called after room.onJoin has been called (DEPRECATION WARNING)"),this.serializer.api.listen(e,t,n);console.warn("'"+this.serializerId+"' serializer doesn't support .listen() method here.")},e.prototype.removeListener=function(e){return this.serializer.api.removeListener(e)},e.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}},e.prototype.onMessageCallback=function(e){var t=Array.from(new Uint8Array(e.data)),n=t[0];if(n===h.Protocol.JOIN_ROOM){var r=1;if(this.serializerId=h.utf8Read(t,r),r+=h.utf8Length(this.serializerId),!this.serializer){var i=f.getSerializer(this.serializerId);this.serializer=new i}t.length>r&&this.serializer.handshake&&this.serializer.handshake(t,{offset:r}),this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([h.Protocol.JOIN_ROOM])}else if(n===h.Protocol.ERROR){var o={offset:1},a=p.number(t,o),c=p.string(t,o);this.onError.invoke(a,c)}else if(n===h.Protocol.LEAVE_ROOM)this.leave();else if(n===h.Protocol.ROOM_DATA_SCHEMA){var u={offset:1};(c=new(d=this.serializer.getState().constructor._context.get(p.number(t,u)))).decode(t,u),this.dispatchMessage(d,c)}else if(n===h.Protocol.ROOM_STATE)t.shift(),this.setState(t);else if(n===h.Protocol.ROOM_STATE_PATCH)t.shift(),this.patch(t);else if(n===h.Protocol.ROOM_DATA){var l={offset:1},d=p.stringCheck(t,l)?p.string(t,l):p.number(t,l);c=t.length>l.offset?s.decode(e.data,l.offset):void 0,this.dispatchMessage(d,c)}},e.prototype.setState=function(e){this.serializer.setState(e),this.onStateChange.invoke(this.serializer.getState())},e.prototype.patch=function(e){this.serializer.patch(e),this.onStateChange.invoke(this.serializer.getState())},e.prototype.dispatchMessage=function(e,t){var n=this.getMessageHandlerKey(e);this.onMessageHandlers.events[n]?this.onMessageHandlers.emit(n,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):console.warn("onMessage not registered for type '"+e+"'.")},e.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},e.prototype.getMessageHandlerKey=function(e){switch(typeof e){case"function":return"$"+e._typeid;case"string":return e;case"number":return"i"+e;default:throw new Error("invalid message type.")}},e}();t.Room=d},723:function(e,t){"use strict";var n;function r(){return n||(n="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:{cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getItem=t.removeItem=t.setItem=void 0,t.setItem=function(e,t){r().setItem(e,t)},t.removeItem=function(e){r().removeItem(e)},t.getItem=function(e,t){var n=r().getItem(e);"undefined"!=typeof Promise&&n instanceof Promise?n.then((function(e){return t(e)})):t(n)}},199:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ServerError=void 0;var i=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="ServerError",r.code=t,r}return r(t,e),t}(Error);t.ServerError=i},767:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaSerializer=t.FossilDeltaSerializer=t.registerSerializer=void 0,n(331);var r=n(705);Object.defineProperty(t,"Client",{enumerable:!0,get:function(){return r.Client}});var i=n(845);Object.defineProperty(t,"Protocol",{enumerable:!0,get:function(){return i.Protocol}}),Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return i.ErrorCode}});var o=n(270);Object.defineProperty(t,"Room",{enumerable:!0,get:function(){return o.Room}});var s=n(63);Object.defineProperty(t,"Auth",{enumerable:!0,get:function(){return s.Auth}}),Object.defineProperty(t,"Platform",{enumerable:!0,get:function(){return s.Platform}});var a=n(91);Object.defineProperty(t,"FossilDeltaSerializer",{enumerable:!0,get:function(){return a.FossilDeltaSerializer}});var c=n(66);Object.defineProperty(t,"SchemaSerializer",{enumerable:!0,get:function(){return c.SchemaSerializer}});var u=n(197),f=n(944);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return f.registerSerializer}}),f.registerSerializer("fossil-delta",a.FossilDeltaSerializer),f.registerSerializer("schema",c.SchemaSerializer),f.registerSerializer("none",u.NoneSerializer)},331:function(){ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer})},736:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=void 0;var i=r(n(94)),o=r(n(329));t.decode=i.default,t.encode=o.default},94:function(e,t){"use strict";function n(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},n.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},n.prototype._str=function(e){var t=function(e,t,n){for(var r="",i=0,o=t,s=t+n;o<s;o++){var a=e.getUint8(o);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(i=(7&a)<<18|(63&e.getUint8(++o))<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0)>=65536?(i-=65536,r+=String.fromCharCode(55296+(i>>>10),56320+(1023&i))):r+=String.fromCharCode(i)}else r+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0);else r+=String.fromCharCode((31&a)<<6|63&e.getUint8(++o));else r+=String.fromCharCode(a)}return r}(this._view,this._offset,e);return this._offset+=e,t},n.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},n.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,r=0,i=0,o=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:return n=this._view.getUint8(this._offset),r=this._view.getInt8(this._offset+1),this._offset+=2,[r,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),r=this._view.getInt8(this._offset+2),this._offset+=3,[r,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),r=this._view.getInt8(this._offset+4),this._offset+=5,[r,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return i=this._view.getUint32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,i+o;case 212:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?void(this._offset+=1):[r,this._bin(1)];case 213:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(2)];case 214:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(4)];case 215:return r=this._view.getInt8(this._offset),this._offset+=1,0===r?(i=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(i+o)):[r,this._bin(8)];case 216:return r=this._view.getInt8(this._offset),this._offset+=1,[r,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")},t.default=function(e,t){void 0===t&&(t=0);var r=new n(e,t),i=r._parse();if(r._offset!==e.byteLength)throw new Error(e.byteLength-r._offset+" trailing bytes");return i}},329:function(e,t){"use strict";function n(e,t,n){for(var r=0,i=0,o=n.length;i<o;i++)(r=n.charCodeAt(i))<128?e.setUint8(t++,r):r<2048?(e.setUint8(t++,192|r>>6),e.setUint8(t++,128|63&r)):r<55296||r>=57344?(e.setUint8(t++,224|r>>12),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r)):(i++,r=65536+((1023&r)<<10|1023&n.charCodeAt(i)),e.setUint8(t++,240|r>>18),e.setUint8(t++,128|r>>12&63),e.setUint8(t++,128|r>>6&63),e.setUint8(t++,128|63&r))}function r(e,t,n){var i=typeof n,o=0,s=0,a=0,c=0,u=0,f=0;if("string"===i){if(u=function(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(n),u<32)e.push(160|u),f=1;else if(u<256)e.push(217,u),f=2;else if(u<65536)e.push(218,u>>8,u),f=3;else{if(!(u<4294967296))throw new Error("String too long");e.push(219,u>>24,u>>16,u>>8,u),f=5}return t.push({_str:n,_length:u,_offset:e.length}),f+u}if("number"===i)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(a=n/Math.pow(2,32)>>0,c=n>>>0,e.push(207,a>>24,a>>16,a>>8,a,c>>24,c>>16,c>>8,c),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(a=Math.floor(n/Math.pow(2,32)),c=n>>>0,e.push(211,a>>24,a>>16,a>>8,a,c>>24,c>>16,c>>8,c),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===i){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((u=n.length)<16)e.push(144|u),f=1;else if(u<65536)e.push(220,u>>8,u),f=3;else{if(!(u<4294967296))throw new Error("Array too large");e.push(221,u>>24,u>>16,u>>8,u),f=5}for(o=0;o<u;o++)f+=r(e,t,n[o]);return f}if(n instanceof Date){var h=n.getTime();return a=Math.floor(h/Math.pow(2,32)),c=h>>>0,e.push(215,0,a>>24,a>>16,a>>8,a,c>>24,c>>16,c>>8,c),10}if(n instanceof ArrayBuffer){if((u=n.byteLength)<256)e.push(196,u),f=2;else if(u<65536)e.push(197,u>>8,u),f=3;else{if(!(u<4294967296))throw new Error("Buffer too large");e.push(198,u>>24,u>>16,u>>8,u),f=5}return t.push({_bin:n,_length:u,_offset:e.length}),f+u}if("function"==typeof n.toJSON)return r(e,t,n.toJSON());var l=[],p="",d=Object.keys(n);for(o=0,s=d.length;o<s;o++)"function"!=typeof n[p=d[o]]&&l.push(p);if((u=l.length)<16)e.push(128|u),f=1;else if(u<65536)e.push(222,u>>8,u),f=3;else{if(!(u<4294967296))throw new Error("Object too large");e.push(223,u>>24,u>>16,u>>8,u),f=5}for(o=0;o<u;o++)f+=r(e,t,p=l[o]),f+=r(e,t,n[p]);return f}if("boolean"===i)return e.push(n?195:194),1;if("undefined"===i)return e.push(212,0,0),3;throw new Error("Could not encode")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[],i=[],o=r(t,i,e),s=new ArrayBuffer(o),a=new DataView(s),c=0,u=0,f=-1;i.length>0&&(f=i[0]._offset);for(var h,l=0,p=0,d=0,y=t.length;d<y;d++)if(a.setUint8(u+d,t[d]),d+1===f){if(l=(h=i[c])._length,p=u+f,h._bin)for(var v=new Uint8Array(h._bin),g=0;g<l;g++)a.setUint8(p+g,v[g]);else h._str?n(a,p,h._str):void 0!==h._float&&a.setFloat64(p,h._float);u+=l,i[++c]&&(f=i[c]._offset)}return s}},91:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FossilDeltaSerializer=void 0;var s=n(449),a=o(n(104)),c=o(n(736)),u=function(){function e(){this.api=new s.StateContainer({})}return e.prototype.getState=function(){return this.api.state},e.prototype.setState=function(e){this.previousState=new Uint8Array(e),this.api.set(c.decode(this.previousState))},e.prototype.patch=function(e){this.previousState=new Uint8Array(a.apply(this.previousState,e)),this.api.set(c.decode(this.previousState))},e.prototype.teardown=function(){this.api.removeAllListeners()},e}();t.FossilDeltaSerializer=u},197:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoneSerializer=void 0;var n=function(){function e(){}return e.prototype.setState=function(e){},e.prototype.getState=function(){return null},e.prototype.patch=function(e){},e.prototype.teardown=function(){},e.prototype.handshake=function(e){},e}();t.NoneSerializer=n},66:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaSerializer=void 0;var r=n(715),i=function(){function e(){}return e.prototype.setState=function(e){this.state.decode(e)},e.prototype.getState=function(){return this.state},e.prototype.patch=function(e){this.state.decode(e)},e.prototype.teardown=function(){var e,t;null===(t=null===(e=this.state)||void 0===e?void 0:e.$changes)||void 0===t||t.root.clearRefs()},e.prototype.handshake=function(e,t){this.state?(new r.Reflection).decode(e,t):this.state=r.Reflection.decode(e,t)},e}();t.SchemaSerializer=i},944:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSerializer=t.registerSerializer=void 0;var n={};t.registerSerializer=function(e,t){n[e]=t},t.getSerializer=function(e){var t=n[e];if(!t)throw new Error("missing serializer: "+e);return t}},104:function(e){var t;t=function(){"use strict";var e={},t=16;function n(){this.a=0,this.b=0,this.i=0,this.z=new Array(t)}n.prototype.init=function(e,n){var r,i,o=0,s=0;for(r=0;r<t;r++)o=o+(i=e[n+r])&65535,s=s+(t-r)*i&65535,this.z[r]=i;this.a=65535&o,this.b=65535&s,this.i=0},n.prototype.next=function(e){var n=this.z[this.i];this.z[this.i]=e,this.i=this.i+1&15,this.a=this.a-n+e&65535,this.b=this.b-t*n+this.a&65535},n.prototype.value=function(){return(65535&this.a|(65535&this.b)<<16)>>>0};var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~".split("").map((function(e){return e.charCodeAt(0)})),i=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,36,-1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,-1,-1,-1,63,-1];function o(e){this.a=e,this.pos=0}function s(){this.a=[]}function a(e){var t,n;for(t=1,n=64;e>=n;t++,n<<=6);return t}function c(e){for(var t=0,n=0,r=0,i=0,o=0,s=e.length;s>=16;)t=t+e[o+0]|0,n=n+e[o+1]|0,r=r+e[o+2]|0,i=i+e[o+3]|0,t=t+e[o+4]|0,n=n+e[o+5]|0,r=r+e[o+6]|0,i=i+e[o+7]|0,t=t+e[o+8]|0,n=n+e[o+9]|0,r=r+e[o+10]|0,i=i+e[o+11]|0,t=t+e[o+12]|0,n=n+e[o+13]|0,r=r+e[o+14]|0,i=i+e[o+15]|0,o+=16,s-=16;for(;s>=4;)t=t+e[o+0]|0,n=n+e[o+1]|0,r=r+e[o+2]|0,i=i+e[o+3]|0,o+=4,s-=4;switch(i=((i+(r<<8)|0)+(n<<16)|0)+(t<<24)|0,s){case 3:i=i+(e[o+2]<<8)|0;case 2:i=i+(e[o+1]<<16)|0;case 1:i=i+(e[o+0]<<24)|0}return i>>>0}return o.prototype.haveBytes=function(){return this.pos<this.a.length},o.prototype.getByte=function(){var e=this.a[this.pos];if(this.pos++,this.pos>this.a.length)throw new RangeError("out of bounds");return e},o.prototype.getChar=function(){return String.fromCharCode(this.getByte())},o.prototype.getInt=function(){for(var e,t=0;this.haveBytes()&&(e=i[127&this.getByte()])>=0;)t=(t<<6)+e;return this.pos--,t>>>0},s.prototype.toArray=function(){return this.a},s.prototype.putByte=function(e){this.a.push(255&e)},s.prototype.putChar=function(e){this.putByte(e.charCodeAt(0))},s.prototype.putInt=function(e){var t,n,i=[];if(0!==e){for(t=0;e>0;t++,e>>>=6)i.push(r[63&e]);for(n=t-1;n>=0;n--)this.putByte(i[n])}else this.putChar("0")},s.prototype.putArray=function(e,t,n){for(var r=t;r<n;r++)this.a.push(e[r])},e.create=function(e,r){var i,o=new s,u=r.length,f=e.length,h=-1;if(o.putInt(u),o.putChar("\n"),f<=t)return o.putInt(u),o.putChar(":"),o.putArray(r,0,u),o.putInt(c(r)),o.putChar(";"),o.toArray();var l=Math.ceil(f/t),p=new Array(l),d=new Array(l);for(i=0;i<p.length;i++)p[i]=-1;for(i=0;i<d.length;i++)d[i]=-1;var y,v=new n;for(i=0;i<f-t;i+=t)v.init(e,i),y=v.value()%l,p[i/t]=d[y],d[y]=i/t;for(var g,m,_,b,w,O=0;O+t<u;)for(b=0,w=0,v.init(r,O),i=0,_=0;;){var A=250;for(m=d[y=v.value()%l];m>=0&&A-- >0;){var E,I,$,S,P,C,x;for(S=0,C=g=m*t,x=O+i;C<f&&x<u&&e[C]===r[x];S++,C++,x++);for(S--,P=1;P<g&&P<=i&&e[g-P]===r[O+i-P];P++);I=g- --P,$=i-P,(E=S+P+1)>=a(i-P)+a(E)+a(I)+3&&E>_&&(_=E,b=g-P,w=$),m=p[m]}if(_>0){w>0&&(o.putInt(w),o.putChar(":"),o.putArray(r,O,O+w),O+=w),O+=_,o.putInt(_),o.putChar("@"),o.putInt(b),o.putChar(","),b+_-1>h&&(h=b+_-1),_=0;break}if(O+i+t>=u){o.putInt(u-O),o.putChar(":"),o.putArray(r,O,O+u-O),O=u;break}v.next(r[O+i+t]),i++}return O<u&&(o.putInt(u-O),o.putChar(":"),o.putArray(r,O,O+u-O)),o.putInt(c(r)),o.putChar(";"),o.toArray()},e.outputSize=function(e){var t=new o(e),n=t.getInt();if("\n"!==t.getChar())throw new Error("size integer not terminated by '\\n'");return n},e.apply=function(e,t,n){var r,i=0,a=new o(t),u=e.length,f=t.length;if(r=a.getInt(),"\n"!==a.getChar())throw new Error("size integer not terminated by '\\n'");for(var h=new s;a.haveBytes();){var l,p;switch(l=a.getInt(),a.getChar()){case"@":if(p=a.getInt(),a.haveBytes()&&","!==a.getChar())throw new Error("copy command not terminated by ','");if((i+=l)>r)throw new Error("copy exceeds output file size");if(p+l>u)throw new Error("copy extends past end of input");h.putArray(e,p,p+l);break;case":":if((i+=l)>r)throw new Error("insert command gives an output larger than predicted");if(l>f)throw new Error("insert count exceeds size of delta");h.putArray(a.a,a.pos,a.pos+l),a.pos+=l;break;case";":var d=h.toArray();if((!n||!1!==n.verifyChecksum)&&l!==c(d))throw new Error("bad checksum");if(i!==r)throw new Error("generated size does not match predicted size");return d;default:throw new Error("unknown delta operator")}}throw new Error("unterminated delta")},e},e.exports?e.exports=t():this.fossilDelta=t()},703:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.handlers=[]}return e.prototype.register=function(e,t){return void 0===t&&(t=!1),this.handlers.push(e),this},e.prototype.invoke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.handlers.forEach((function(t){return t.apply(void 0,e)}))},e.prototype.invokeAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.handlers.map((function(t){return t.apply(void 0,e)})))},e.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},e.prototype.clear=function(){this.handlers=[]},e}();t.EventEmitter=n,t.createSignal=function(){var e=new n;function t(t){return e.register(t,null===this)}return t.once=function(t){var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t.apply(void 0,r),e.remove(n)};e.register(n)},t.remove=function(t){return e.remove(t)},t.invoke=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invoke.apply(e,t)},t.invokeAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invokeAsync.apply(e,t)},t.clear=function(){return e.clear()},t}},972:function(e){e.exports={createNanoEvents:()=>({events:{},emit(e,...t){for(let n of this.events[e]||[])n(...t)},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=this.events[e].filter((e=>e!==t))}})}}}]);