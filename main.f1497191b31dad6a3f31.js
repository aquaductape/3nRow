!function(){"use strict";var e,t,n={},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e].call(a.exports,a,a.exports,i),a.exports}i.m=n,i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,n){return i.f[n](e,t),t}),[]))},i.u=function(e){return"main."+{48:"2bc6423595b16f88004a",767:"87c3ec298e62e7cbe560"}[e]+".js"},i.miniCssF=function(e){},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="3nRow:",i.l=function(n,r,a,o){if(e[n])e[n].push(r);else{var s,l;if(void 0!==a)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var p=d[c];if(p.getAttribute("src")==n||p.getAttribute("data-webpack")==t+a){s=p;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var u=function(t,r){s.onerror=s.onload=null,clearTimeout(h);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(r)})),t)return t(r)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=u.bind(null,s.onerror),s.onload=u.bind(null,s.onload),l&&document.head.appendChild(s)}},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e}(),function(){var e={179:0};i.f.j=function(t,n){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(n,i){r=e[t]=[n,i]}));n.push(r[2]=a);var o=i.p+i.u(t),s=new Error;i.l(o,(function(n){if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=function(t,n){var r,a,o=n[0],s=n[1],l=n[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);l&&l(i)}for(t&&t(n);d<o.length;d++)a=o[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunk_3nRow=self.webpackChunk_3nRow||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a={};i.r(a),i.d(a,{state:function(){return y}});var o={};i.r(o),i.d(o,{clearMarkedPositions:function(){return F},getAiPlayer:function(){return C},getCurrentPlayer:function(){return P},getLoser:function(){return A},getOppositePlayer:function(){return T},getPlayerById:function(){return x},getWinner:function(){return M},increaseWinnerScore:function(){return B},randomChangePlayerSkin:function(){return _},resetPlayersScore:function(){return $},runGameOver:function(){return b},setAiDifficulty:function(){return q},setCurrentPlayer:function(){return L},setFirstMove:function(){return D},setMultiplayerPlayers:function(){return R},setNextPlayerForFirstMove:function(){return O},setPickedSkinInLobby:function(){return w},setPlayerAsHumanOrAI:function(){return G},setPlayerCurrentColor:function(){return S},setPlayerCurrentShape:function(){return E},setShapes:function(){return k},startGame:function(){return I},updateStateFromLS:function(){return f}});var s={};i.r(s),i.d(s,{goAI:function(){return Z},markBoard:function(){return ee},resetForNextGame:function(){return ae},startTurn:function(){return te}});var l={};i.r(l),i.d(l,{exitMultiplayer:function(){return se},setRoom:function(){return oe},setRoomCodeFromUrlParams:function(){return le}});let d=null;const c="noFocusClick",p=["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","Tab","Enter"," ","Home","End","Escape"];document.addEventListener("click",(e=>{if(u(e))return;d&&d.classList.remove(c);const t=document.activeElement;t!==document.body&&(t.classList.remove(c),d=t)})),document.addEventListener("keydown",(e=>{if(!p.includes(e.key))return;d&&d.classList.remove(c);const t=document.activeElement;t.classList.add(c),d=t})),document.addEventListener("keyup",(e=>{if(!p.includes(e.key))return;d&&d.classList.remove(c);const t=document.activeElement;t.classList.add(c),d=t}));const u=e=>0===e.detail,h="multiplayer-3nrow.onrender.com",y={players:[{id:"P1",score:0,name:"Player 1",color:"sky_blue,cyan",shape:"cross",svgShapes:{},getSvgShape(){return this.svgShapes[this.shape]},mark:"X",isAI:!1,difficulty:null},{id:"P2",score:0,name:"Player 2",color:"red,orange",shape:"circle",svgShapes:{},getSvgShape(){return this.svgShapes[this.shape]},mark:"O",isAI:!1,difficulty:"HARD"}],game:{gameOver:!1,gameStart:!1,gameRunning:!1,gameTie:!1,startAgain:!1,playerTurn:"P1",firstMove:"alternate",firstMovePlayer:"P1",winner:null,loser:null,hasAI:!1,winPosition:"",difficulties:["MEDIUM","HARD","CHEATER"],markedPositions:[],board:[[0,1,2],[3,4,5],[6,7,8]],getCurrentPlayer(){const{game:{playerTurn:e},players:t}=y;return t.find((t=>t.id===e))}},onlineMultiplayer:{serverDomain:h,serverUrl:`${location.protocol}//${h}`,serverWS:`ws://${h}`,active:!1,password:"",room:null,roomCode:null,mainPlayer:"P1",opponentPlayer:"P2",hasPickedSkin:!1,pickedItems:{color:"",shape:""}}},m=e=>{const t=[],n=e=>(e.forEach((e=>{Array.isArray(e)?n(e):t.push(e)})),t);return n(e)},g=e=>e[Math.floor(Math.random()*e.length)],v=(e,t)=>{const[n,r]=e.toString().split("e");return Number(Number(Math.round(parseFloat(n+"e"+t))+"e-"+t)+"e"+(r||0))},f=()=>{const{players:e}=y;try{e.forEach((e=>{const{id:t}=e;e.color=j({id:t,type:"color"})||e.color,e.shape=j({id:t,type:"shape"})||e.shape,e.score=Number(j({id:t,type:"score"}))||e.score}))}catch(e){console.error(e)}},b=()=>{const{game:e}=y;e.gameRunning=!1},k=e=>{y.players.forEach((t=>(({player:e,shape:t})=>{e.svgShapes=t})({player:t,shape:e[t.id]})))},w=({type:e,item:t})=>{const{pickedItems:n}=y.onlineMultiplayer;y.onlineMultiplayer.hasPickedSkin=!0,n[e]=t},E=({player:e,shape:t})=>{e.shape=t,H({id:e.id,type:"shape",value:t})},S=({player:e,color:t})=>{e.color=t,H({id:e.id,type:"color",value:t})},P=()=>y.players.find((({id:e})=>y.game.playerTurn===e)),C=()=>y.players.find((({isAI:e})=>e)),x=e=>y.players.find((t=>t.id===e)),T=e=>y.players.filter((t=>t.id!==e))[0],M=()=>x(y.game.winner),A=()=>x(y.game.loser),B=()=>{const e=M();e&&(e.score++,H({id:e.id,type:"score",value:e.score}))},$=()=>{y.players.forEach((e=>{e.score=0,H({id:e.id,type:"score",value:e.score})}))},I=()=>{y.game.gameStart=!0,y.game.gameRunning=!0},L=e=>{y.game.playerTurn=e},D=e=>{const{game:t}=y;t.firstMove=e},R=({mainPlayer:e,opponentPlayer:t})=>{const{onlineMultiplayer:n}=y;n.mainPlayer=e,n.opponentPlayer=t},G=({ai:e,id:t})=>{const{players:n,game:r}=y;n.find((e=>e.id===t)).isAI=e,r.hasAI=e},O=({firstMovePlayer:e}={})=>{const{game:t,players:n}=y,{firstMove:r,firstMovePlayer:i,winner:a,gameTie:o}=t;if(e)return t.playerTurn=e,void(t.firstMovePlayer=e);if("alternate"===r){const e=T(i).id;return t.playerTurn=e,void(t.firstMovePlayer=e)}if("winner"===r){if(o)return void(t.playerTurn=t.firstMovePlayer);const e=a;return t.playerTurn=e,void(t.firstMovePlayer=e)}if("loser"===r){if(o)return void(t.playerTurn=t.firstMovePlayer);const e=T(a).id;t.playerTurn=e,t.firstMovePlayer=e}},q=({id:e,difficulty:t})=>{const{players:n}=y,r=n.find((t=>t.id===e));r.difficulty=t?t.toUpperCase():r.difficulty},_=e=>{const{players:t}=y,n=t.filter((({id:t})=>t!==e.id))[0],r=["circle","cross","triangle","heart"].filter((t=>t!==e.shape&&t!==n.shape)),i=["sky_blue,cyan","green,yellow","red,orange","magenta,pink","purple,blue","white,grey"].filter((t=>t!==e.color&&t!==n.color));e.shape=g(r),e.color=g(i),H({id:e.id,type:"color",value:e.color}),H({id:e.id,type:"shape",value:e.shape})},F=()=>{y.game.markedPositions=[]},H=({id:e,type:t,value:n})=>{try{localStorage.setItem(`${e}_${t}`,n.toString())}catch(e){console.error(e)}},j=({id:e,type:t})=>localStorage.getItem(`${e}_${t}`),N=(e,t)=>e[0]===t&&e[1]===t&&e[2]===t||e[3]===t&&e[4]===t&&e[5]===t||e[6]===t&&e[7]===t&&e[8]===t||e[0]===t&&e[3]===t&&e[6]===t||e[1]===t&&e[4]===t&&e[7]===t||e[2]===t&&e[5]===t&&e[8]===t||e[0]===t&&e[4]===t&&e[8]===t||e[2]===t&&e[4]===t&&e[6]===t,{game:{playerTurn:U},players:W}=y,[K,z]=W;K.mark,z.mark;const V=e=>e.filter((e=>"O"!==e&&"X"!==e)),J=e=>{const{game:{board:t}}=y,n=m(t),r=(e.mark,V(n));if(0===r.length)return 0;if(!("MEDIUM"!==e.difficulty&&"CHEATER"!==e.difficulty||4!==r.length&&5!==r.length))return g(r);let i=X(n),a=Q(n);return null!=a?a:null!=i?i:g(r)},Y=e=>{const t=e%3;let n=0;return e>5?(n=2,{row:n,column:t}):e>2?(n=1,{row:n,column:t}):{row:n,column:t}},X=e=>{const t=[...e];let n=null;for(let e=0;e<t.length;e++){const r=t[e];if("number"==typeof r){if(n=r,t[e]="X",N(t,"X"))return e;t[e]=n}}return null},Q=e=>{const t=[...e];let n=null;for(let e=0;e<t.length;e++){const r=t[e];if("number"==typeof r){if(n=r,t[e]="O",N(t,"O"))return e;t[e]=n}}return null};const Z=({delay:e}={})=>{return t=void 0,n=void 0,i=function*(){const{game:t}=y;if(t.gameOver)return;if(!t.hasAI)return;const n=P();if(!n.isAI)return;yield((e=900)=>new Promise(((t,n)=>{setTimeout((()=>t(!0)),e)})))(e);const r=(e=>{if("CHEATER"===e.difficulty){const t=J(e),n=(({player:e,prevIndex:t})=>{const{game:{board:n}}=y,r=m(n),i=V(r.filter((e=>e!==t)));return 0===i.length||i.length>6||i.length<4?null:g(i)})({player:e,prevIndex:t}),r=[t];return null!=n&&r.push(n),r.map((e=>Y(e)))}return Y(J(e))})(n);ee(r),ne(),re()},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i},ee=e=>{const{game:t}=y,{board:n}=t,r=P(),i=({row:e,column:i})=>{ie({row:e,column:i})||(n[e][i]=r.mark,t.markedPositions.push({column:i,row:e}))};Array.isArray(e)?e.forEach((e=>{i(e)})):i(e)},te=({column:e,row:t})=>{ee({column:e,row:t}),ne(),re()},ne=()=>{const{game:e}=y,{board:t}=e,n=P();if(e.gameOver)return;for(let r=0;r<t.length;r++){if(t[r].every((e=>e===n.mark)))return e.winPosition=`ROW_${r}`,e.gameOver=!0,e.winner=n.id,void(e.loser=T(n.id).id);const i=r;let a=0;for(let r=0;r<t.length;r++)if(t[r][i]===n.mark&&(a++,a===t.length))return e.winPosition=`COL_${i}`,e.gameOver=!0,e.winner=n.id,void(e.loser=T(n.id).id)}let r=0,i=0;for(let a=0;a<t.length;a++){if(t[a][a]===n.mark&&(r++,r===t.length))return e.winPosition="DIAG_TOP_LEFT",e.gameOver=!0,e.winner=n.id,void(e.loser=T(n.id).id);if(t[a][t.length-1-a]===n.mark&&(i++,i===t.length))return e.winPosition="DIAG_BOT_LEFT",e.gameOver=!0,e.winner=n.id,void(e.loser=T(n.id).id)}t.every((e=>e.every((e=>"number"!=typeof e))))&&(e.gameTie=!0,e.gameOver=!0)},re=()=>{const{game:e,players:t}=y,[n,r]=t;e.playerTurn!==n.id?e.playerTurn=n.id:e.playerTurn=r.id},ie=({row:e,column:t})=>"string"==typeof y.game.board[e][t],ae=()=>{const{game:e}=y;e.gameOver=!1,e.gameTie=!1,e.gameRunning=!0,e.winPosition="",e.winner=null,e.loser=null,e.board=[[0,1,2],[3,4,5],[6,7,8]],e.markedPositions=[]},oe=e=>{y.onlineMultiplayer.active=!0,y.onlineMultiplayer.room=e},se=()=>{y.onlineMultiplayer.active=!1,de()},le=()=>{const e=new URLSearchParams(location.search.slice(1));y.onlineMultiplayer.roomCode=e.get("code")},de=()=>{y.onlineMultiplayer.room=null,y.onlineMultiplayer.pickedItems={color:"",shape:""},y.onlineMultiplayer.hasPickedSkin=!1};var ce=Object.assign(Object.assign(Object.assign(Object.assign({},a),o),s),l);function pe(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}pe(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i);const ue=pe(/Edge/i),he=(pe(/Edg/i),pe(/firefox/i),pe(/safari/i)&&!pe(/chrome/i)&&!pe(/android/i)),ye=(pe(/chrome/i)&&pe(/android/i),pe(/android/i),pe(/iP(ad|od|hone)/i)),me="undefined"!=typeof window?ye&&"download"in document.createElement("a"):void 0;if(ye&&!me){const e=document.querySelector("html");e.style.cursor="pointer",e.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"}const ge={};let ve=[],fe=[],be=!1;function ke({button:e,onExit:t,onStart:n,run:r,allow:i=[],not:a=[],toggle:o=!0,stopWhenTargetIsRemoved:s=!0,event:l}){const d=Te(),c={runAllExits:Se,runExit:()=>{t(),Ee(d),we(),Pe()}};if(xe({button:e,toggle:o,customEvent:{runAllExits:Se,event:l}}))return c;r();let p=!0;return ve.push({id:d,button:e,stopWhenTargetIsRemoved:s,isInit:()=>!!p&&(p=!1,!0),allow:i,not:a,onStart:n,onExit:t}),be||(ge.onClick=e=>{const t=e.target,n=ve.length,r={event:e,runAllExits:Se,firedByReselectButton:!1};for(let e=0;e<n;e++){const{id:n,onStart:i,onExit:a,stopWhenTargetIsRemoved:o,allow:s,not:l,isInit:d}=ve[e];d()||i&&i(r)||(l.length&&l.some((e=>t.closest(e)))?(a(r),Ee(n)):s.some((e=>t.closest(e)))||(a(r),Ee(n)))}we(),r.parentOfRemovedElement=null,Pe()},ge.onKeyDown=e=>{const t=e.target,n=ve.length,r={event:e,runAllExits:Se,firedByReselectButton:!1};if(e.key.match(/escape/i)){const e=ve.length-1,{id:t,button:n,onExit:i}=ve[e];i(r),n.focus(),r.parentOfRemovedElement=null,Ee(t),we(),Pe()}if(!e.shiftKey||e.key.match(/tab/i)){if(!e.key.match(/tab/i))return null;for(let e=0;e<n;e++){const{id:n,button:i,onStart:a,onExit:o,allow:s,isInit:l}=ve[e];l()||document.activeElement!==document.body&&(i.contains(t)||a&&a(r)||s.some((e=>t.closest(e)))||(o(r),Ee(n)))}we(),Pe()}},ge.onKeyUp=e=>{const t=e.target,n=ve.length,r={event:e,runAllExits:Se,firedByReselectButton:!1};if(!e.key.match(/tab/i))return null;for(let e=0;e<n;e++){const{id:n,button:i,onStart:a,onExit:o,stopWhenTargetIsRemoved:s,allow:l,not:d,isInit:c}=ve[e];c()||i.contains(t)||a&&a(r)||l.some((e=>t.closest(e)))||(o(r),Ee(n))}we(),Pe()},Ce()),c}const we=()=>{fe.length&&(ve=ve.filter((({id:e})=>!fe.includes(e))),fe=[])},Ee=e=>{fe.push(e)},Se=()=>{const e=ve.length;for(let t=0;t<e;t++){const{onExit:e}=ve[t];e()}ve=[],Pe()},Pe=()=>{if(ve.length)return;const{onClick:e,onKeyDown:t,onKeyUp:n}=ge;be=!1,document.removeEventListener("click",e),document.removeEventListener("keydown",t),document.removeEventListener("keyup",n)},Ce=()=>{const{onClick:e,onKeyDown:t,onKeyUp:n}=ge;be=!0,document.addEventListener("click",e),document.addEventListener("keydown",t),document.addEventListener("keyup",n)},xe=({button:e,toggle:t,customEvent:n})=>{const r=(i=e,ve.findIndex((e=>e.button.contains(i))));var i,a;if(r>-1){if(!t)return!0;n.firedByReselectButton=!0;const{onExit:e}=ve[r];return e(n),a=r,ve.splice(a,1),Pe(),!0}return!1},Te=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),Me=e=>{const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild},Ae=(e,{time:t,leading:n=!1,throttle:r=null})=>{let i=0,a=null,o=!0,s=!1;return(...l)=>{if(n&&o&&(e(...l),o=!1),null!=r&&(null==a&&(a=Date.now()),Date.now()-a>=r&&(e(...l),a=null,s=!0)),s)return clearTimeout(i),void(s=!1);clearTimeout(i),i=window.setTimeout((()=>{n||e(...l),o=!0}),t)}},Be=({svg:e,id:t,ignoreClass:n,ignoreUrl:r})=>e.replace(/(id|class)="([^"]*)"/g,((e,r,i)=>n&&"class"===r&&n.includes(i)?e:`${r}="${i+t}"`)).replace(/url\(([^)]*)\)/g,((e,n)=>r&&r.includes(n)?e:`url(${n+t})`)).replace(/(xlink:)?href="([^"]*)"/g,((e,n,r)=>`${n||""}href="${r+t}"`)),$e=({players:e,id:t})=>e.filter((e=>e.id!==t))[0],Ie=e=>"string"!=typeof e?e:"#"!==e[0]||e.match(/#|\.|\[/g)?document.querySelector(e):document.getElementById(e.slice(1)),Le=()=>document.body.offsetWidth,De=({obj:e,type:t})=>{let n="";for(let i in e){const a=e[i];"data"===t&&(i=(r=i)[0].toLowerCase()+r.slice(1,r.length).replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)));let o=`${i}="${a}"`;"data"===t&&(o="data-"+o),n+=o}var r;return n},Re=(e,{attr:t,val:n})=>{const r=e.getAttribute(t);return!!r&&r===n},Ge=document.querySelector(".tooltips-container");class Oe{constructor({message:e,tooltipTargetEl:t}){this.message="",this.tooltipTargetEl=null,this.tooltipContainerEl=null,this.tooltipShellEl=null,this.tooltipEl=null,this.tooltipArrowEl=null,this.debouncedOnMousemoveTargetEl=e=>{},this.tooltipFocusOutEvent=null,this.startinScrollX=0,this.startinScrollY=0,this.tooltipGenerated=!1,this.activatedByClick=!1,this.activatedByHover=!1,this.position="auto",this.active=!1,this.disabled=!1,this.onScrollUpdatePosition=()=>{const{scrollX:e,scrollY:t}=window,n=-1*(e-this.startinScrollX),r=-1*(t-this.startinScrollY);this.tooltipContainerEl.style.transform=`translate(${n}px, ${r}px)`},this.onClickTargetEl=()=>{this.addTooltip({triggeredBy:"click"})},this.onMousemoveTargetEl=e=>{const t=document.elementFromPoint(e.clientX,e.clientY);this.tooltipTargetEl.contains(t)||this.tooltipContainerEl.contains(t)||(this.hide(),document.removeEventListener("mousemove",this.debouncedOnMousemoveTargetEl))},this.onMouseenterTargetEl=()=>{this.active||(this.addTooltip({triggeredBy:"hover"}),this.debouncedOnMousemoveTargetEl=Ae(this.onMousemoveTargetEl,{time:200,leading:!1,throttle:200}),document.addEventListener("mousemove",this.debouncedOnMousemoveTargetEl))},this.onTransitionEnd=e=>{e.target===this.tooltipContainerEl&&(this.tooltipContainerEl.classList.remove("active"),this.tooltipContainerEl.removeEventListener("transitionend",this.onTransitionEnd))},this.message=e,this.tooltipTargetEl=t,this.addTooltipTargetEvents()}addScrollEventUpdatePosition(){const{scrollX:e,scrollY:t}=window;this.startinScrollX=e,this.startinScrollY=t,this.active&&this.onScrollUpdatePosition(),window.addEventListener("scroll",this.onScrollUpdatePosition,{passive:!0})}removeScrollEventUpdatePosition(){window.removeEventListener("scroll",this.onScrollUpdatePosition)}addTooltipTargetEvents(){this.tooltipTargetEl.addEventListener("click",this.onClickTargetEl),this.tooltipTargetEl.addEventListener("mouseenter",this.onMouseenterTargetEl)}removeTooltipTargetEvents(){this.tooltipTargetEl.removeEventListener("click",this.onClickTargetEl),this.tooltipTargetEl.removeEventListener("mouseenter",this.onMouseenterTargetEl),document.removeEventListener("mousemove",this.debouncedOnMousemoveTargetEl)}toolTipInnerMarkup({msg:e}){return`\n    <div class="tooltip-shell">\n      <div class="arrow arrow-up"></div>\n      <div class="tooltip" role="tooltip">${e}</div>\n    </div>\n    `}toolTipMarkup(){const e=this.message;return`\n    <div class="tooltip-container">\n      ${this.toolTipInnerMarkup({msg:e})}\n    </div>\n    `}hideAndListenTransitionEnd(){this.tooltipContainerEl&&(this.tooltipContainerEl.classList.remove("visible"),this.tooltipContainerEl.addEventListener("transitionend",this.onTransitionEnd))}reveal(){this.tooltipContainerEl.removeEventListener("transitionend",this.onTransitionEnd),this.tooltipContainerEl.classList.add("active"),this.tooltipContainerEl.classList.add("visible")}create(){const e=Me(this.toolTipMarkup());this.tooltipContainerEl=e,this.tooltipShellEl=e.querySelector(".tooltip-shell"),this.tooltipEl=e.querySelector(".tooltip"),this.tooltipArrowEl=e.querySelector(".arrow"),Ge.appendChild(e),this.tooltipGenerated=!0,this.calculatePosition(),this.calculatePositionToWithinViewport(),this.reveal()}calculatePosition(){this.tooltipContainerEl.style.transform="";const e=this.tooltipTargetEl.getBoundingClientRect(),t=this.tooltipShellEl.getBoundingClientRect();this.tooltipContainerEl.style.top=e.bottom-3+"px",this.tooltipContainerEl.style.left=e.left-t.width/2+e.width/2+"px"}calculatePositionToWithinViewport(){const e=this.tooltipShellEl.getBoundingClientRect(),t=window.innerHeight,n=window.innerWidth;if(e.left<10?this.tooltipEl.style.left=`${Math.abs(e.left)+20}px`:e.right>n-10?this.tooltipEl.style.left=n-20-e.right+"px":this.tooltipEl.style.left="",e.bottom>t-10||"top"===this.position)return this.tooltipShellEl.classList.add("top"),this.tooltipArrowEl.classList.remove("arrow-up"),void this.tooltipArrowEl.classList.add("arrow-down");(e.top<10||"bottom"===this.position)&&(this.tooltipShellEl.classList.remove("top"),this.tooltipArrowEl.classList.add("arrow-up"),this.tooltipArrowEl.classList.remove("arrow-down"))}addTooltip({triggeredBy:e="click"}={}){this.active&&"hover"===e||(this.active||this.addScrollEventUpdatePosition(),"click"!==e||!this.active||this.activatedByClick?(this.active=!0,"click"===e&&(this.activatedByClick=!0),"hover"===e&&(this.activatedByHover=!0),this.tooltipFocusOutEvent=ke({button:this.tooltipTargetEl,allow:[".tooltip-shell"],run:()=>{this.tooltipGenerated?(this.calculatePosition(),this.calculatePositionToWithinViewport(),this.reveal()):this.create()},onExit:()=>{this._removeTooltip()}})):document.removeEventListener("mousemove",this.debouncedOnMousemoveTargetEl))}_removeTooltip(){this.hideAndListenTransitionEnd(),this.active=!1,this.activatedByClick=!1,this.activatedByHover=!1,this.tooltipFocusOutEvent=null,this.removeScrollEventUpdatePosition(),document.removeEventListener("mousemove",this.debouncedOnMousemoveTargetEl)}updateTooltip({message:e,updateMarkup:t}){if(null!=e){if(this.message=e,!this.tooltipEl)return;this.tooltipEl.innerHTML=e}t&&t(this.tooltipEl)}show({position:e}={}){e&&(this.position=e),this.addTooltip({triggeredBy:"click"})}hide(){null!=this.tooltipFocusOutEvent&&(this.tooltipFocusOutEvent.runExit(),this.tooltipFocusOutEvent=null)}enable(){this.disabled=!1,this.addTooltipTargetEvents()}disable(){this.active=!1,this.disabled=!0,this.hide(),this.removeTooltipTargetEvents(),this.removeScrollEventUpdatePosition()}destroy(){this._removeTooltip(),this.removeScrollEventUpdatePosition(),this.removeTooltipTargetEvents(),this.tooltipContainerEl&&this.tooltipContainerEl.remove()}}const qe=["sky_blue,cyan","green,yellow","red,orange","magenta,pink","purple,blue","white,grey"],_e={"sky_blue,cyan":["#0cf","#5fd"],"green,yellow":["#39f300","#f3ff08"],"red,orange":["#ff0051","#ffc300"],"magenta,pink":["#ff005b","#ff00e4"],"purple,blue":["#e600ff","#5f55ff"],"white,grey":["#fff","#ccc"]},Fe=["circle","cross","triangle","heart"],He='\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="100" viewBox="0 0 26.4583 26.4583" version="1.1" >\n  <g transform="translate(-40.2399 6.4228)" id="g3764" filter="url(#drop-shadow-filter)">\n    <path d="m 53.469328,15.12263 a 8.316061,8.3162622 0 0 0 7.20192,-4.15814 8.316061,8.3162622 0 0 0 0,-8.3162599 8.316061,8.3162622 0 0 0 -7.20192,-4.15813" class="animate__circle-left" id="path14" fill="none" fill-opacity=".9202" stroke="url(#b)" stroke-width="2.6458" stroke-linecap="round" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="none" stroke-opacity="1"/>\n    <path d="m 53.469338,15.12263 a 8.316061,8.3162622 0 0 1 -8.049378,-6.2271099 8.316061,8.3162622 0 0 1 4.005148,-9.35577 8.316061,8.3162622 0 0 1 10.061675,1.52651" class="animate__circle-right" id="path16" opacity="1" fill="none" fill-opacity="1" stroke="url(#b)" stroke-width="2.6458" stroke-linecap="round" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="none" stroke-opacity="1"/>\n  </g>\n</svg>\n',je='\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="100" viewBox="0 0 26.4583 26.4583" version="1.1" >\n  <g filter="url(#drop-shadow-filter)">\n    <g class="animate__left-dot" fill="url(%primaryColor%)">\n      <circle cx="6.4855" cy="19.9915" r="1.3368" />\n    </g>\n    <g class="animate__right-dot" fill="url(%secondaryColor%)">\n      <circle r="1.3368" cy="19.9915" cx="19.9756" />\n    </g>\n  </g>\n  <g fill="none" stroke-width="2.6458" stroke-linecap="round" filter="url(#drop-shadow-filter)">\n    <g stroke="url(#c)" transform="translate(0 -.0191)">\n      <path d="M 6.4855595,6.4855597 19.972772,19.972772" class="animate__right-line"/>\n    </g>\n    <g stroke="url(#d)" transform="translate(0 -.0191)">\n      <path d="M 19.972772,6.4855597 6.4855597,19.972772" class="animate__left-line"/>\n    </g>\n  </g>\n</svg>\n',Ne='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 26.4583 26.4583" height="100" width="100">\n  <g filter="url(#drop-shadow-filter)">\n  <path class="animate__first-line" d="M 21.666126,20.554903 H 4.792205" fill="none" stroke="url(#b)" stroke-width="2.6458" stroke-linecap="round"/>\n  <path class="animate__second-line"  d="M 4.792205,20.554903 13.229166,5.941659" fill="none" stroke="url(#c)" stroke-width="2.6458" stroke-linecap="round"/>\n  <path class="animate__third-line"  d="m 13.229166,5.941659 8.436959,14.613245" fill="none" stroke="url(#d)" stroke-width="2.6458" stroke-linecap="round"/>\n  </g>\n</svg>',Ue='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 26.4583 26.4583" height="100" width="100">\n  <path class="animate__heart" filter="url(#drop-shadow-filter)" d="m 17.32581,6.9713105 c -0.985,0.076646 -1.966443,0.5097125 -2.723879,1.2811742 L 13.230034,9.6509322 11.85814,8.2524847 C 10.351213,6.7175032 7.9449805,6.5197347 6.3838297,7.8320647 4.3324424,9.5589185 4.6270576,12.382265 6.091749,13.875045 l 6.981183,7.111733 v 0.0023 c 0.0507,0.0507 0.102415,0.07966 0.157102,0.07966 0.05469,0 0.106393,-0.02894 0.157105,-0.07966 v -0.0023 l 6.981183,-7.111733 C 21.821206,12.39407 22.123746,9.5545948 20.076241,7.8276394 19.299642,7.1734488 18.310811,6.8946648 17.32581,6.9713105 Z m 0.0023,0.059743 c 0.970403,-0.075607 1.946764,0.1996118 2.710601,0.8430526 2.020533,1.7042057 1.716631,4.5022909 0.287656,5.9588959 l -6.981183,7.111734 c -0.04482,0.04482 -0.08217,0.06417 -0.115062,0.06417 -0.03288,0 -0.06803,-0.01936 -0.11285,-0.06417 L 6.133843,13.833002 C 4.6927958,12.364321 4.3991053,9.5828389 6.4237113,7.8785318 7.9593611,6.5876383 10.329767,6.7804724 11.81615,8.2945263 l 1.413938,1.4427026 1.413938,-1.4427026 c 0.747181,-0.761017 1.713645,-1.1878654 2.684051,-1.2634724 z" style="line-height:normal;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;text-orientation:mixed;white-space:normal;shape-padding:0;isolation:auto;mix-blend-mode:normal;solid-color:#000;solid-opacity:1" color="#000" font-weight="400" font-family="sans-serif" overflow="visible" stroke-linecap="round" fill="none" stroke="url(#f)" stroke-width="2.6004"/>\n</svg>',We='\n  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="100" viewBox="0 0 26.458 26.458">\n  <g class="animate__square-dot-1" style="opacity: 0;">\n    <circle  cx="13.229" cy="13.229" r="1.337" fill="url(%primaryColor%)" fill-rule="evenodd"/>\n  </g>\n  <g class="animate__square-dot-2" style="opacity: 0;">\n    <circle  cx="13.229" cy="13.229" r="1.337" fill="url(%primaryColor%)" fill-rule="evenodd"/>\n  </g>\n  <g class="animate__square-dot-3" style="opacity: 0;">\n    <circle  r="1.337" cy="13.229" cx="13.229" fill="url(%secondaryColor%)" fill-rule="evenodd"/>\n  </g>\n  <g class="animate__square-dot-4" style="opacity: 0;">\n    <circle  r="1.337" cy="13.229" cx="13.229" fill="url(#g)" fill-rule="evenodd"/>\n  </g>\n  <g filter="url(#drop-shadow-filter)" stroke-width="2.646" stroke-linecap="round">\n    <path class="animate__square-line-1" d="M6.486 6.486v13.487" stroke="url(#c)"/>\n    <path class="animate__square-line-2" d="M6.486 6.486h13.487" stroke="url(#d)"/>\n    <path class="animate__square-line-3" d="M19.973 6.486v13.487" stroke="url(#e)"/>\n    <path class="animate__square-line-4" d="M19.973 19.973H6.486" stroke="url(#f)"/>\n  </g>\n</svg>\n  ',Ke='\n  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="100" viewBox="0 0 26.458 26.458">\n  <g stroke-width="2.646"  stroke-linecap="round">\n    <g filter="url(#drop-shadow-filter)" >\n      <path d="M51.21 11.514L44.47 1.402" stroke="url(#f)" transform="translate(-37.982 10.182)"/>\n      <path d="M19.971 11.582L13.23 21.696" stroke="url(%primaryColor%)"/>\n    </g>\n    <g filter="url(#drop-shadow-filter)">\n      <path d="M57.953 1.4L51.21-5.342" stroke="url(#g)" transform="translate(-37.982 10.182)"/>\n      <path d="M6.487 11.582L13.23 4.84" stroke="url(%primaryColor%)"/>\n    </g>\n  </g>\n</svg>\n  ',ze='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  version="1.1" viewBox="0 0 26.4583 26.4583" height="100" width="100">\n  <defs id="defs2">\n    <linearGradient id="linearGradient3722">\n      <stop id="stop3718" class="line-color-primary" offset="0" stop-color="#2a7fff" stop-opacity="1"/>\n      <stop id="stop3720" class="line-color-secondary" offset="1" stop-color="#2ae4ff" stop-opacity="1"/>\n    </linearGradient>\n    <linearGradient gradientUnits="userSpaceOnUse" y2="283.7708" x2="25.5937" y1="283.7708" x1=".8646" id="linearGradient3724" xlink:href="#linearGradient3722"/>\n    <linearGradient gradientTransform="rotate(45 10.9613 289.246)" y2="283.7708" x2="25.5937" y1="283.7708" x1=".8646" gradientUnits="userSpaceOnUse" id="linearGradient3738" xlink:href="#linearGradient3722"/>\n  </defs>\n  <g filter="url(#drop-shadow-filter-slash)">\n    <g class="animate__line-short" style="transform-origin:13.2291665px 13.2291665px">\n      <g class="animate__line-short-inner translate" style="transform-origin:13.2291665px 13.2291665px">\n        <path class="path3716"  d="M 1.5355285,283.77082 H 24.922805" transform="translate(0 -270.5417)" fill="none" stroke-width="1.3229" stroke="url(#linearGradient3724)"  stroke-linecap="round"/>\n      </g>\n    </g>\n  </g>\n</svg>',Ve='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  version="1.1" viewBox="0 0 26.4583 26.4583" height="100" width="100">\n  <defs id="defs2">\n    <linearGradient id="linearGradient3722">\n      <stop id="stop3718" class="line-color-primary" offset="0" stop-color="#2a7fff" stop-opacity="1"/>\n      <stop id="stop3720" class="line-color-secondary" offset="1" stop-color="#2ae4ff" stop-opacity="1"/>\n    </linearGradient>\n    <linearGradient gradientUnits="userSpaceOnUse" y2="283.7708" x2="25.5937" y1="283.7708" x1=".8646" id="linearGradient3724" xlink:href="#linearGradient3722"/>\n    <linearGradient gradientTransform="rotate(45 10.9613 289.246)" y2="283.7708" x2="25.5937" y1="283.7708" x1=".8646" gradientUnits="userSpaceOnUse" id="linearGradient3738" xlink:href="#linearGradient3722"/>\n  </defs>\n  <g filter="url(#drop-shadow-filter-slash)">\n    <g class="animate__line-long"  style="transform-origin:13.2291665px 13.2291665px">\n      <path  d="M 1.7532815,272.29493 24.705052,295.24671" class="path3726" transform="translate(0 -270.5417)" fill="none" stroke="url(#linearGradient3738)" stroke-width="1.3229" stroke-linecap="round"/>\n    </g>\n  </g>\n</svg>',Je='<svg xmlns="http://www.w3.org/2000/svg" width="315.0117" height="1464.7015" viewBox="0 0 83.3469 387.5356">\n  <g fill-rule="evenodd" transform="translate(686.7976 -48.9848)">\n    <circle fill="currentColor" r="41.6734" cy="90.6583" cx="-645.1242"/>\n    <circle fill="currentColor" cx="-645.1242" cy="242.7526" r="41.6734"/>\n    <circle fill="currentColor" r="41.6734" cy="394.847" cx="-645.1242"/>\n  </g>\n</svg>',Ye='\n<svg xmlns="http://www.w3.org/2000/svg" width="25" height="14.112" viewBox="0 0 6.615 3.734"><path d="M6.188.427l-2.88 2.88M.426.427l2.88 2.88" fill="none" stroke="#5966ca" stroke-width=".853" stroke-linecap="round"/></svg>\n',Xe='\n<svg xmlns="http://www.w3.org/2000/svg" width="37.795" height="37.795" viewBox="0 0 10 10">\n  <circle class="radio-icon-unselected" shape-rendering="geometricPrecision" cx="5" cy="5" r="4.375" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>\n    <circle class="radio-icon-selected" shape-rendering="geometricPrecision" cx="5" cy="5" r="3.412" fill="#fff" stroke="currentColor" stroke-width="3.175" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',Qe='\n<svg xmlns="http://www.w3.org/2000/svg" width="57.875" height="57.875" viewBox="0 0 15.313 15.313">\n  <path d="M14.4.913L.913 14.4m0-13.487L14.4 14.4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n',Ze='\n<svg xmlns="http://www.w3.org/2000/svg" width="47.017" height="38.236" viewBox="0 0 12.44 10.117"><g  stroke="currentColor" stroke-width="1.587" stroke-linecap="round"><path d="M.89 5.058l4.327 4.265"/><path d="M.89 5.058L5.216.794"/><path d="M11.646 5.058H.908"/></g></svg>\n  ',et='\n  <svg xmlns="http://www.w3.org/2000/svg" width="518.547" height="518.547" viewBox="0 0 137.199 137.199"><path class="layer-main" d="M0 3.42s-31.09 60.009-23.087 89.893C-20.242 103.94-.001 116.9-.001 116.9H0c4.629 2.415 8.937 2.109 13.525 1.167 33.837-6.948 98.734-45.162 123.674-44.993 0 0 13.239-4.655 15.426-10.472C159.802 43.52 137.2 3.42 137.2 3.42z" fill="var(--menu-bg-main)"/><path class="layer-2" d="M137.199 66.268c-24.94-.161-89.837 36.196-123.674 42.806-4.588.896-8.896 1.187-13.525-1.11 0 0-10.5-7.695-14.344-4.22-3.845 3.475 2.975 15.866 2.975 15.866L0 126.674 3.37 137.2h133.829s13.75 1.84 17.818-2.571c12.465-13.515 7.896-44.097 3.45-55.049-4.9-12.07-21.268-13.312-21.268-13.312z" fill="var(--menu-bg-layer-2)"/><path class="layer-3" d="M137.199 78.87c-10.07.363-36.395 3.706-61.032 27.196-31.274 29.818-63.977 24.947-63.977 24.947l-6.694-1.48L0 127.004s-18.44-4.624-19.495 1.817C-20.645 135.837 0 137.474 0 137.474l4.26.065 51.924 1.226 81.015-1.566s19.935-19.584 19.54-31.286c-.22-6.543-2.326-17.666-7.647-23.167-4.195-4.336-11.893-3.876-11.893-3.876z" fill="var(--menu-bg-layer-3)"/><path class="layer-1" d="M0 0s-26.709-8.092-34.468.382c-6.755 7.378-5.205 23.313 2.306 29.92C-24.102 37.392 0 28.666 0 28.666c10.585-5.78 29.592-14.754 53.187-19.76 30.069-6.38 67.025-4.153 84.012-2.59 0 0 13.171 3.896 23.115 9.933 12.587 7.642 18.177-8.877 11.254-12.843C164.865-.434 139.58-1.547 137.2 0z" fill="var(--menu-bg-layer-1)"/></svg>\n  ',tt='\n<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 13.229 13.229"><circle fill="none" stroke="currentColor" stroke-width="1.314" stroke-linecap="round" stroke-linejoin="round" paint-order="fill markers stroke" transform="matrix(0 -1 -1 0 0 0)" cx="-6.614" cy="-6.614" r="5.958"/></svg>\n  ';class nt{constructor({root:e}){this.data={},this.hasRendered=!1,this.parentEl=Ie(e),this.root=e}clear(){const e=this.parentEl;for(;e.firstChild;)e.removeChild(e.lastChild)}clearChildren(e){(e=>{for(;e.firstChild;)e.removeChild(e.lastChild)})(e)}generateFallback(){return""}generateMarkup(){return""}reflow(){Le()}destroy(){this.hasRendered=!1,this.parentEl&&(this.parentEl.remove(),this.parentEl=null)}markupDidGenerate(){}renderFallback(){this.clear(),this.parentEl.insertAdjacentHTML("afterbegin",this.generateFallback())}render(e){this.parentEl=Ie(this.root),this.parentEl&&(e&&(this.data=e),this.clear(),this.parentEl.insertAdjacentHTML("afterbegin",this.generateMarkup()),this.markupDidGenerate(),this.hasRendered=!0)}update(e){this.clear(),this.parentEl.insertAdjacentHTML("afterbegin",e)}setData(e){this.data=Object.assign(Object.assign({},this.data),e)}}const rt="ArrowDown",it="ArrowUp",at="ArrowLeft",ot="ArrowRight",st="Home",lt="End";var dt=new class extends nt{constructor(){super({root:".board"}),this.tooltipTalkBubble=null,this.playerCanSelectCell=!1,this.playerCanNavigateCells=!1,this.boardCleared=!0,this.startingGameTriggeredByKeyboard=!1,this.getCellElement=({column:e,row:t})=>this.parentEl.querySelector(`[data-row="${t}"] [data-column="${e}"]`),this.isCellSelected=e=>{const t=e.dataset.selected;return!!t&&t.match(/true/i)},this.onFocusNewCell=e=>{this.focusableCell=e},this.focusableCell=this.parentEl.querySelector('[data-column="0"]'),this.slashContainer=this.parentEl.querySelector(".line-svg"),this.data={}}showPlayerTurnTalkBubble(){const{game:e}=this.data;if(e.hasAI)return;const t=`.player-btn-options[data-player-id="${e.getCurrentPlayer().id}"]`,n=document.querySelector(t);this.tooltipTalkBubble||(this.tooltipTalkBubble=new Oe({message:"Wait, it's still my turn!",tooltipTargetEl:n}),this.tooltipTalkBubble.show(),setTimeout((()=>{if(!this.tooltipTalkBubble.active)return this.tooltipTalkBubble.destroy(),void(this.tooltipTalkBubble=null);this.tooltipTalkBubble.hide(),setTimeout((()=>{this.tooltipTalkBubble.destroy(),this.tooltipTalkBubble=null}),200)}),1500))}getPositionFromCell(e){var t;return{row:Number(null===(t=e.parentElement)||void 0===t?void 0:t.dataset.row),column:Number(e.dataset.column)}}selectCell({cell:e,player:t}){const{game:{getCurrentPlayer:n}}=this.data;t=t||n(),this.isCellSelected(e)||(e.setAttribute("aria-selected","true"),e.setAttribute("data-selected","true"),e.setAttribute("data-player-id",t.id),e.setAttribute("aria-label",`Marked by ${t.name}`),this.playerCanSelectCell=!1)}updateEmptyCellsAriaLabel(e){const t=this.parentEl.querySelectorAll('[data-selected="false"]'),n=e.isAI?`Waiting for ${e.name}.`:"It's your turn";t.forEach((e=>{e.setAttribute("aria-label",`Empty. ${n}`)}))}renderFilledCells(e){const{game:{markedPositions:t}}=this.data,{shape:n,svgShapes:r}=e;t.forEach((t=>{const i=this.getCellElement(t);this.selectCell({cell:i,player:e});const a=Me(r[n]);(ye||he)&&(a.style.animation="Force-Full-Repaint-Frame 2000ms"),i.appendChild(a),setTimeout((()=>{this.boardCleared||i.classList.add("block-animation")}),2e3),setTimeout((()=>{this.boardCleared=!1}),1e3)}))}prevCellChangeTabindex(){const e=this.parentEl.querySelector('[data-column][tabindex="0"]');e&&e.setAttribute("tabindex","-1")}addHandlerCell(e){this.parentEl.addEventListener("click",(t=>{const n=t.target.closest("[data-column]");if(n)if(this.prevCellChangeTabindex(),this.onFocusNewCell(n),n.setAttribute("tabindex","0"),this.playerCanSelectCell)this.isCellSelected(n)||(this.selectCell({cell:n}),e(this.getPositionFromCell(n)));else{if(this.isCellSelected(n))return;this.showPlayerTurnTalkBubble()}})),this.parentEl.addEventListener("keydown",(t=>{const n=t.target.closest("[data-column]");if(n)if(((e,{onFocusNewCell:t})=>{var n,r;if(r=e.key,![rt,it,at,ot,st,lt].includes(r))return;const i=document.activeElement,a=Number(null===(n=i.parentElement)||void 0===n?void 0:n.dataset.row),o=Number(i.dataset.column),s=document.querySelectorAll("[data-row]").length-1,l=document.querySelector("[data-row]").children.length-1,d=({column:e,row:n})=>{n<0||n>s||e<0||e>l||(i.setAttribute("tabindex","-1"),(({column:e,row:t,onFocusNewCell:n})=>{const r=document.querySelector(`[data-row="${t}"] [data-column="${e}"]`);r.focus(),r.setAttribute("tabindex","0"),n(r)})({row:n,column:e,onFocusNewCell:t}))};if(e.ctrlKey&&e.key===st)d({row:0,column:0});else if(e.ctrlKey&&e.key===lt)d({row:s,column:l});else switch(e.key){case it:return d({row:a-1,column:o});case rt:return d({row:a+1,column:o});case ot:return d({row:a,column:o+1});case at:return d({row:a,column:o-1});case st:return d({row:a,column:0});case lt:d({row:a,column:l})}})(t,{onFocusNewCell:this.onFocusNewCell}),this.playerCanSelectCell)[" ","Enter"].includes(t.key)&&!this.isCellSelected(n)&&(this.selectCell({cell:n}),e(this.getPositionFromCell(n)));else{if(this.isCellSelected(n))return;this.showPlayerTurnTalkBubble()}}))}updateShapeInCells(e){this.parentEl.querySelectorAll(`[data-player-id="${e.id}"]`).forEach((t=>{t.classList.add("block-animation"),t.innerHTML=e.getSvgShape()}))}waitingForOtherPlayer(e){this.updateEmptyCellsAriaLabel(e)}updateBoard({data:e,player:t}){this.data=e;const{game:n}=e;this.renderFilledCells(t),n.gameOver&&((({player:e,line:t,winPosition:n})=>{(({winPosition:e,slash:t})=>{let n={},r={},i={};switch(e){case"DIAG_TOP_LEFT":t.innerHTML=Ve;break;case"DIAG_BOT_LEFT":t.innerHTML=Ve,n=t.querySelector(".animate__line-long"),n.style.transform="rotate(90deg)";break;case"ROW_0":t.innerHTML=ze,r=t.querySelector(".animate__line-short"),r.style.transform="translateY(-33.8%)";break;case"ROW_1":t.innerHTML=ze;break;case"ROW_2":t.innerHTML=ze,r=t.querySelector(".animate__line-short"),r.style.transform="translateY(33.8%)";break;case"COL_0":t.innerHTML=ze,r=t.querySelector(".animate__line-short"),i=t.querySelector(".animate__line-short-inner"),r.style.transform="rotate(90deg)",i.style.transform="translateY(33.8%)";break;case"COL_1":t.innerHTML=ze,r=t.querySelector(".animate__line-short"),r.style.transform="rotate(90deg)";break;case"COL_2":t.innerHTML=ze,r=t.querySelector(".animate__line-short"),i=t.querySelector(".animate__line-short-inner"),r.style.transform="rotate(90deg)",i.style.transform="translateY(-33.8%)"}})({slash:t,winPosition:n})})({player:t,winPosition:n.winPosition,line:this.slashContainer}),this.updateWinnerSlashColor(t.color))}allowPlayerToSelect(){this.playerCanSelectCell=!0}allowPlayerToNavigate(){this.playerCanNavigateCells=!0,this.focusableCell.tabIndex=0}preventPlayerToNavigate(){this.playerCanNavigateCells=!1,this.focusableCell.removeAttribute("tabindex")}preventPlayerToSelect(){this.playerCanSelectCell=!1}updateWinnerSlashColor(e){const[t,n]=_e[e],r=this.parentEl.querySelectorAll(".line-color-primary"),i=this.parentEl.querySelectorAll(".line-color-secondary");r.forEach((e=>{e.style.stopColor=t})),i.forEach((e=>{e.style.stopColor=n}))}startGame(){this.allowPlayerToNavigate(),this.startingGameTriggeredByKeyboard&&this.focusableCell.classList.add("noFocusClick"),this.focusableCell.focus(),this.parentEl.removeAttribute("aria-hidden"),this.parentEl.classList.remove("pre-game"),setTimeout((()=>{this.parentEl.classList.remove("transition-out")}),100),this.startingGameTriggeredByKeyboard=!1}preGame(){this.preventPlayerToSelect(),this.preventPlayerToNavigate(),setTimeout((()=>{this.parentEl.classList.add("transition-out"),this.parentEl.classList.add("pre-game")}),300),this.parentEl.setAttribute("aria-hidden","true")}clearBoard(){this.parentEl.querySelectorAll(".cell").forEach((e=>{this.clearChildren(e),e.setAttribute("aria-selected","false"),e.setAttribute("data-selected","false"),e.setAttribute("aria-label","empty"),e.removeAttribute("data-player-id"),e.classList.remove("block-animation")})),this.clearChildren(this.slashContainer),this.boardCleared=!0}render(e){return this.data=e,""}},ct=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const pt=[],ut=[],ht=e=>Number(e.match(/\d+/)[0])<50,yt=({el:e,displayNone:t,transition:n="200ms",duration:r=200,useTransitionEvent:i=!0,delay:a,onCancel:o,onStart:s,onEnd:l,onSentry:d})=>new Promise((c=>(({el:e,displayNone:t,transition:n="200ms",duration:r=200,useTransitionEvent:i=!0,delay:a,onStart:o,onEnd:s,onCancel:l,onSentry:d,resolve:c})=>ct(void 0,void 0,void 0,(function*(){const p=e=>{y.removeEventListener("transitionend",u),t&&(y.style.display="none",y.style.opacity=""),s&&s(y,e),ft({element:y,instances:pt}),y.style.pointerEvents="",c(!0)},u=e=>{e.target===y&&(m++,m<(()=>{if(g)return g;const e=y.style.transition.match(/,/g);return e?e.length+1:1})()||p(e))},h=()=>y.addEventListener("transitionend",u),y=Ie(e);gt({element:y,instances:pt,onTransitionEnd:u,onCancel:l,onSentry:d,resolve:c});let m=0,g=0;if(n+=" opacity",y.style.pointerEvents="none",o)return a&&(yield bt(a)),o(y),i?(h(),void(ht(n)&&p())):void setTimeout((()=>{t&&(y.style.display="none"),s&&s(y),y.style.pointerEvents="",y.style.opacity="",c(!0)}),r);a&&(yield bt(a)),y.style.opacity="1",y.style.webkitTransition=n,y.style.transition=n,Le(),y.style.opacity="0",h(),ht(n)&&p()})))({el:e,displayNone:t,delay:a,duration:r,onCancel:o,onEnd:l,onStart:s,onSentry:d,transition:n,useTransitionEvent:i,resolve:c}))),mt=({el:e,removeDisplayNone:t,transition:n="200ms",delay:r=0,onSentry:i,onStart:a,onCancel:o,onEnd:s})=>new Promise((l=>(({el:e,removeDisplayNone:t,transition:n="200ms",delay:r=0,onSentry:i,onStart:a,onEnd:o,onCancel:s,resolve:l})=>ct(void 0,void 0,void 0,(function*(){const d=e=>{u.removeEventListener("transitionend",c),o&&o(u),u.style.opacity="",u.style.webkitTransition="",u.style.transition="",ft({element:u,instances:ut}),l(!0)},c=e=>{e.target===u&&(h++,h<(()=>{if(y)return y;const e=u.style.transition.match(/,/g);return e?e.length+1:1})()||d())},p=()=>u.addEventListener("transitionend",c),u=Ie(e);gt({element:u,instances:ut,onTransitionEnd:c,onCancel:s,onSentry:i,resolve:l}),n+=" opacity";let h=0,y=0;if(a)return r&&(yield bt(r)),t&&(u.style.display="",Le()),a(u),p(),void(ht(n)&&d());r&&(yield bt(r)),t&&(u.style.display=""),u.style.opacity="0",u.style.webkitTransition=n,u.style.transition=n,Le(),u.style.opacity="1",p(),ht(n)&&d()})))({el:e,removeDisplayNone:t,resolve:l,delay:r,onEnd:s,onStart:a,onCancel:o,onSentry:i,transition:n}))),gt=({instances:e,element:t,onTransitionEnd:n,onCancel:r,onSentry:i,resolve:a})=>{vt({element:t,instances:pt}),vt({element:t,instances:ut});const o={element:t,transition:n,onCancel:r,resolve:a};e.push(o),i&&(i.cancel=()=>{if(!o)return;const{element:t,resolve:n,transition:r,onCancel:a}=o;ft({element:t,instances:e}),t.removeEventListener("transitionend",r),a&&a(t),n(!0),i.cancel=()=>{}})},vt=({element:e,instances:t})=>{const n=ft({element:e,instances:t});if(n){const{element:e,transition:t,onCancel:r,resolve:i}=n;e.removeEventListener("transitionend",t),r&&r(e),i(!0)}},ft=({element:e,instances:t})=>{let n=0;const r=t.find(((t,r)=>{if(t.element===e)return n=r,!0}));return r?(t.splice(n,1),r):null},bt=e=>new Promise((t=>{setTimeout((()=>t(!0)),e)})),kt=e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,wt="ArrowDown",Et="ArrowUp",St="ArrowLeft",Pt="ArrowRight",Ct=[wt,St,Pt,Et," "],xt=({group:e,radioSelector:t="[tabindex]",activeSelector:n='[tabindex="0"]',onSelect:r,onClickDisabled:i})=>{const a=Tt(e),o=Array.from(a.querySelectorAll(t));a.addEventListener("click",(e=>{const o=e.target.closest(t);if(!o)return;if("true"===o.getAttribute("aria-disabled"))return void(i&&i(o));const s=a.querySelector(n);s.setAttribute("tabindex","-1"),s.setAttribute("aria-checked","false"),o.setAttribute("tabindex","0"),o.setAttribute("aria-checked","true"),o.focus(),r&&r({prevElement:s,currentElement:o})})),a.addEventListener("keydown",(e=>{if(!Ct.includes(e.key))return;const t=a.querySelector(n);if("true"!==t.getAttribute("aria-disabled"))switch(e.key){case St:case Et:s({direction:"backwards",activeElement:t});break;case wt:case Pt:s({direction:"forwards",activeElement:t})}}));const s=({activeElement:e,direction:t})=>{const n=o.findIndex((t=>t===e)),r=o.length-1;let i=n;if("forwards"!==t)if("backwards"!==t);else{n<=0?i=r:i--;for(let t=i;t>=0;t--){if("true"!==o[t].getAttribute("aria-disabled"))return void l({nextIdx:t,activeElement:e});0===t&&(t=r+1)}}else{n>=r?i=0:i++;for(let t=i;t<o.length;t++){if("true"!==o[t].getAttribute("aria-disabled"))return void l({nextIdx:t,activeElement:e});t===r&&(t=-1)}}},l=({activeElement:e,nextIdx:t})=>{let n=o[t];e.setAttribute("tabindex","-1"),e.setAttribute("aria-checked","false"),n.setAttribute("tabindex","0"),n.setAttribute("aria-checked","true"),n.focus(),r&&r({prevElement:e,currentElement:n})}},Tt=e=>"string"!=typeof e?e:"#"===e[0]?document.getElementById(e):document.querySelector(e);var Mt=new class{constructor(){this.mediaHandlers={"(prefers-color-scheme: light)":[],"(prefers-reduced-motion: reduce)":[]},this.mqls={},this.runQueries()}runQueries(){["(prefers-reduced-motion: reduce)","(prefers-color-scheme: light)"].forEach((e=>{const t=window.matchMedia(e);this.mqls[e]=t;const n=this.mediaHandlers[e];try{t.addEventListener("change",(e=>{n.forEach((t=>t(e)))}))}catch(e){try{t.addListener((e=>{n.forEach((t=>t(e)))}))}catch(e){console.error(e)}}}))}updateHTMLRoot({matches:e,media:t}){"(prefers-reduced-motion: reduce)"===t&&(e?document.documentElement.setAttribute("data-prefers-reduced-motion","true"):document.documentElement.setAttribute("data-prefers-reduced-motion","false"))}fire({media:e,matches:t}){this.updateHTMLRoot({matches:t,media:e}),this.mediaHandlers[e].forEach((n=>n({media:e,matches:t})))}subscribe({handler:e,media:t}){const n=this.mqls[t];e({matches:n.matches,media:n.media}),this.mediaHandlers[t].push(e)}};class At{constructor({id:e,maskEl:t,innerEl:n}){this.animationInterruptedId=1,this.animationMode="css",this.webAPIAnimationReverseMode="reverse",this.maskEl={},this.innerEl={},this.expandMaskKeyframes=[],this.expandInnerKeyframes=[],this.collapseMaskKeyframes=[],this.collapseInnerKeyframes=[],this.expandMaskInterruptedKeyframes=[],this.expandInnerInterruptedKeyframes=[],this.collapseMaskInterruptedKeyframes=[],this.collapseInnerInterruptedKeyframes=[],this.duration=600,this.interruptedDuration=0,this.maskAnimation=null,this.innerAnimation=null,this.animationPlayState={running:!1,collapse:{interrupted:!1,running:!1},expand:{interrupted:!1,running:!1}},this.onEnd=()=>{},this.styleSheetInit=!1,this.styleSheetName="dropdown-expando-animation",this.styleSheetNameInterrupted=`${this.styleSheetName}-interrupted`,this.collapsedMaskWidth=0,this.collapsedMaskHeight=0,this.expandedScale=0,this.expanded=!1,this.finishedDropdown=e=>{if("css"===this.animationMode&&e){const t=e.target;if(t!==this.maskEl&&t!==this.innerEl)return}this.onEnd&&this.onEnd(this.animationPlayState),this.animationPlayState.expand?this.expanded=!0:this.expanded=!1,this.animationPlayState={running:!1,collapse:{interrupted:!1,running:!1},expand:{interrupted:!1,running:!1}},"css"===this.animationMode&&this.maskEl.removeEventListener("animationend",this.finishedDropdown)},this.id=e,this.styleSheetNameInterrupted+=`-${e}`,this.maskEl=t,this.innerEl=n,this.animationMode="css",this.webAPIAnimationReverseMode="reverse"}calculate({updateStylesheet:e=!0}={}){const t=this.innerEl.getBoundingClientRect(),n=this.maskEl.getBoundingClientRect(),r=t.width,i=t.height,a=n.width,o=n.height;this.collapsedMaskWidth=n.width,this.collapsedMaskHeight=n.height;const s=.5*a,l=(Math.sqrt(r*r+i*i)-s)/s;this.expandedScale=l,this.maskEl.style.transformOrigin=`${a/2}px ${o/2}px`,this.innerEl.style.transformOrigin=`${a/2}px ${o/2}px`;for(let e=0;e<=100;e++){const t=kt(e/100),n=e/100;this.appendKeyFrames({step:t,offset:n,start:1,end:l,innerAnimation:this.expandInnerKeyframes,outerAnimation:this.expandMaskKeyframes}),this.appendKeyFrames({step:t,offset:n,start:l,end:1,innerAnimation:this.collapseInnerKeyframes,outerAnimation:this.collapseMaskKeyframes})}this.updateId(1),"css"===this.animationMode&&e&&this.addKeyframesToStyleSheet(),this.removeForwardFillOnFinishedExpanded()}play({mode:e,duration:t,onEnd:n,onStart:r}){this.duration=null!=t?t:this.duration,this.animationPlayState[e].running||this.animationPlayState[e].interrupted||(this.pauseAnimation(),r&&r(),this.onEnd=n,"webAPI"!==this.animationMode?"css"!==this.animationMode||this.playCSSAnimation({mode:e}):this.playWebAPIAnimation({mode:e}))}WAAnimationCollapse(){this.animationPlayState.collapse.running=!0,this.maskAnimation=this.maskEl.animate(this.collapseMaskKeyframes,{fill:"forwards",easing:"linear",duration:this.duration}),this.innerAnimation=this.innerEl.animate(this.collapseInnerKeyframes,{fill:"forwards",easing:"linear",duration:this.duration}),this.maskAnimation.onfinish=()=>{this.finishedDropdown()}}WAAnimationExpand(){this.animationPlayState.expand.running=!0,this.maskAnimation=this.maskEl.animate(this.expandMaskKeyframes,{fill:"forwards",easing:"linear",duration:this.duration}),this.innerAnimation=this.innerEl.animate(this.expandInnerKeyframes,{fill:"forwards",easing:"linear",duration:this.duration}),this.maskAnimation.onfinish=()=>{this.finishedDropdown()}}playWebAPIAnimation({mode:e,onStart:t}){"collapse"!==e?"expand"!==e||this.WAAnimationExpand():this.WAAnimationCollapse()}updatePlayState(e,{interrupted:t,running:n}){const r="collapse"===e?"expand":"collapse";this.animationPlayState[e].interrupted=t,this.animationPlayState[e].running=t,this.animationPlayState[r].interrupted=!1,this.animationPlayState[r].running=!1}playCSSAnimation({mode:e,onStart:t}){let n="expand"===e?"ExpandMaskAnimation-1":"CollapseMaskAnimation-1",r="expand"===e?"ExpandInnerAnimation-1":"CollapseInnerAnimation-1",i=this.duration;this.animationPlayState.running&&(n="expand"===e?`InterruptedExpandMaskAnimation-${this.id}-${this.animationInterruptedId}`:`InterruptedCollapseMaskAnimation-${this.id}-${this.animationInterruptedId}`,r="expand"===e?`InterruptedExpandInnerAnimation-${this.id}-${this.animationInterruptedId}`:`InterruptedCollapseInnerAnimation-${this.id}-${this.animationInterruptedId}`,this.useInterruptedKeyframes({mode:e}),i=this.interruptedDuration,this.updatePlayState(e,{running:!1,interrupted:!0})),this.updatePlayState(e,{running:!0,interrupted:!1}),this.maskEl.style.overflow="",this.maskEl.style.animation=`${n} ${i}ms linear forwards`,this.innerEl.style.animation=`${r} ${i}ms linear forwards`,this.maskEl.style.animationPlayState="running",this.innerEl.style.animationPlayState="running",this.maskEl.addEventListener("animationend",this.finishedDropdown),this.animationPlayState.running=!0}pauseAnimation(){var e,t;this.animationPlayState.running&&("css"===this.animationMode&&(this.maskEl.style.animationPlayState="paused",this.innerEl.style.animationPlayState="paused",this.maskEl.removeEventListener("animationend",this.finishedDropdown)),"webAPI"===this.animationMode&&(null===(e=this.maskAnimation)||void 0===e||e.pause(),null===(t=this.innerAnimation)||void 0===t||t.pause()))}useInterruptedKeyframes({mode:e}){const t="collapse"===e?this.collapseMaskInterruptedKeyframes:this.expandMaskInterruptedKeyframes,n="collapse"===e?this.collapseInnerInterruptedKeyframes:this.expandInnerInterruptedKeyframes,r="collapse"===e?"InterruptedCollapseMaskAnimation":"InterruptedExpandMaskAnimation",i="collapse"===e?"InterruptedCollapseInnerAnimation":"InterruptedExpandInnerAnimation",a=this.maskEl.getBoundingClientRect().width/this.collapsedMaskWidth;this.interruptedDuration=this.duration*(a/this.expandedScale),"expand"===e&&(this.interruptedDuration=this.duration-this.interruptedDuration);const o=a,s="collapse"===e?1:this.expandedScale;for(let e=0;e<=100;e++){const r=kt(e/100),i=e/100;this.appendKeyFrames({step:r,offset:i,start:o,end:s,innerAnimation:n,outerAnimation:t})}document.getElementById(this.styleSheetNameInterrupted).textContent=`\n    @keyframes ${r}-${this.id}-${this.animationInterruptedId} {\n      ${this.keyframesToString(t)}\n    }\n    @keyframes ${i}-${this.id}-${this.animationInterruptedId} {\n      ${this.keyframesToString(n)}\n    }\n    `,this.updateAnimationInteruptedId(),this.collapseMaskInterruptedKeyframes=[],this.collapseInnerInterruptedKeyframes=[],this.expandMaskInterruptedKeyframes=[],this.expandInnerInterruptedKeyframes=[]}keyframesToString(e){return e.map((({offset:e,transform:t})=>`\n          ${e=Math.round(100*e)}% {\n            transform: ${t}\n          }\n        `)).join("")}addKeyframesToStyleSheet(){document.getElementById("dropdown-expando-animation").textContent=`\n        @keyframes ExpandMaskAnimation-1 {\n          ${this.keyframesToString(this.expandMaskKeyframes)}\n        }\n\n        @keyframes ExpandInnerAnimation-1 {\n          ${this.keyframesToString(this.expandInnerKeyframes)}\n        }\n\n        @keyframes CollapseMaskAnimation-1 {\n          ${this.keyframesToString(this.collapseMaskKeyframes)}\n        }\n\n        @keyframes CollapseInnerAnimation-1 {\n          ${this.keyframesToString(this.collapseInnerKeyframes)}\n        }\n      `}appendKeyFrames({offset:e,step:t,start:n,end:r,outerAnimation:i,innerAnimation:a}){const o=n+(r-n)*t,s=1/o;i.push({transform:`scale(${o})`,offset:e}),a.push({transform:`scale(${s})`,offset:e})}removeForwardFillOnFinishedExpanded(){this.expanded&&(this.maskEl.style.overflow="visible",this.maskEl.style.animation="none",this.innerEl.style.animation="none")}updateId(e){return(e+1)%5}updateAnimationInteruptedId(){this.animationInterruptedId=(this.animationInterruptedId+1)%5}}class Bt extends nt{constructor({root:e,data:t}){super({root:e}),this.reducedAnimation=!1,this.dropdownTimeout=0,this.maskEl={},this.innerEl={},this.shellEl={},this.shellShadowEl={},this.dropdownOptionsEl={},this.playerBtnHighlightEl={},this.playerBtnGroupEl={},this.dropdownBtnEl={},this.shapeGroupEl={},this.colorGroupEl={},this.handlerShape=()=>{},this.handlerColor=()=>{},this.onRemoveActiveBtn=()=>{},this.dropdownExpando={},this.skinGroups={},this.playAgainst="vsHuman",this.radioToolTipMessage=({type:e})=>{const{currentPlayer:{id:t},players:n}=this.data,r=$e({id:t,players:n}),i=`<span class="mini-svg-mark" aria-hidden="true">${r.getSvgShape()}</span>`;let a=`Player ${r.id.replace("P","")} ${i}`,o="has";return"multiplayer"===this.playAgainst&&(a=`Opponent ${i}`),"vsAi"===this.playAgainst&&(a=`${"P2"===t?"You":"Computer"} ${i}`,o="P2"===t?"have":"has"),`\n    <span>\n      <span class="tooltip-player">\n        ${a}\n      </span>\n      ${o} this <strong>${e}</strong>\n    </span>`},this.data=t,this.initSkinGroups(),Mt.subscribe({media:"(prefers-reduced-motion: reduce)",handler:({matches:e})=>{this.reducedAnimation=e}})}markupDidGenerate(){const{currentPlayer:{id:e}}=this.data;this.dropdownOptionsEl=this.parentEl.querySelector(".dropdown-options"),this.playerBtnHighlightEl=this.parentEl.querySelector(`[data-player-id="${e}"]`),this.dropdownBtnEl=this.parentEl.querySelector(".dropdown-btn"),this.colorGroupEl=this.parentEl.querySelector(".color-group"),this.shapeGroupEl=this.parentEl.querySelector(".shape-group"),this.playerBtnGroupEl=this.parentEl.querySelector(".player-btn-group"),this.maskEl=this.parentEl.querySelector(".dropdown-options-mask"),this.innerEl=this.parentEl.querySelector(".dropdown-options-inner"),this.shellEl=this.parentEl.querySelector(".dropdown-options-shell"),this.shellShadowEl=this.parentEl.querySelector(".shell-shadow"),this.dropdownExpando=new At({id:e,innerEl:this.innerEl,maskEl:this.maskEl}),this.onRadioGroup(),this.parentEl.querySelectorAll('[data-disabled="true"]').forEach((e=>{this.prepareTooltip({disabledItemEl:e})}))}prepareTooltip({disabledItemEl:e}){const t=e.dataset.type,n=t+"s",r=e.dataset[t],i=this.skinGroups[n].find((e=>e.item===r)),a=this.radioToolTipMessage({type:t});i.toolTip||(i.toolTip=new Oe({message:a,tooltipTargetEl:e}))}initSkinGroups(){const{currentPlayer:e,players:t}=this.data,{color:n,shape:r}=e,i=$e({id:e.id,players:t});this.skinGroups.colors=qe.map((e=>{const[t,r]=e.split(","),a=`choose gradient color of shape. Primary Color ${t}, Secondary Color ${r}`,o=i.color===e;return{item:e,disabled:o,drafted:!1,selected:n===e,ariaLabel:a,toolTip:null,toolTipActive:o}})),this.skinGroups.shapes=Fe.map((e=>{const t=`choose shape: ${e}`,n=i.shape===e;return{item:e,disabled:n,drafted:!1,selected:r===e,ariaLabel:t,toolTip:null,toolTipActive:n}}))}generateBtnHighlight(){const{currentPlayer:{id:e}}=this.data;return`\n      <div class="fake-player-btn ${e}-player-btn-highlight"></div>\n    `}renderGroup({type:e}){const t=e+"s";return this.skinGroups[t].map((t=>this.listItem(e,t))).join("")}listItem(e,t){const{currentPlayer:n}=this.data,{svgShapes:r}=n,{ariaLabel:i,disabled:a,drafted:o,item:s,selected:l}=t;let d="";const c=l?"0":"-1",p=l?"true":"false",u=`${e}-item`,h=`${u} ${l?`${e}-item--selected`:""} ${a?"disabled":""}`,y=`${u}-inner`,m=`${u}-bg`;if("shape"===e&&(d=`\n      <div class="${y}">\n        ${r[s].replace(/filter="url\(#drop-shadow-filter\)"/g,"")}\n      </div>\n      `),"color"===e){const[e,t]=_e[s];d=`\n      <div class="${y}"  style="background: linear-gradient(0deg, ${t}, ${e});"></div>\n      `}return`\n      <div class="${u}-container">\n        <div \n          role="radio" \n          tabindex="${c}" \n          class="${h}" \n          data-type="${e}"\n          data-${e}="${s}" \n          data-value="${s}" \n          data-selected="${p}"\n          data-disabled="${a}"\n          aria-checked="${l}" \n          aria-disabled="${a}"\n          aria-hidden="${a}"\n          aria-label="${i}"\n        >\n          <div class="${m}">\n            <div class="radio">\n              ${Xe}\n            </div>\n\n            ${d}\n          </div>\n        </div>\n      </div>\n      `}dropdownContentMarkup(){const{currentPlayer:{id:e}}=this.data;return`\n    <ul class="dropdown-options ${e}-options">\n      <li>\n        <div class="options-shape">\n          <h2 id="group_label_shape_${e}" class="options-title">Shape</h2>\n          <hr aria-hidden="true">\n          <div role="radiogroup" aria-labelledby="group_label_shape_${e}" class="shape-group">${this.renderGroup({type:"shape"})}</div>\n        </div>\n      </li>\n      <li>\n      <div class="options-color">\n        <h2 id="group_label_color_${e}" class="options-title">Color</h2>\n        <hr aria-hidden="true">\n        <div role="radiogroup" aria-labelledby="group_label_color_${e}" class="color-group">${this.renderGroup({type:"color"})}</div>\n      </div>\n      </li>\n    </ul>\n    `}generateMarkup(){const{currentPlayer:{id:e}}=this.data;return`\n    <div class="dropdown-options-shell" >\n      <div class="dropdown-options-sub-shell" >\n        <div class="dropdown-options-mask" >\n          <div class="dropdown-options-inner" >\n            \x3c!-- btn highlight for player --\x3e \n            ${this.generateBtnHighlight()}\n\n            ${this.dropdownContentMarkup()}\n          </div>\n        </div>\n      </div>\n      <div class="shell-shadow ${e}"></div>\n    </div>\n    `}onRadioGroup(){const{currentPlayer:e}=this.data;xt({group:this.shapeGroupEl,onSelect:({currentElement:t,prevElement:n})=>{const r=t.dataset.shape,i=n.dataset.shape;n.setAttribute("data-selected","false"),n.classList.remove("shape-item--selected"),t.setAttribute("data-selected","true"),t.classList.add("shape-item--selected"),this.handlerShape({player:e,shape:r,prevShape:i})}}),xt({group:this.colorGroupEl,onSelect:({currentElement:t,prevElement:n})=>{const r=t.dataset.color,i=n.dataset.color;n.setAttribute("data-selected","false"),n.classList.remove("color-item--selected"),t.setAttribute("data-selected","true"),t.classList.add("color-item--selected"),this.handlerColor({player:e,color:r,prevColor:i})}})}updatePlayerSkinSelection({type:e,value:t}){const n="color"===e?this.colorGroupEl:this.shapeGroupEl,r=n.querySelector('[data-selected="true"]'),i=n.querySelector(`[data-${e}="${t}"]`);r.setAttribute("data-selected","false"),r.setAttribute("aria-checked","false"),r.setAttribute("tabindex","-1"),r.classList.remove(`${e}-item--selected`),i.setAttribute("data-selected","true"),i.setAttribute("aria-checked","true"),i.setAttribute("tabindex","0"),i.classList.add(`${e}-item--selected`)}updateTooltipMessage(){["colors","shapes"].forEach((e=>{this.skinGroups[e].forEach((({toolTip:t})=>{t&&t.updateTooltip({message:this.radioToolTipMessage({type:"colors"===e?"color":"shape"})})}))}))}updatePlayerSkinDisabled({type:e,value:t}){const n="color"===e?"shape":"color",r=e+"s",i="colors"===r?"shapes":"colors",a="color"===e?this.colorGroupEl:this.shapeGroupEl,o="color"===e?this.shapeGroupEl:this.colorGroupEl,s=this.skinGroups[r],l=this.skinGroups[i],d=a.querySelector('[data-disabled="true"]'),c=o.querySelector('[data-disabled="true"]'),p=a.querySelector(`[data-${e}="${t}"]`),u=c.dataset.value;"shape"===e&&l.find((e=>{const{toolTip:t}=e;if(e.item===u)return t&&(t.disabled&&t.enable(),t.updateTooltip({message:this.radioToolTipMessage({type:n})})),!0})),s.forEach((n=>{const{toolTip:r}=n;if(n.disabled&&(n.disabled=!1,r&&r.disable()),n.item===t){if(n.disabled=!0,r)return r.enable(),void r.updateTooltip({message:this.radioToolTipMessage({type:e})});n.toolTip=new Oe({tooltipTargetEl:p,message:this.radioToolTipMessage({type:e})})}})),d.setAttribute("data-disabled","false"),d.setAttribute("aria-disabled","false"),d.classList.remove("disabled"),p.setAttribute("data-disabled","true"),p.setAttribute("aria-disabled","true"),p.classList.add("disabled")}setPlayAgainst({type:e}){this.playAgainst=e}addHandlerChangeShape(e){this.handlerShape=e}addHandlerChangeColor(e){this.handlerColor=e}recalculateDropdownAnimation(){const{currentPlayer:{id:e}}=this.data;this.parentEl.style.display="block",this.reflow(),"P1"===e?this.dropdownExpando.calculate():this.dropdownExpando.calculate({updateStylesheet:!1}),this.parentEl.style.display=""}removeForwardFillOnFinishedExpanded(){this.dropdownExpando.removeForwardFillOnFinishedExpanded()}collapseDropdown(e){let t=600;this.reducedAnimation&&(t=0),this.dropdownExpando.play({mode:"collapse",duration:t,onStart:()=>{this.shellShadowEl.style.transition="",this.shellShadowEl.style.opacity=""},onEnd:()=>{e(),this.parentEl.classList.remove("active")}})}expandDropdown(){let e=600;this.reducedAnimation&&(e=0),this.dropdownExpando.play({mode:"expand",duration:e,onStart:()=>{this.parentEl.classList.add("active")},onEnd:()=>{this.shellShadowEl.style.opacity="1",this.shellShadowEl.style.transition="opacity 400ms"}})}}var $t=new class extends nt{constructor(){super({root:".player-btn-group"}),this.data={},this.playerOptions=document.querySelectorAll(".player-options"),this.playerDom={}}disableBtn(e){const{playerBtn:t}=this.playerDom[e];t.setAttribute("disabled","true")}enableBtn(e){const{playerBtn:t}=this.playerDom[e];t.removeAttribute("disabled")}enableBtns(){const{players:e}=this.data;e.forEach((e=>{this.enableBtn(e.id)}))}disableBtns(){const{players:e}=this.data;e.forEach((e=>{this.disableBtn(e.id)}))}_hideInnerBtn({playerId:e,selectors:t}){t.forEach((t=>{const n=this.playerDom[e][t];yt({el:n,onStart:e=>{e.style.opacity="1",e.style.transform="scale(1)",e.style.transition="500ms transform, 250ms 250ms opacity",this.reflow(),e.style.opacity="0",e.style.transform="scale(0)"}})}))}_showInnerBtn({playerId:e,selectors:t}){t.forEach((t=>{const n=this.playerDom[e][t];mt({el:n,onStart:e=>{e.style.transition="500ms transform, 250ms 250ms opacity",this.reflow(),e.style.opacity="1",e.style.transform="scale(1)"},onEnd:e=>{e.style.opacity="",e.style.transform="",e.style.transition=""}})}))}generatePlayerMark({id:e,svgMark:t}){t=t.replace(/filter="url\(#drop-shadow-filter\)"/g,"");const{playerMark:n}=this.playerDom[e],r=Me(t),i=Me(t);i.classList.add("monochrome"),r.classList.add("full-color"),n.appendChild(r),n.appendChild(i)}generateAntMenu(){this.playerOptions.forEach((e=>e.innerHTML=Je))}addHandlers({handlerChangeColor:e,handlerChangeShape:t}){this.data.players.forEach((({id:n})=>{const{dropdownOptionsView:r}=this.playerDom[n];r.addHandlerChangeShape(t),r.addHandlerChangeColor(e)}))}addToggleDropDown(){this.parentEl.addEventListener("click",(e=>{const t=e.target.closest(".player-btn-options");if(!t)return;const{playerId:n}=t.dataset,{playerBtn:r,dropdownOptionsView:i,playerContainer:a}=this.playerDom[n];ke({button:r,allow:[".dropdown-options",".tooltip-shell"],run:()=>{this.activateBtnHoverState(n),i.expandDropdown(),r.setAttribute("aria-expanded","true")},onExit:()=>{i.collapseDropdown((()=>this.deactiveBtnHoverState(n))),r.setAttribute("aria-expanded","false")}})}))}recalculateDropdownAnimations(){const{players:e}=this.data;e.forEach((({id:e})=>{const{dropdownOptionsView:t}=this.playerDom[e];t.recalculateDropdownAnimation()}))}removeForwardFillOnFinishedExpandedDropdowns(){const{players:e}=this.data;e.forEach((({id:e})=>{const{dropdownOptionsView:t}=this.playerDom[e];t.recalculateDropdownAnimation()}))}resetPlayerIndicators(){const{players:e}=this.data;e.forEach((({id:e})=>{const{playerCurrentIndicator:t}=this.playerDom[e];t.style.background="var(--blue-shadow)"}))}updatePlayerIndicator(e){const{playerCurrentIndicator:t}=this.playerDom[e.id],[n,r]=_e[e.color];this.resetPlayerIndicators(),t.style.background=`linear-gradient(90deg, ${n} 35%, ${r} 85%)`}updatePlayerScore(e){const{playerScore:t}=this.playerDom[e.id],n=e.score?e.score.toString():"-";t.textContent=n}updatePlayerBtnsOnGameStart(){const{players:e}=this.data;e.forEach((({id:e})=>{const{playerBtn:t}=this.playerDom[e];t.classList.remove("pre-game")}))}updatePlayerBtnsOnPreGame(){const{players:e}=this.data;e.forEach((({id:e})=>{const{playerBtn:t}=this.playerDom[e];t.classList.add("pre-game")}))}updateTooltipMessage(){const{players:e}=this.data;e.forEach((({id:e})=>{const{dropdownOptionsView:t}=this.playerDom[e];t.updateTooltipMessage()}))}updateSkinSelectionInDropdown({player:e,type:t}){const{dropdownOptionsView:n}=this.playerDom[e.id];Array.isArray(t)?t.forEach((t=>{n.updatePlayerSkinSelection({type:t,value:e[t]})})):n.updatePlayerSkinSelection({type:t,value:e[t]})}updateSkinDisabledInDropdown({id:e,oppositePlayer:t,type:n}){const{dropdownOptionsView:r}=this.playerDom[e];Array.isArray(n)?n.forEach((e=>{r.updatePlayerSkinDisabled({type:e,value:t[e]})})):r.updatePlayerSkinDisabled({type:n,value:t[n]})}updatePlayAgainst({type:e}){const{players:t}=this.data;t.forEach((t=>{const{dropdownOptionsView:n}=this.playerDom[t.id];n.setPlayAgainst({type:e})}))}render(e){this.data=e;const{players:t}=e;t.forEach((e=>{const{id:n,shape:r,svgShapes:i}=e,a=i[r],o=document.getElementById(`${n}-btn-options`),s=o.querySelector(".player-btn-options"),l=o.querySelector(".player-mark"),d=o.querySelector(".player-score"),c=o.querySelector(".player-options"),p=o.querySelector(".player-current-indicator"),u=o.querySelector(".dropdown-options-container"),h=o.querySelector(".dropdown-options-menu"),y=new Bt({root:u,data:{players:t,currentPlayer:e}});this.playerDom[n]={playerOptionsIcon:c,playerContainer:o,playerMark:l,playerScore:d,playerCurrentIndicator:p,dropdownOptionsView:y,dropdownOptionsMenu:h,playerBtn:s},y.render({players:t,currentPlayer:e}),this.generatePlayerMark({id:n,svgMark:a}),this.updatePlayerScore(e)})),this.generateAntMenu(),this.addToggleDropDown()}updateSvgMark(e){const{shape:t,svgShapes:n,id:r}=e,{playerMark:i}=this.playerDom[r],a=e.getSvgShape().replace(/filter="url\(#drop-shadow-filter\)"/g,"");this.clearChildren(i),this.generatePlayerMark({id:r,svgMark:a})}showInnerBtn({playerId:e,selectors:t}){if(e)return void this._showInnerBtn({playerId:e,selectors:t});const{players:n}=this.data;n.forEach((e=>{this._showInnerBtn({playerId:e.id,selectors:t})}))}hideInnerBtn({playerId:e,selectors:t}){if(e)return void this._hideInnerBtn({playerId:e,selectors:t});const{players:n}=this.data;n.forEach((e=>{this._hideInnerBtn({playerId:e.id,selectors:t})}))}activateColorShape(e){const{playerBtn:t}=this.playerDom[e];t.classList.add("active-color-shape")}deactivateColorShape(e){const{playerBtn:t}=this.playerDom[e];t.classList.remove("active-color-shape")}activateBtnHoverState(e){const{playerBtn:t}=this.playerDom[e];t.classList.add("active")}deactiveBtnHoverState(e){const{playerBtn:t}=this.playerDom[e];t.classList.remove("active")}};const It=(e,t=1)=>`${v(e,t)}px`,Lt=({name:e,numerator:t,precisionDecimal:n,styleRatio:r})=>{if(!e.present)return;const{el:i}=e;if(i&&(!Array.isArray(i)||i.length))for(const e in r){const a=r[e];let o=0,s=null==n?1:n;if(null!=a&&"object"==typeof a&&(o=a.ratio,s=a.decimalPlaces),"number"==typeof a&&(o=a),Array.isArray(i)){i.forEach((n=>{n.style[e]="function"!=typeof a?It(t/o,s):a(n)}));continue}const l=i;l.style[e]="function"!=typeof a?It(t/o,s):a(l)}},Dt={playerBtnGroup:{selector:".player-btn-group",present:!0},playerBtns:{selector:".player-btn-options",present:!0,queryAll:!0},fakePlayerBtns:{selector:".fake-player-btn",present:!0,queryAll:!0},playerDropdowns:{selector:".dropdown-options",present:!0,queryAll:!0},playerDropdownOptionsContainers:{selector:".dropdown-options-container",present:!0,queryAll:!0},playerDropdownInners:{selector:".dropdown-options-inner",present:!0,queryAll:!0},playerDropdownShells:{selector:".dropdown-options-shell",present:!0,queryAll:!0},playerDropdownShellShadows:{selector:".dropdown-options-shell .shell-shadow",present:!0,queryAll:!0},playerDropdownMasks:{selector:".dropdown-options-mask",present:!0,queryAll:!0},playerIndicators:{selector:".player-current-indicator",present:!0,queryAll:!0},board:{selector:".board",present:!0},rows:{selector:".row",present:!0,parent:"board",queryAll:!0},cells:{selector:".cell",present:!0,parent:"board",queryAll:!0},boardBackground:{selector:".board-background",present:!0,parent:"gameMenu"},gameMenu:{selector:"#game-menu",present:!0},gameMenuTitle:{selector:".menu-title",present:!0,parent:"gameMenu"},gameMenuBtns:{selector:".btn-pick, .btn-leave",present:!0,parent:"gameMenu",queryAll:!0},gameMenuBtnPickPlayer:{selector:".btn-pick-player",present:!1,parent:"gameMenu",queryAll:!0},gameOverPlayerShape:{selector:".game-over-title .player-shape",present:!1,parent:"gameMenu"},gameOverPlayerResult:{selector:".game-over-title .player-result",present:!1,parent:"gameMenu"},navigationBackBtn:{selector:".btn-navigation-back",present:!0,parent:"gameMenu"},settings:{selector:"#settings",present:!0},settingsBtn:{selector:".settings-btn",present:!0,parent:"settings"},pickSkin:{selector:".pick-skin",present:!1},pickSkinBtnsGroup:{selector:".btns-group",present:!1,parent:"pickSkin"},pickSkinTitle:{selector:".title",present:!1,parent:"pickSkin"},pickSkinItems:{selector:".color-item, .shape-item",present:!1,queryAll:!0,parent:"pickSkin"},declarePlayersShape:{selector:".lobby .player-shape",present:!1},declarePlayersDeclaration:{selector:".lobby .declaration",present:!1},playerPickSkinCountDown:{selector:".player-pick-skin-countdown",present:!1},slideDeclarePlayersStylesheet:{selector:"slide-declare-players-animation",present:!1,getById:!0},lobbyTitle:{selector:".lobby-title",present:!1},roomCard:{selector:".room-card",present:!1},codeTitle:{selector:".code-title",parent:"roomCard",present:!1},codeContent:{selector:".code-content",parent:"roomCard",present:!1},onlineCircle:{selector:".online-circle",present:!1},onlineCircleCircle:{selector:".circle",parent:"onlineCircle",present:!1},onlineCirclePulse:{selector:".pulse",parent:"onlineCircle",present:!1},btnCopyLink:{selector:".btn-copy-link",present:!1}},Rt=(e,t=1)=>`${v(e,t)}px`;var Gt=new class extends nt{constructor(){super({root:".game-container"}),this.dom=Dt,this.debouncedGetSelectors=()=>{},this.debouncedResizeAnimation=()=>{},this.animationId=0,this.declarePlayersAnimationRunning=!1,this.playerDropdownContentHeight=0,this.init()}init(){this.debouncedGetSelectors=Ae(this.getSelectors.bind(this),{time:500,leading:!0}),this.debouncedResizeAnimation=Ae(this.resizeAnimation.bind(this),{time:200,leading:!1})}getSelectors({all:e,pick:t}){const{dom:n}=this,r=e=>{if(!e.present)return;let t=this.parentEl;if(e.parent){const r=n[e.parent].el;if(!r)return;t=r}e.getById?e.el=document.getElementById(e.selector):e.queryAll?e.el=Array.from(t.querySelectorAll(e.selector)):e.el=t.querySelector(e.selector)};e?(()=>{for(const e in n){const t=n[e];r(t)}})():t&&(()=>{for(const e of t){const t=n[e];t.present=!0,r(t)}})()}resizeElements(e,{all:t}){t&&this.debouncedGetSelectors({all:!0});const{board:n,rows:r,cells:i,settings:a,settingsBtn:o,playerBtnGroup:s,playerIndicators:l,playerBtns:d,playerDropdowns:c,playerDropdownOptionsContainers:p,playerDropdownShells:u,playerDropdownShellShadows:h,playerDropdownInners:y,playerDropdownMasks:m,fakePlayerBtns:g,gameMenu:v,gameMenuTitle:f,gameMenuBtns:b,gameMenuBtnPickPlayer:k,navigationBackBtn:w,boardBackground:E,lobbyTitle:S,pickSkin:P,pickSkinBtnsGroup:C,pickSkinItems:x,pickSkinTitle:T,slideDeclarePlayersStylesheet:M,declarePlayersDeclaration:A,declarePlayersShape:B,playerPickSkinCountDown:$,gameOverPlayerResult:I,gameOverPlayerShape:L,roomCard:D,codeTitle:R,codeContent:G,onlineCircle:O,onlineCircleCircle:q,onlineCirclePulse:_,btnCopyLink:F}=this.dom;(e=>{if(e>1600&&(e*=.7),e>700&&(e*=.8),Lt({name:n,numerator:e,styleRatio:{gap:{ratio:46.25,decimalPlaces:0},borderRadius:12.33,boxShadow:()=>`0px ${Rt(e/18.8)} 0px var(--board-shadow)`}}),Lt({name:r,numerator:e,styleRatio:{gap:{ratio:46.25,decimalPlaces:0}}}),Lt({name:i,numerator:e,styleRatio:{borderRadius:37}}),Lt({name:s,numerator:e,styleRatio:{height:5.692,marginBottom:12.33}}),Lt({name:d,numerator:e,styleRatio:{padding:37,borderRadius:37,fontSize:16.5}}),Lt({name:l,numerator:e,styleRatio:{top:74,borderRadius:37,boxShadow:()=>`0px ${Rt(e/37)} 0px var(--blue-shadow)`}}),Lt({name:m,numerator:e,styleRatio:{top:8.06625,width:21.5827,height:21.5827}}),Lt({name:c,numerator:e,styleRatio:{borderRadius:12.33,borderTopLeftRadius:t=>t.classList.contains("P1-options")?"0":Rt(e/12.33),borderTopRightRadius:t=>t.classList.contains("P2-options")?"0":Rt(e/12.33),padding:12.33,top:18.758,boxShadow:t=>(t.classList.contains("P1-options"),`0px ${Rt(e/37)} 0px #bbb`)}}),Lt({name:h,numerator:e,styleRatio:{borderRadius:12.33,boxShadow:t=>t.classList.contains("P1")?`\n               ${Rt(e/113.6)} ${Rt(e/80.6625)} ${Rt(e/47.33)} rgba(0, 0, 0, 0.35)`:`\n               -${Rt(e/113.6)} ${Rt(e/80.6625)} ${Rt(e/47.33)} rgba(0, 0, 0, 0.35)`}}),Lt({name:g,numerator:e,styleRatio:{top:-10.5097,height:4.29,borderRadius:37,borderBottomRightRadius:e=>e.classList.contains("P1-player-btn-highlight")?"0":"",borderBottomLeftRadius:e=>e.classList.contains("P2-player-btn-highlight")?"0":""}}),Lt({name:o,numerator:e,styleRatio:{height:e>400?14.08:8.08,borderBottomLeftRadius:17.6,borderBottomRightRadius:17.6,padding:()=>e>400?`${Rt(e/70.4)} 0`:`${Rt(e/30.4)} 0`}}),Lt({name:a,numerator:e,styleRatio:{marginBottom:20.533}}),Lt({name:f,numerator:e,styleRatio:{fontSize:()=>e<250?"20px":e<320?"22px":e<420?"28px":"38px",margin:()=>e<250?"5px 0":e<320?"15px 0":e<420?"25px 0":"40px 0"}}),Lt({name:b,numerator:e,styleRatio:{paddingLeft:21,paddingRight:21,paddingTop:28,paddingBottom:28,maxWidth:()=>Rt(e>500?e/2.1538:e/1.5),borderRadius:42,fontSize:t=>Rt(e<250?15:e<320?18:22)}}),Lt({name:k,numerator:e,styleRatio:{paddingTop:()=>"0px",paddingBottom:()=>"0px",height:()=>Rt(e>500?e/10.082:e/5.5875)}}),Lt({name:w,numerator:e,styleRatio:{top:21.5,left:21.5,padding:64.53,height:8.06625,width:8.06625,borderRadius:64.53}}),Lt({name:v,numerator:e,styleRatio:{borderRadius:12.33}}),Lt({name:E,numerator:e,styleRatio:{top:52.85}}),Lt({name:I,numerator:e,styleRatio:{fontSize:12.906,marginBottom:()=>Rt(e<270?e/-54:e<434?e/17.0866:e/8.604),marginTop:()=>e<270?Rt(e/-54):""}}),Lt({name:L,numerator:e,styleRatio:{width:()=>Rt(e<434?e/4.265:e/3.2265),height:()=>Rt(e<434?e/4.265:e/3.2265)}}),Lt({name:S,numerator:e,styleRatio:{fontSize:()=>e<250?"16px":e<290?"18px":e<320?"20px":e<420?"28px":"38px",margin:()=>e<250?"5px 0":e<320?"15px 0":e<420?"25px 0":"40px 0"}}),Lt({name:D,numerator:e,styleRatio:{margin:()=>`${Rt(e/12.9059)} 0`}}),Lt({name:$,numerator:e,styleRatio:{top:21.5,right:21.5,height:8.06625,width:8.06625,fontSize:20.1612}}),Lt({name:B,numerator:e,styleRatio:{width:2.3465,height:2.3465}}),Lt({name:A,numerator:e,styleRatio:{margin:()=>e<500?`${Rt(e/18.333)} 0`:`${Rt(e/25.8119)} 0`,fontSize:()=>Rt(e<500?e/11:e/16.1325)}}),Lt({name:G,numerator:e,styleRatio:{padding:10.7549,fontSize:12.906,borderBottomLeftRadius:21.509,borderBottomRightRadius:21.509}}),Lt({name:R,numerator:e,styleRatio:{padding:32.265,fontSize:21.509,borderTopWidth:80.6625,borderRightWidth:80.6625,borderLeftWidth:80.6625,borderTopLeftRadius:21.509,borderTopRightRadius:21.509}}),Lt({name:O,numerator:e,styleRatio:{top:11.7327,right:7.5917}}),Lt({name:q,numerator:e,precisionDecimal:0,styleRatio:{width:20.1656,height:20.1656,boxShadow:()=>`0px 0px 0px ${Rt(e/161.325,0)} #15a415`}}),Lt({name:_,numerator:e,precisionDecimal:0,styleRatio:{width:20.1656,height:20.1656}}),Lt({name:F,numerator:e,styleRatio:{height:()=>e<465?"45px":"55px",width:()=>e<465?"160%":"",marginLeft:()=>e<465?"-30%":""}}),P.present&&e<=285&&(T.el.style.fontSize="22px",C.el.style.width="calc(100% + 30px)",C.el.style.marginLeft="-15px",x.el.forEach((e=>{e.style.width="45px",e.style.height="45px"}))),this.declarePlayersAnimationRunning){const t="DeclarePlayerDeclaration-"+ ++this.animationId,n=`\n              @keyframes ${t}  {\n                0% {\n                  opacity: 0;\n                  transform: translateX(${Rt(e/2)});\n                }\n                10% {\n                  opacity: 1;\n                  transform: translateX(${Rt(.025*e)});\n                }\n                90% {\n                  opacity: 1;\n                  transform: translateX(${Rt(-.025*e)});\n                }\n                100% {\n                  opacity: 0;\n                  transform: translateX(${Rt(-e/2)});\n                }\n              }\n              `;M.el.textContent=n,B.el.style.animation=`${t} 3000ms linear normal forwards`,A.el.style.animation=`${t} 3000ms linear reverse forwards`}})(e),t&&(c.el.forEach((t=>{t.style.width=Rt(e)})),u.el.forEach((t=>{t.style.width=Rt(e)})),(()=>{const t=d.el[0].clientWidth,n=Rt(e/37+t);g.el.forEach((e=>{e.style.width=n}))})(),(()=>{var t,n;null===(t=p.el)||void 0===t||t.forEach((e=>{e.style.display="block"})),this.reflow();const r=d.el[0].getBoundingClientRect().height,i=c.el[0].getBoundingClientRect().width,a=c.el[0].getBoundingClientRect().height,o=m.el[0].getBoundingClientRect().height,s=e/35.5,l=r+a+s;this.playerDropdownContentHeight=l,y.el.forEach((e=>{e.style.height=Rt(a+s+2*o),e.style.width=Rt(i)})),u.el.forEach((e=>{e.style.height=Rt(l)})),h.el.forEach((e=>{e.style.height=Rt(.95*a)})),null===(n=p.el)||void 0===n||n.forEach((e=>{e.style.display=""}))})())}resizeAnimation(){$t.recalculateDropdownAnimations()}scaleElementsToProportionToBoard({selectors:e,boardWidth:t}){const n=null==t?this.parentEl.clientWidth:t;this.getSelectors({pick:e}),this.resizeElements(n,{all:!1})}runResizeListener(){const e=this.parentEl,t=()=>{$t.removeForwardFillOnFinishedExpandedDropdowns();const t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,r=t-t/4.02493321460374;if(r<n){const t=r-v(r/8,0);e.style.maxWidth=Rt(t),this.resizeElements(t,{all:!0}),this.debouncedResizeAnimation()}if(r>n){const t=n-v(n/5,0);e.style.maxWidth=Rt(t),this.resizeElements(t,{all:!0}),this.debouncedResizeAnimation()}};t();const n=Ae(t,{leading:!1,time:200,throttle:200});window.addEventListener("resize",(()=>{n()}))}revealAfterPageLoad(){requestAnimationFrame((()=>{const{playerBtns:e}=this.dom;document.body.style.overflow="",this.parentEl.style.transition="",this.parentEl.style.opacity="",e.el.forEach((e=>{e.style.background="",e.style.transition="none"})),setTimeout((()=>{e.el.forEach((e=>{e.style.transition=""}))}),100)}))}render(){}},Ot={start:{title:"Play Against",section:"start",listBtns:[{content:"Computer",aria:{"aria-label":"Play against Computer"},dataAttributes:{focus:"true",transitionTo:"aiDifficulty"},classNames:["btn","btn-primary","btn-pick"]},{content:"Human",aria:{"aria-label":"Play against Human"},dataAttributes:{transitionTo:"multiplayer",vs:"human"},classNames:["btn","btn-primary","btn-pick"]}]},aiDifficulty:{titleId:"ai-difficulty",title:"Difficulty",section:"aiDifficulty",listBtns:[{content:"Medium",aria:{"aria-describedby":"ai-difficulty"},dataAttributes:{focus:"true",difficulty:"MEDIUM",transitionTo:"goFirst",vs:"ai"},classNames:["btn","btn-primary","btn-pick"]},{content:"Hard",aria:{"aria-describedby":"ai-difficulty"},dataAttributes:{difficulty:"HARD",transitionTo:"goFirst",vs:"ai"},classNames:["btn","btn-primary","btn-pick"]},{content:"Cheater",aria:{"aria-describedby":"ai-difficulty","aria-label":"Cheater: computer sometimes takes several cells per turn"},dataAttributes:{difficulty:"CHEATER",transitionTo:"goFirst",vs:"ai"},classNames:["btn","btn-primary","btn-pick"]}]},multiplayer:{title:"Multiplayer",section:"multiplayer",listBtns:[{content:"Same Device",aria:{"aria-label":"Same Device: Play against a Friend next to You"},dataAttributes:{transitionTo:"goFirst",focus:"true"},classNames:["btn","btn-primary","btn-pick"]},{content:"Online",aria:{"aria-label":"Online: Play against an online people or create private games to play with your friends"},dataAttributes:{open:"lobby"},classNames:["btn","btn-primary","btn-pick"]}]},multiplayerChoices:{title:"Lobby",section:"multiplayerChoices",listBtns:[{content:"Battle Random Player",dataAttributes:{open:"lobby",lobbyType:"enter-pre-game",joinBy:"public",focus:"true",firstItem:"true"},aria:{"aria-label":"Join Public Game. You'll be matched with a random opponent"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]},{content:"Join <span style='text-decoration: underline;'>Private</span>",dataAttributes:{open:"lobby",lobbyType:"join-private-game",joinBy:"private"},aria:{"aria-label":"join private game"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]},{content:"Create <span style='text-decoration: underline;'>Private</span>",dataAttributes:{open:"lobby",lobbyType:"create-private-game",joinBy:"created-private"},aria:{"aria-label":"create private game"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]}]},goFirst:{title:"Who Goes First?",section:"goFirst",listBtns:[{id:"P1",content:"",aria:{"aria-label":"You go First"},dataAttributes:{playerId:"P1",playAgainst:"ai",focus:"true",shape:"cross"},classNames:["btn","btn-primary","btn-pick","btn-pick-player"]},{id:"P2",content:"",aria:{"aria-label":"Computer goes First"},dataAttributes:{playerId:"P2",playAgainst:"ai",shape:"circle"},classNames:["btn","btn-primary","btn-pick","btn-pick-player"]}]},playAgain:{title:"",section:"playAgain",listBtns:[{id:"playAgain",content:"Rematch?",aria:{"aria-label":"Rematch? Play Again?"},dataAttributes:{playAgain:"true"},classNames:["btn","btn-primary","btn-pick"]},{content:"Leave",aria:{"aria-label":"Leave Game"},dataAttributes:{transitionTo:"start",exitMultiplayer:"true",focus:"true"},classNames:["btn","btn-primary","btn-leave"]}]}};const qt=({delay:e}={})=>{let t=e=>"";return null!=e&&(t=t=>`animation-delay: ${e+t}ms;`),`\n  <div class="loader-ellipsis-container">\n    <div class="dot-1" style="${t(0)}"></div>\n    <div class="dot-2" style="${t(100)}"></div>\n    <div class="dot-3" style="${t(200)}"></div>\n  </div>\n  `};const _t=e=>{const t=document.createElement("textarea");let n=!1;t.value=e,t.style.opacity="0",t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{n=document.execCommand("copy");const e=n?"successful":"unsuccessful";n||console.log("Copying text command was "+e)}catch(e){console.error("Oops, unable to copy",e)}return document.body.removeChild(t),n};var Ft=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Ht=new class extends nt{constructor(){super({root:"#game-menu .lobby"}),this.onCreateRoom=()=>{},this.copyLinkText="",this.copyLinkTimeout=0,this.onlineCircleTooltip=null,this.onlineCircleEl=null,this.navigationBackBtnForeign={},this.onClickLobby=e=>Ft(this,void 0,void 0,(function*(){var t,n,r,i,a;e.target.closest(".btn-copy-link")&&(clearTimeout(this.copyLinkTimeout),yield(t=this.copyLinkText,n=void 0,r=void 0,i=void 0,a=function*(){if(!navigator.clipboard)return _t(t);try{return yield navigator.clipboard.writeText(t),!0}catch(e){return _t(t)}},new(i||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,s)}l((a=a.apply(n,r||[])).next())}))),this.transitionCopyLinkContent("success"),this.copyLinkTimeout=window.setTimeout((()=>{this.transitionCopyLinkContent("default")}),2e3))})),this.transitionStages=({type:e})=>Ft(this,void 0,void 0,(function*(){yield yt({el:this.parentEl,onEnd:t=>{t.innerHTML=this.stageMarkup({type:e});const n="room-created"===e?["roomCard","lobbyTitle","codeTitle","codeContent","onlineCircle","onlineCircleCircle","onlineCirclePulse","btnCopyLink"]:["lobbyTitle"];Gt.scaleElementsToProportionToBoard({selectors:n})}}),yield mt({el:this.parentEl})})),this.transitionCopyLinkContent=e=>Ft(this,void 0,void 0,(function*(){const t=this.parentEl.querySelector(".fake-btn .fake-btn--inner");let n="";switch(e){case"success":n="<span>Copied!</span>";break;case"fail":n="<span>Failed</span>";default:n="<span>Copy Link</span>"}yield yt({el:t,onEnd:e=>{e.innerHTML=n}}),yield mt({el:t})})),this.data={}}markupDidGenerate(){var e,t;const n=null===(t=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement;this.navigationBackBtnForeign=n.querySelector(".btn-navigation-back");const r=()=>{this.removeOnlineCircle(),this.navigationBackBtnForeign.removeEventListener("click",r)};this.navigationBackBtnForeign.addEventListener("click",r),this.parentEl.addEventListener("click",this.onClickLobby),Gt.scaleElementsToProportionToBoard({selectors:["lobbyTitle"]}),console.log("created room"),this.onCreateRoom()}stageMarkup({type:e}){switch(e){case"generating-room":return this.generatingRoomMarkup();case"room-created":return this.roomCreatedMarkup()}return""}generatingRoomMarkup(){return`\n    <div class="section delayed-reveal">\n      <div class="lobby-title">Generating Private Room ${qt()}</div>\n    </div>\n`}roomCreatedMarkup(){return this.generateOnlineCircle(),`\n    <div class="room-section delayed-reveal">\n      <div class="lobby-title">Private Room</div>\n      ${this.roomCardMarkup()}\n      ${this.copyLinkBtnMarkup()}\n    </div>\n`}generateOnlineCircle(){var e,t,n;this.onlineCircleEl=Me(this.onlineCircleMarkup()),null===(n=null===(t=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n||n.appendChild(this.onlineCircleEl);const r=this.onlineCircleEl.querySelector(".circle");this.onlineCircleTooltip=new Oe({message:"Room is Online. <br/> Share code and wait here.",tooltipTargetEl:r})}removeOnlineCircle(){this.onlineCircleEl&&(this.onlineCircleEl.remove(),this.onlineCircleTooltip&&this.onlineCircleTooltip.destroy())}onlineCircleMarkup(){return'\n    <div class="online-circle delayed-reveal">\n      <div class="pulse"></div>\n      <div class="circle"></div>\n    </div>\n    '}roomCardMarkup(){let{roomCode:e}=this.data;return e=e||"AA2AA",`\n      <div class="room-card">\n        <div class="inner">\n          <div class="code-title">Code</div>\n          <div class="code-content" aria-label="Room code ${e.split("").join(" ")}">${e}</div>\n        </div>\n        <div class="shadow"></div>\n      </div>`}copyLinkBtnMarkup(){let{roomCode:e}=this.data;e=e||"AA2AA";const t=`${window.location.origin+window.location.pathname}?code=${e}`;return this.copyLinkText=t,`\n    <button class="btn btn-copy-link" aria-label="copy url link that includes room code ${e.split("").join(" ")}">\n      <div class="btn-copy-link--inner">\n        <div class="fake-bar">${t}</div>\n        <div class="fake-btn-shadow">\n          <div class="fake-corner"></div>\n        </div>\n        <div class="fake-btn">\n          <div class="fake-btn--inner">\n            <span>Copy Link</span>\n          </div>\n        </div>\n      </div>\n    </button>\n    `}generateMarkup(){return setTimeout((()=>{Gt.scaleElementsToProportionToBoard({selectors:["roomCard","lobbyTitle","codeTitle","codeContent","onlineCircle","onlineCircleCircle","onlineCirclePulse","btnCopyLink"]})}),20),this.stageMarkup({type:"generating-room"})}removeEventListeners(){this.parentEl&&this.parentEl.removeEventListener("click",this.onClickLobby)}addHandlers({handlerCreateRoom:e}){this.onCreateRoom=e}destroy(){this.removeEventListeners(),this.removeOnlineCircle(),super.destroy()}render(e){super.render(e)}setData(e){super.setData(e)}},jt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Nt=new class extends nt{constructor(){super({root:"#game-menu .lobby"}),this.onJoinRoom=()=>{},this.codeInputEl={},this.roomErrorEl={},this.formEl={},this.btnJoinContainer={},this.btnJoinEl={},this.locatingRoomEl={},this.roomErrorTimeout=0,this.onSubmit=e=>jt(this,void 0,void 0,(function*(){const{isLocating:t}=this.data;if(e.preventDefault(),e.stopPropagation(),t)return;const n=this.codeInputEl.value;this.validateForm(n)&&(this.data.isLocating=!0,this.displaySubmitArea({type:"locating-room-text"}),this.onJoinRoom({type:"private",password:n}),window.history.replaceState("","",location.origin+location.pathname))})),this.onKeydownCleanCodeInput=e=>{const t=this.codeInputEl.value,n=t.replace(/([^a-z0-9])|([a-z])/gi,((e,t,n)=>t?(this.displayRoomError("Alpha/Number characters only"),""):n?n.toUpperCase():e));let r=this.codeInputEl.selectionStart;r=t.length===n.length?r:r-1,this.codeInputEl.value=n,this.codeInputEl.selectionEnd=r},this.joinRoomMarkup=()=>`\n    <div class="room-section join-private-room">\n      <div class="lobby-title">Join Private Room</div>\n      ${this.roomErrorMarkup()}\n      <form aria-label="Enter Private Room by Room Code">\n      ${this.roomCodeInputMarkup()}\n        <div class="btn-join-container">\n          ${this.joinBtnMarkup()}\n          ${this.locatingRoomMarkup()}\n        </div>\n      </form>\n    </div>\n    `,this.data={isLocating:!1,roomCode:null}}markupDidGenerate(){var e,t;const{roomCode:n}=this.data;this.codeInputEl=this.parentEl.querySelector(".room-code-input"),this.roomErrorEl=this.parentEl.querySelector(".room-error"),this.btnJoinContainer=this.parentEl.querySelector(".btn-join-container"),this.btnJoinEl=this.parentEl.querySelector(".btn-join"),this.locatingRoomEl=this.parentEl.querySelector(".locating-room"),this.roomErrorEl=this.parentEl.querySelector(".room-error span"),n&&(this.codeInputEl.value=n);const r=null===(t=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement;this.formEl=this.parentEl.querySelector("form");const i=r.querySelector(".btn-navigation-back"),a=()=>{window.history.replaceState("","",location.origin+location.pathname),this.destroy(),i.removeEventListener("click",a)};i.addEventListener("click",a),this.formEl.addEventListener("submit",this.onSubmit),this.codeInputEl.addEventListener("input",this.onKeydownCleanCodeInput),Gt.scaleElementsToProportionToBoard({selectors:["lobbyTitle"]})}validateForm(e){return 5!==e.length?(this.displayRoomError("Must have 5 characters"),!1):!e.match(/^([a-z]|[0-9]){5}$/)||void this.displayRoomError("Alpha/Number characters only")}clearRoomErrorUponTimeout(){clearTimeout(this.roomErrorTimeout),this.roomErrorTimeout=window.setTimeout((()=>{this.roomErrorEl.textContent=""}),2500)}displayRoomError(e){this.roomErrorEl.textContent=e,this.clearRoomErrorUponTimeout()}roomErrorMarkup(){return'\n    <div class="room-error-container">\n      <div class="room-error"><span></span></div>\n    </div>\n    '}roomCodeInputMarkup(){return'\n      <input class="room-code-input" type="text" maxlength="5" placeholder="Enter Code">\n    '}joinBtnMarkup(){return'\n    <button type="submit" class="btn btn-primary btn-join">Join</button>\n    '}locatingRoomMarkup(){return`\n    <div class="locating-room" style="opacity: 0;">Locating Room ${qt({delay:0})}</div>\n    `}stageMarkup({type:e}){return"join-room"===e?this.joinRoomMarkup():""}generateMarkup(){return this.stageMarkup({type:"join-room"})}displaySubmitArea({type:e}){return jt(this,void 0,void 0,(function*(){return"join-btn"===e?(yield yt({el:this.locatingRoomEl,onEnd:e=>{e.style.opacity="0",e.style.transition=""}}),void(yield mt({el:this.btnJoinEl,onEnd:()=>{}}))):"locating-room-text"===e?(yield yt({el:this.btnJoinEl,onEnd:()=>{}}),void(yield mt({el:this.locatingRoomEl,onStart:e=>{e.style.opacity="0",e.style.transition="opacity 200ms",this.reflow(),e.style.opacity="1"},onEnd:e=>{e.style.opacity="",e.style.transition=""}}))):void 0}))}removeEventListeners(){this.formEl.removeEventListener("submit",this.onSubmit),this.codeInputEl.removeEventListener("input",this.onKeydownCleanCodeInput)}addHandlers({handlerJoinRoom:e}){this.onJoinRoom=e}destroy(){this.removeEventListeners(),super.destroy()}render(e){super.render(e)}setData(e){super.setData(e)}},Ut={title:"Lobby",section:"multiplayerChoices",listBtns:[{content:"Battle Random Player",dataAttributes:{lobbyType:"enter-pre-game",joinBy:"public",focus:"true",firstItem:"true"},aria:{"aria-label":"Join Public Game. You'll be matched with a random opponent"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]},{content:"Join <span style='text-decoration: underline;'>Private</span>",dataAttributes:{lobbyType:"join-private-game",joinBy:"private"},aria:{"aria-label":"join private game"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]},{content:"Create <span style='text-decoration: underline;'>Private</span>",dataAttributes:{lobbyType:"create-private-game",joinBy:"created-private"},aria:{"aria-label":"create private game"},classNames:["btn","btn-primary","btn-pick","btn-multiplayer"]}]};const Wt=({item:e,type:t,playerData:n,opponentSkin:r})=>{const{currentPlayer:i}=n,{svgShapes:a}=i;if("color"===t){const[n,i]=e.split(","),[a,o]=_e[e],s=r.color===e,l="color-item";return`\n      <li class="${l}-container">\n        <button \n          class="${l} ${s?"disabled":""}"\n          data-color="${e}"\n          data-disabled="${s}"\n          ${s?"disabled":""}\n          aria-label="choose gradient color of shape. Primary Color ${n}, Secondary Color ${i}"\n        >\n          <div class="${l}-bg" data-pick-item-inner="${t}">\n            <div class="${l}-inner"  style="background: linear-gradient(0deg, ${o}, ${a});">\n            </div>\n          </div>\n        </button>\n        \n\n      </li>\n        `}if("shape"===t){const n=r.shape===e,i="shape-item";return`\n      <li class="${i}-container">\n        <button \n          class="${i} ${n?"disabled":""}" \n          data-shape="${e}" \n          data-disabled="${n}"\n          ${n?"disabled":""}\n          aria-label="choose shape: ${e}"\n        >\n          <div class="${i}-bg" data-pick-item-inner="${t}">\n            <div class="${i}-inner">\n              ${a[e].replace(/filter="url\(#drop-shadow-filter\)"/g,"")}\n            </div>\n          </div>\n        </button>\n\n\n      </li>\n      `}};var Kt=new class extends nt{constructor(){super({root:"#game-menu .lobby"}),this.data={preGameType:"find-players",joinBy:"public"},this.hasSelectedSkin=!1,this.transitionRunning=!1,this.transitionMarkupReplaced=!1,this.currentPreGame="find-players",this.onJoinRoom=()=>{},this.onPickSkin=()=>{},this.countDownEl=null,this.navigationBackBtnForeign=null,this.loaderPickSkinTimeoutID=0,this.onTransitionEndPreGameStageType="find-players",this.opponentPickedSkin={color:"",shape:""},this.countDownElHidden=!1,this.tooltips=[],this.onNavigationBackBtnForeign=()=>{$t.showInnerBtn({selectors:["playerMark","playerOptionsIcon"]}),this.destroy()},this.onLobbyEvents=e=>{const t=e.target.closest("button");if(!t)return;const n=t.dataset.color,r=t.dataset.shape;"true"===t.dataset.disabled||this.hasSelectedSkin||(n&&(this.onPickSkin({type:"color",item:n}),this.freezeBtnsAndAwaitConfirmation({pickedBtn:t})),r&&(this.onPickSkin({type:"shape",item:r}),this.freezeBtnsAndAwaitConfirmation({pickedBtn:t})))}}restartOpponentProps(){this.opponentPickedSkin={color:"",shape:""},this.hasSelectedSkin=!1,this.countDownElHidden=!1}markupDidGenerate(){var e,t;const{joinBy:n}=this.data,r=null===(t=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement;this.navigationBackBtnForeign=r.querySelector(".btn-navigation-back"),this.navigationBackBtnForeign.addEventListener("click",this.onNavigationBackBtnForeign),this.parentEl.addEventListener("click",this.onLobbyEvents),Gt.scaleElementsToProportionToBoard({selectors:["lobbyTitle"]}),"public"===n&&this.onJoinRoom({type:"public"})}removeEventListeners(){this.parentEl&&(this.parentEl.removeEventListener("click",this.onLobbyEvents),this.navigationBackBtnForeign&&this.navigationBackBtnForeign.removeEventListener("click",this.onNavigationBackBtnForeign))}generateMarkup(){const{preGameType:e}=this.data;return this.preGameMarkup({type:e})}colorsMarkup(){const{mainPlayer:e,players:t}=this.data;return`\n    <ul class="color-group">\n    ${qe.map((n=>Wt({type:"color",item:n,playerData:{currentPlayer:e,players:t},opponentSkin:this.opponentPickedSkin}))).join("")}\n    </ul>\n    `}shapesMarkup(){const{mainPlayer:e,players:t}=this.data;return`\n    <ul class="shape-group">\n    ${Fe.map((n=>Wt({type:"shape",item:n,playerData:{currentPlayer:e,players:t},opponentSkin:this.opponentPickedSkin}))).join("")}\n    </ul>\n    `}pickSkinsMarkup({type:e}){const t="color"===e?this.colorsMarkup():this.shapesMarkup();return`\n\n    <div class="pick-skin">\n      <div class="lobby-title">Pick a ${n=e,n[0].toUpperCase()+n.slice(1)}</div>\n      <div class="btns-group">\n        ${t}\n      </div>\n    </div>\n\n    `;var n}waitForOpponentMarkup(){return`\n    <div class="section delayed-reveal">\n      <div class="lobby-title">Waiting for Opponent ${qt()}</div>\n    </div>\n    `}preparingGameMarkup(){return`\n    <div class="section delayed-reveal">\n      <div class="lobby-title">Preparing Game ${qt()}</div>\n    </div>\n    \n    `}findPlayersMarkup(){return`\n    <div class="section delayed-reveal">\n      <div class="lobby-title">Searching for Opponents ${qt()}</div>\n    </div>\n    `}foundPlayersMarkup(){const{joinBy:e}=this.data;let t="Found an Opponent!";return"created-private"===e&&(t="Your Buddy has Joined the Game!"),"private"===e&&(t="You have Joined your Buddy's Game!"),`\n     <div class="lobby-title">${t}</div>\n     `}declarePlayersMarkup(){const{firstPlayer:e,mainPlayer:t}=this.data,n=e.getSvgShape();let r=e===t?"<span class='which-player'>You</span> go":"<span class='which-player'>Opponent</span> goes";return r+=" First!",`\n    <div class="declare-players">\n      <div class="player-shape">${n}</div>\n      <div class="declaration">${r}</div>\n    </div>\n    `}playerLeftMarkup(){return'\n    <div class="section">\n      <div class="lobby-title">Opponent Left!</div>\n    </div>\n    '}generateCountDownMarkp(){var e,t,n;const r=`\n    <div class="player-pick-skin-countdown countdown-container">\n      <div class="countdown-circle">${tt}</div>\n      <div class="countdown">15</div>\n    </div>\n    `;this.countDownEl=Me(r),null===(n=null===(t=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n||n.appendChild(this.countDownEl),Gt.scaleElementsToProportionToBoard({selectors:["playerPickSkinCountDown"]})}preGameMarkup({type:e}){switch(e){case"find-players":return this.findPlayersMarkup();case"found-players":return this.foundPlayersMarkup();case"pick-skins":return this.countDownElHidden||this.generateCountDownMarkp(),this.pickSkinsMarkup({type:"color"});case"declare-players":return this.declarePlayersMarkup();case"wait-for-opponent":return this.waitForOpponentMarkup();case"preparing-game":return this.preparingGameMarkup();case"player-left":return this.playerLeftMarkup()}}updateBusyPlayers(e){const t=this.parentEl.querySelector(".busy-players");t&&(t.textContent=`${e} online players`)}transitionPreGameStage({type:e}){if(this.data.preGameType!==e){if(this.data.preGameType=e,"declare-players"===e&&!this.transitionRunning)return this.onTransitionEndPreGameStageType=e,void this._transitionPreGameStage({type:e});"pick-skins"===e&&this.transitionRunning?setTimeout((()=>{this.onTransitionEndPreGameStageType=e,this._transitionPreGameStage({type:e})}),1e3):!this.transitionRunning||this.transitionMarkupReplaced?(this.onTransitionEndPreGameStageType=e,this._transitionPreGameStage({type:e})):this.onTransitionEndPreGameStageType=e}}_transitionPreGameStage({type:e}){let t,n;this.currentPreGame=e,this.transitionRunning=!0,this.transitionMarkupReplaced=!1;let r=t=>{this.clearChildren(t),n&&n(t),this.reflow(),"declare-players"!==this.onTransitionEndPreGameStageType?(t.innerHTML=this.preGameMarkup({type:this.onTransitionEndPreGameStageType}),Gt.scaleElementsToProportionToBoard({selectors:["lobbyTitle"]}),"pick-skins"===e&&Gt.scaleElementsToProportionToBoard({selectors:["pickSkin","pickSkinBtnsGroup","pickSkinItems","pickSkinTitle"]}),this.transitionMarkupReplaced=!0,mt({el:t,removeDisplayNone:!0,onEnd:()=>{this.transitionRunning=!1}})):i(t)};const i=e=>{this.clearChildren(e),e.innerHTML=this.preGameMarkup({type:this.onTransitionEndPreGameStageType}),Gt.declarePlayersAnimationRunning=!0,Gt.scaleElementsToProportionToBoard({selectors:["declarePlayersDeclaration","declarePlayersShape","slideDeclarePlayersStylesheet"]}),Gt.declarePlayersAnimationRunning=!1,e.style.display="",this.reflow(),this.transitionMarkupReplaced=!0,setTimeout((()=>{const{firstPlayer:e}=this.data;$t.updatePlayerIndicator(e)}),500),mt({el:e,delay:200,removeDisplayNone:!0,transition:"200ms",onEnd:e=>{this.transitionRunning=!1}})};"preparing-game"!==e&&"wait-for-opponent"!==e||(t=e=>{e.style.transition="transform 200ms, opacity 200ms",this.reflow(),e.style.transform="translateY(-50px)",e.style.opacity="0",this.tooltips.forEach((e=>e.hide()))},n=e=>{e.style.transform="",e.style.opacity=""}),"declare-players"===e&&(r=i),yt({el:this.parentEl,displayNone:!0,onStart:t,onEnd:r})}updateCountDown(e){if(0===e&&(this.countDownElHidden=!0,this.hideAndRemoveCountDownMarkup({delay:100})),!this.countDownEl)return;const t=this.countDownEl.querySelector(".countdown"),n=this.countDownEl.querySelector("circle");t.textContent=`${e}`,n.style.strokeDasharray="37px",n.style.strokeDashoffset=(15-e)/15*37+"px"}transitionPickSkin({type:e}){return t=this,n=void 0,i=function*(){yield yt({el:this.parentEl,displayNone:!0,onStart:e=>{e.style.opacity="1",e.style.transition="transform 250ms, opacity 200ms",this.reflow(),e.style.transform="translateY(-50px)",e.style.opacity="0"},onEnd:t=>{this.clearChildren(t),t.style.transform="",t.style.opacity="",t.style.transition="",t.innerHTML=this.pickSkinsMarkup({type:e}),this.opponentPickedSkin[e]&&this.showOpponentClaimedPick({type:e,item:this.opponentPickedSkin[e]}),Gt.scaleElementsToProportionToBoard({selectors:["pickSkin","pickSkinBtnsGroup","pickSkinItems","pickSkinTitle"]}),this.hasSelectedSkin=!1}}),yield mt({el:this.parentEl,delay:200,transition:"1000ms",removeDisplayNone:!0})},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}hideAndRemoveCountDownMarkup({duration:e=200,delay:t=0,removeDelay:n=0}={duration:200,delay:0}){this.parentEl&&this.countDownEl&&yt({el:this.countDownEl,transition:`${e}ms ${t}ms`,onEnd:e=>{e.style.display="none",this.countDownEl.remove()}})}unfreezeBtns(){this.parentEl.querySelector(".btns-group").querySelectorAll("button").forEach((e=>{e.classList.remove("frozen"),e.classList.remove("selected")})),this.hasSelectedSkin=!1}freezeBtnsAndAwaitConfirmation({pickedBtn:e}){this.parentEl.querySelector(".btns-group").querySelectorAll("button").forEach((t=>{t!==e&&t.classList.add("frozen")})),this.hasSelectedSkin=!0,e.classList.add("selected"),this.showPickLoader({pickedBtn:e,delay:500})}showPickLoader({pickedBtn:e,delay:t}){e.querySelector("[data-pick-item-inner]").insertAdjacentHTML("beforeend",'\n      <div class="pick-loader delayed-reveal">\n        <div class="picker-loader-circle">\n  <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 13.229 13.229"><circle class="loader-circle" cx="6.615" cy="6.615" r="5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" paint-order="fill markers stroke"/></svg>\n  </div>\n      </div>\n      ')}cancelOrHidePickLoader(){clearTimeout(this.loaderPickSkinTimeoutID);const e=this.parentEl.querySelector(".pick-loader");e&&(e=>{const t=e.parentElement;if(!t)return null;t.removeChild(e)})(e)}failedPick({type:e,value:t}){const n=this.parentEl.querySelector(`[data-${e}="${t}"]`);this.cancelOrHidePickLoader(),this.unfreezeBtns(),this.generateTooltip({type:e,pickedBtn:n})}showOpponentClaimedPick({type:e,item:t}){const n=this.parentEl.querySelector(`[data-${e}="${t}"]`);this.opponentPickedSkin[e]=t,n&&(n.setAttribute("aria-disabled","true"),n.setAttribute("data-disabled","true"),n.setAttribute("aria-hidden","true"),n.setAttribute("disabled","true"),n.classList.add("disabled"),this.generateTooltip({type:e,pickedBtn:n}))}generateTooltip({type:e,pickedBtn:t}){const n=`Opponent already has this <strong>${e}</strong>`,r=t.firstElementChild,i=new Oe({message:n,tooltipTargetEl:r});this.tooltips.push(i)}addHandlers({handlerJoinRoom:e,handlerPickSkin:t}){this.onJoinRoom=e,this.onPickSkin=t}destroy(){this.removeEventListeners(),this.hideAndRemoveCountDownMarkup(),super.destroy()}render(e){super.render(e)}setData(e){super.setData(e)}},zt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Vt=new class extends nt{constructor(){super({root:"#game-menu .lobby-container"}),this.navigationBackBtnForeign={},this.menuBtns=Ut,this.handlerExitMultiplayer=()=>{},this.handlerConnectServer=()=>{},this.lobbyEl={},this.onLobbyClick=e=>zt(this,void 0,void 0,(function*(){if(Ht.hasRendered)return;const t=e.target.closest(".btn");if(e.detail,!t)return;const n=t.dataset.lobbyType,r=t.dataset.joinBy;(n||r)&&(this.data.type=n,this.data.joinBy=r,this.transitionSection({type:"lobbyRoom"}))})),this.onNavigationBackBtnForeign=e=>{if([Ht.hasRendered,Kt.hasRendered,Nt.hasRendered].some((e=>e)))return e.stopPropagation(),this.transitionSection({type:"menuBtns"}),$t.showInnerBtn({selectors:["playerMark","playerOptionsIcon"]}),$t.enableBtns(),void this.handlerExitMultiplayer();this.navigationBackBtnForeign.removeEventListener("click",this.onNavigationBackBtnForeign),this.destroy()},this.data={type:"enter-pre-game"}}markupDidGenerate(){var e;const{jumpIntoSection:t}=this.data,n=null===(e=this.parentEl.parentElement)||void 0===e?void 0:e.parentElement;this.navigationBackBtnForeign=n.querySelector(".btn-navigation-back"),this.lobbyEl=this.parentEl.querySelector(".lobby"),this.navigationBackBtnForeign.addEventListener("click",this.onNavigationBackBtnForeign),this.parentEl.addEventListener("click",this.onLobbyClick),t?setTimeout((()=>{this.transitionSection({type:"lobbyRoom"})}),200):(Gt.scaleElementsToProportionToBoard({selectors:["gameMenuTitle","gameMenuBtns","lobbyTitle"]}),this.handlerConnectServer())}destoryLobbyRooms(){Ht.hasRendered&&Ht.destroy(),Kt.hasRendered&&Kt.destroy(),Nt.hasRendered&&Nt.destroy()}transitionSection({type:e}){let t="menu",n=()=>{this.destoryLobbyRooms(),this.parentEl.innerHTML=`\n      <div class="lobby">\n        ${this.lobbyMenuMarkup()}\n      </div>\n      `,Gt.scaleElementsToProportionToBoard({selectors:["gameMenuTitle","gameMenuBtns"]})};"lobbyRoom"===e&&(t="lobby",n=()=>this.renderLobbyType()),yt({el:this.parentEl,onEnd:e=>{n(),Zt.changeMenuTheme(t),mt({el:e})}})}transitionBetweenLobbyTypes({type:e}){return zt(this,void 0,void 0,(function*(){this.data.type=e,yield yt({el:this.parentEl,onEnd:()=>{this.renderLobbyType()}}),yield mt({el:this.parentEl})}))}renderLobbyType(){const{type:e,firstPlayer:t,mainPlayer:n,players:r,joinBy:i}=this.data;switch(this.destoryLobbyRooms(),this.parentEl.innerHTML='<div class="lobby"></div>',e){case"enter-pre-game":return void Kt.render({preGameType:"find-players",joinBy:i,firstPlayer:t,mainPlayer:n,players:r});case"join-private-game":return Nt.setData({firstPlayer:t,mainPlayer:n,players:r}),void Nt.render();case"create-private-game":return void Ht.render({firstPlayer:t,mainPlayer:n,players:r})}}lobbyMenuMarkup(){const{titleId:e,listBtns:t,title:n,section:r}=this.menuBtns;return`\n      ${n?`\n    <div ${e?`id="${e}"`:""} class="menu-title lobby-menu-title" ${"Difficulty"===n?'aria-label="Computer Difficulty"':""}>${n}</div> \n    `:""}\n      <ul class="menu-buttons">\n        ${t.map((e=>{const t=De({type:"data",obj:e.dataAttributes}),n=De({type:"aria",obj:e.aria});return`\n        <li class="menu-item">\n          <a \n            class="${e.classNames.join(" ")}"\n            ${t}\n            ${n}\n            data-section="${r}"\n            href="javascript:void(0)"\n          >\n            ${e.content}\n          </a>\n        </li>\n      `})).join("")}\n      </ul>\n    `}connectServerMarkup(){return`\n    <div class="section delayed-reveal">\n      <div class="lobby-title lobby-menu-title">Connecting to Server ${qt()}</div>\n    </div>\n    `}generateMarkup(){return`\n    <div class="lobby">\n      ${this.connectServerMarkup()}\n    </div>\n    `}hideAndRemoveCountDownMarkup({duration:e=200,delay:t=0,removeDelay:n=0}={duration:200,delay:0}){Kt.hideAndRemoveCountDownMarkup({delay:t,duration:e,removeDelay:n})}addHandlers({handlerJoinRoom:e,handlerCreateRoom:t,handlerPickSkin:n,handlerExitMultiplayer:r,handlerConnectServer:i}){this.handlerExitMultiplayer=r,this.handlerConnectServer=i,Kt.addHandlers({handlerJoinRoom:e,handlerPickSkin:n}),Nt.addHandlers({handlerJoinRoom:e}),Ht.addHandlers({handlerCreateRoom:t})}destroy(){this.navigationBackBtnForeign.removeEventListener("click",this.onNavigationBackBtnForeign),this.destoryLobbyRooms(),super.destroy()}render(e){super.render(e)}setData(e){super.setData(e)}};const Jt={openingDef:'<svg xmlns="http://www.w3.org/2000/svg" class="defs-collection" height="0" width="0" viewBox="0 0 32 32">\n    <defs>',closingDef:"</defs></svg>",primaryColor:'<linearGradient id="a">\n      <stop class="color-primary" stop-color="#000"/>\n    </linearGradient>',secondaryColor:'<linearGradient id="a">\n    <stop class="color-secondary" stop-color="#000"/>\n  </linearGradient>',circle:'<linearGradient id="a">\n    <stop offset="0" class="color-primary" stop-color="#ff4900"/>\n    <stop offset="1" class="color-secondary" stop-color="#ffc300"/>\n  </linearGradient>\n  <linearGradient xlink:href="#a" id="b" x1="53.5009" y1="-2.4148" x2="53.5009" y2="13.775" gradientUnits="userSpaceOnUse"/>',cross:'\n  <linearGradient id="b">\n    <stop class="color-primary" offset="0" stop-color="currentColor"/>\n    <stop class="color-secondary" offset="1" stop-color="currentColor"/>\n  </linearGradient>\n  <linearGradient id="a">\n    <stop class="color-secondary" offset="0" stop-color="currentColor"/>\n    <stop class="color-primary" offset="1" stop-color="currentColor"/>\n  </linearGradient>\n  <linearGradient gradientUnits="userSpaceOnUse" y2="19.9728" x2="6.4856" y1="13.2292" x1="13.2292" id="d" xlink:href="#a"/>\n  <linearGradient gradientUnits="userSpaceOnUse" y2="22.7431" x2="21.9646" y1="11.6221" x1="11.6221" id="c" xlink:href="#b"/>',triangle:'\n    <linearGradient id="a">\n      <stop class="color-primary" offset="0" stop-color="#0cf"/>\n      <stop class="color-secondary" offset="1" stop-color="#5fd"/>\n    </linearGradient>\n    <linearGradient y2="22.7431" x2="21.9646" y1="11.6221" x1="11.6221" gradientTransform="rotate(135 12.262 17.1198)" gradientUnits="userSpaceOnUse" id="b" xlink:href="#a"/>\n    <linearGradient y2="2.5327" x2="14.1158" y1="17.7946" x1="17.659" gradientTransform="rotate(-105 11.2177 15.5445)" gradientUnits="userSpaceOnUse" id="c" xlink:href="#a"/>\n    <linearGradient y2="5.1297" x2="6.2886" y1="16.1127" x1="17.2162" gradientTransform="rotate(15 18.6084 26.6946)" gradientUnits="userSpaceOnUse" id="d" xlink:href="#a"/>\n',heart:'\n    <linearGradient id="e">\n      <stop class="color-primary" offset="0" stop-color="#ff005b"/>\n      <stop class="color-secondary" offset="1" stop-color="#ff00e4" stop-opacity=".9843"/>\n    </linearGradient>\n    <linearGradient gradientUnits="userSpaceOnUse" y2="20.5725" x2="15.9935" y1="4.2042" x1="12.8753" id="f" xlink:href="#e"/>',square:'\n    <linearGradient id="b">\n      <stop class="color-secondary" offset="0" stop-color="#5fd"/>\n      <stop class="color-primary" offset="1" stop-color="#3befe8"/>\n    </linearGradient>\n    <linearGradient id="a">\n      <stop class="color-secondary" offset="0" stop-color="#5fd"/>\n      <stop class="color-primary" offset="1" stop-color="#0cf"/>\n    </linearGradient>\n    <linearGradient xlink:href="#a" id="f" gradientUnits="userSpaceOnUse" gradientTransform="rotate(45 3.692 13.23)" x1="4.126" y1="10.97" x2="12.653" y2="12.746"/>\n    <linearGradient xlink:href="#a" id="e" gradientUnits="userSpaceOnUse" gradientTransform="rotate(-45 19.973 6.486)" x1="24.009" y1="1.258" x2="6.456" y2="18.869"/>\n    <linearGradient xlink:href="#a" id="d" gradientUnits="userSpaceOnUse" gradientTransform="rotate(-135 13.23 9.279)" x1="17.574" y1="10.419" x2="12.49" y2="9.696"/>\n    <linearGradient xlink:href="#a" id="c" gradientUnits="userSpaceOnUse" gradientTransform="rotate(-45 13.23 22.766)" x1="15.711" y1="2.769" x2="11.511" y2="15.047"/>\n    <linearGradient xlink:href="#b" id="g" x1="19.962" y1="1.869" x2="19.962" y2="7.468" gradientUnits="userSpaceOnUse" gradientTransform="translate(-6.753 6.725)"/>\n  ',kite:'\n    <linearGradient id="a">\n    <stop class="color-secondary" offset="0" stop-color="#5fd"/>\n     <stop class="color-primary" offset="1" stop-color="#0cf"/>\n    </linearGradient>\n    <linearGradient xlink:href="#a" id="g" gradientUnits="userSpaceOnUse" gradientTransform="rotate(45 45.101 49.789)" x1="20.896" y1="8.919" x2="13.883" y2="6.051"/>\n    <linearGradient xlink:href="#a" id="f" gradientUnits="userSpaceOnUse" gradientTransform="rotate(135 31.877 12.388)" x1="14.14" y1="10.931" x2="14.156" y2="4.928"/>\n  ',dropShadow:'\n    <filter id="drop-shadow-filter" height="100" width="100" filterUnits="userSpaceOnUse"  color-interpolation-filters="sRGB">\n      <feFlood flood-opacity="1" flood-color="#000" result="flood"/>\n      <feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1"/>\n      <feGaussianBlur in="composite1" result="blur"/>\n      <feOffset dy="1.8" result="offset"/>\n      <feComposite in="SourceGraphic" in2="offset" result="composite2"/>\n    </filter>\n    <filter id="drop-shadow-filter-slash" height="100" width="100" filterUnits="userSpaceOnUse"  color-interpolation-filters="sRGB">\n      <feFlood flood-opacity="1" flood-color="rgba(0, 0, 0, 0.35)" result="flood"/>\n      <feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1"/>\n      <feGaussianBlur in="composite1" result="blur"/>\n      <feOffset dy="0.7" result="offset"/>\n      <feComposite in="SourceGraphic" in2="offset" result="composite2"/>\n    </filter>    \n\n    '},Yt=["cross","circle","triangle","heart","primaryColor","secondaryColor"];var Xt=new class extends nt{constructor(){super({root:".svg-defs-container"}),this.data=[]}shapeDefsMarkup(){return(e=>((...e)=>Jt.openingDef+e.join("")+Jt.closingDef)(e.map((e=>{return t=e.id,Yt.map((e=>Be({id:`-${e}-${t}`,svg:Jt[e]}))).join("");var t})).join("")))(this.data)}clipPathDefsMarkup(){return'\n    <svg xmlns="http://www.w3.org/2000/svg">\n        <circle id="clipPath-dropdown-P1-circle" cx="0" cy="60px" r="0px" fill="red"/>\n        <circle id="clipPath-dropdown-P2-circle" cx="100%" cy="60px" r="0px" fill="red"/>\n    </svg>\n    '}dropShadowMarkup(){return`\n    <svg xmlns="http://www.w3.org/2000/svg">\n      <defs>\n        ${Jt.dropShadow}\n      </defs>\n    </svg>\n    `}generateMarkup(){return`\n      <div class="shape-defs-container">\n        ${this.shapeDefsMarkup()}\n      </div>\n      <div class="clip-path-container">\n        ${this.clipPathDefsMarkup()}\n      </div>\n      <div class="drop-shadow-container">\n        ${this.dropShadowMarkup()}\n      </div>\n    `}setColorOfPlayer(e,t){if(!e.color)return;const[n,r]=_e[e.color],i=`.color-primary-${t}-${e.id}`,a=`.color-secondary-${t}-${e.id}`,o=document.querySelectorAll(i),s=document.querySelectorAll(a);o.forEach((e=>{e.setAttribute("stop-color",n)})),s.forEach((e=>{e.setAttribute("stop-color",r)}))}render(e){super.render(e),this.setColors()}updateDropShadow(e){this.parentEl.querySelector("#drop-shadow-filter feFlood").style.floodColor=e}updateShapeColors(e){this.data=e,this.parentEl.querySelector(".shape-defs-container").innerHTML=this.shapeDefsMarkup(),this.setColors()}setColor(e){for(let t of Yt)this.setColorOfPlayer(e,t)}setColors(){this.data.forEach((e=>this.setColor(e)))}},Qt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Zt=new class extends nt{constructor(){super({root:"#game-menu"}),this.menuState=Ot,this.currentSection="start",this.renderInit=!0,this.vsPlayer="ai",this.navigationHistory=[],this.handlerStartGame=()=>{},this.handlerLeaveGame=()=>{},this.handlerPlayAgain=()=>{},this.handlerSettings=()=>{},this.handlerExitMultiplayer=()=>{},this.theme="menu",this.data={players:[],roomCode:null}}generateLobbyRootMarkup(){this.parentEl.querySelector(".section").insertAdjacentHTML("beforeend",'<div class="lobby-container"></div>')}markupDidGenerate(){const{players:e,roomCode:t}=this.data;this.updatePlayersMark(e),this.renderInit=!1,t&&(this.navigationHistory=["start","multiplayer"],this.showBtnNavigationBack(),this.transtionToNextGeneralSection({type:"lobby",backBtnSelected:!1,clicked:!0,replaceWith:()=>{this.generateLobbyRootMarkup(),Vt.render({type:"join-private-game",joinBy:"private",jumpIntoSection:!0,mainPlayer:e[0],firstPlayer:e[0],players:e})}})),this.parentEl.addEventListener("click",(e=>{if(Vt.hasRendered)return;const t=e.target.closest(".btn");let n=!0;if(0===e.detail&&(n=!1),!t)return;const r=!(e=>0===e.detail)(e),i=t.dataset.navigationBack,a=t.dataset.playAgainst,o=t.dataset.playAgain,s=t.dataset.playerId,l=t.dataset.difficulty,d=t.dataset.transitionTo,c=t.dataset.section,p=(t.dataset.lobbyType,t.dataset.joinBy,t.dataset.open),u=t.dataset.vs;if(t.dataset.exitMultiplayer&&(this.handlerExitMultiplayer(),this.handlerLeaveGame()),l&&(this.handlerSettings({type:"aiEnabled",value:!0}),this.handlerSettings({type:"aiDifficulty",value:l})),u&&(this.vsPlayer=u,"human"===u&&this.handlerSettings({type:"aiEnabled",value:!1}),this.updatePlayersMark(this.data.players)),d)return this.transitionToNextMenuSection({sectionType:d,currentSection:c,clicked:n}),this.changeMenuTheme("menu"),void("aiDifficulty"===d&&this.handlerSettings({type:"aiEnabled",value:!0}));i&&this.onBtnNavigationBack(),p&&(this.navigationHistory.push(c),this.transtionToNextGeneralSection({type:"lobby",backBtnSelected:!1,clicked:!0,replaceWith:()=>{const{players:e}=this.data;this.generateLobbyRootMarkup(),Vt.render({mainPlayer:e[0],firstPlayer:e[0],players:e})}})),"true"!==o?"human"!==a?"ai"!==a||this.startGameAndHideMenu({firstMovePlayer:s,ai:!0,triggeredByClick:r}):this.startGameAndHideMenu({firstMovePlayer:s,ai:!1,triggeredByClick:r}):this.playAgainAndHideMenu({triggeredByClick:r})}))}generateMarkup(){return`\n    <div class="menu">\n    ${this.backgroundSVGMarkup()}\n    ${this.navigationBackMarkup()}\n      <div class="section">\n      ${this.menuMarkup({sectionType:"start"})}\n      </div>\n    </div>\n    `}navigationBackMarkup(){return`\n    <button class="btn btn-navigation-back hidden" data-navigation-back="true" aria-label="go back to previous menu selection">${Ze}</button>\n    `}backgroundSVGMarkup(){return`\n    <div class="background-svg">${et}</div>\n    `}menuMarkup({sectionType:e}){const{titleId:t,listBtns:n,title:r,section:i}=this.menuState[e];return this.currentSection=e,`\n    <div class="section-menu">\n      ${r?`\n    <div ${t?`id="${t}"`:""} class="menu-title" ${"Difficulty"===r?'aria-label="Computer Difficulty"':""}>${r}</div> \n    `:""}\n      <ul class="menu-buttons">\n        ${n.map((e=>{const t=De({type:"data",obj:e.dataAttributes}),n=De({type:"aria",obj:e.aria});return`\n        <li class="menu-item">\n          <a \n            class="${e.classNames.join(" ")}"\n            ${t}\n            ${n}\n            data-section="${i}"\n            href="javascript:void(0)"\n          >\n            ${e.content}\n          </a>\n        </li>\n      `})).join("")}\n      </ul>\n    </div>\n    `}revealGameOverMenu(){const e=this.parentEl.querySelector(".section");this.transtionToNextGeneralSection({type:"section",backBtnSelected:!0,replaceWith:this.menuMarkup({sectionType:"playAgain"}),updateToNextWithoutTransition:!0}),this.parentEl.style.display="",this.reflow(),this.parentEl.classList.remove("onExit"),Gt.scaleElementsToProportionToBoard({selectors:["gameMenu","gameMenuBtns","gameMenuTitle","gameOverPlayerResult","gameOverPlayerShape"]});const t=()=>{mt({el:e,onStart:e=>{e.classList.remove("hidden"),e.style.transition="opacity 200ms",this.reflow(),e.style.opacity="1"}})};setTimeout((()=>{t()}),1e3)}hideMenu(){return Qt(this,void 0,void 0,(function*(){const e=this.parentEl.querySelector(".section");yield yt({el:e,onEnd:e=>{e.style.display="",e.classList.add("hidden")}}),yield yt({el:this.parentEl,duration:800,useTransitionEvent:!1,onStart:e=>{e.classList.add("onExit"),this.hideBtnNavigationBack()},onEnd:e=>{e.style.display="none"}})}))}changeMenuTheme(e){if(e===this.theme)return;this.theme=e;const t=document.querySelector(".game");document.querySelector(".board").style.transition="box-shadow 500ms",this.reflow(),"lobby"===e&&t.classList.add("lobby"),"menu"===e&&t.classList.remove("lobby")}updatePlayerMark(e){const{menuState:{goFirst:t},currentSection:n,renderInit:r,vsPlayer:i}=this,a=t.listBtns.find((t=>t.id===e.id)),o=a.dataAttributes.shape,s="P1"===e.id?"You":"Computer",l=e.getSvgShape(),d="ai"===i?`\n    <span class="btn-txt-content">${s}</span>\n    `:"";if("human"===i){const t="P1"===e.id?"You go first":"Computer goes first";a.dataAttributes=Object.assign(Object.assign({},a.dataAttributes),{playAgainst:"human"}),a.aria=Object.assign(Object.assign({},a.aria),{"aria-label":t})}if("ai"===i){const t="P1"===e.id?"Player 1 goes first":"Player 2 goes first";a.dataAttributes=Object.assign(Object.assign({},a.dataAttributes),{playAgainst:"ai"}),a.aria=Object.assign(Object.assign({},a.aria),{"aria-label":t})}if(a.dataAttributes.shape=e.shape,a.content=`\n    ${d}\n        <span class="btn-svg-mark">\n          ${l}\n        </span>\n      `,o===e.shape)return;if("goFirst"!==n)return;const c=this.parentEl.querySelector(`[data-player-id="${e.id}"]`);(r||c)&&(c.querySelector(".btn-svg-mark svg").replaceWith(Me(l)),"ai"===i&&(c.querySelector(".btn-txt-content").textContent=s))}updatePlayersMark(e){this.data.players=e,e.forEach((e=>this.updatePlayerMark(e)))}renderGameOverMenu({declare:e,player:t,tie:n,playerLeft:r}){this.menuState.playAgain.title=this.gameOverMenuMarkup({declare:e,player:t,playerLeft:r,tie:n}),this.revealGameOverMenu(),r&&(document.querySelector("[data-section='playAgain']").style.display="none")}gameOverMenuMarkup({declare:e,player:t,tie:n,playerLeft:r}){let i="winner"===e?"Victory!":"Defeat!",a=t?`<div class="player-shape ${"loser"===e?"monochrome":""}" aria-hidden="true">${t.getSvgShape()}</div>`:"";return n&&(i="Tie!",a=""),r&&(i="Opponent Left!"),`\n      <div class="game-over-title">\n        ${a}\n        <div class="player-result">${i}</div>\n      </div>\n    `}onBtnNavigationBack(){const e=this.navigationHistory.pop();this.changeMenuTheme("menu"),this.navigationHistory.length||this.hideBtnNavigationBack(),this.transtionToNextGeneralSection({type:"section",backBtnSelected:!0,replaceWith:this.menuMarkup({sectionType:e})})}transtionToNextGeneralSection({type:e,replaceWith:t,backBtnSelected:n,clicked:r=!1,updateToNextWithoutTransition:i=!1}){return Qt(this,void 0,void 0,(function*(){const a=this.parentEl.querySelector(".section");if(i)return"string"==typeof t&&(a.innerHTML=t),void("function"==typeof t&&t());yield yt({el:a,displayNone:!0,onEnd:n=>{this.clearChildren(n),"string"==typeof t&&(n.innerHTML=t),"function"==typeof t&&t(),"section"===e&&Gt.scaleElementsToProportionToBoard({selectors:["gameMenuBtns","gameMenuTitle","gameMenuBtnPickPlayer"]})}}),yield mt({el:a,removeDisplayNone:!0,onEnd:()=>{if("lobby"===e)return;if(n)return;const t=this.parentEl.querySelector('[data-focus="true"]');t.focus(),r||t.classList.add("noFocusClick")}})}))}transitionToNextMenuSection({sectionType:e,currentSection:t,clicked:n}){this.setNavigationHistory({currentSection:t,nextSection:e}),this.navigationHistory.length&&this.showBtnNavigationBack(),"goFirst"===e&&Xt.updateDropShadow("#000"),this.transtionToNextGeneralSection({type:"section",backBtnSelected:!1,clicked:n,replaceWith:this.menuMarkup({sectionType:e})})}setNavigationHistory({currentSection:e,nextSection:t}){if(!e)return;if("start"===t)return void(this.navigationHistory=[]);const n=this.navigationHistory.findIndex((t=>e===t));n>-1?this.navigationHistory.splice(n):this.navigationHistory.push(e)}hideBtnNavigationBack(){this.parentEl.querySelector(".btn-navigation-back").classList.add("hidden")}showBtnNavigationBack(){this.parentEl.querySelector(".btn-navigation-back").classList.remove("hidden")}addHandlers({handlerPlayAgain:e,handlerStartGame:t,handlerSettings:n,handlerExitMultiplayer:r,handlerLeaveGame:i}){this.handlerStartGame=t,this.handlerPlayAgain=e,this.handlerSettings=n,this.handlerLeaveGame=i,this.handlerExitMultiplayer=r}startGameAndHideMenu({firstMovePlayer:e,ai:t=!1,difficulty:n,triggeredByClick:r=!0}){return Qt(this,void 0,void 0,(function*(){this.changeMenuTheme("menu"),yield this.hideMenu(),t&&this.handlerSettings({type:"aiEnabled",value:!0}),this.handlerStartGame({firstMovePlayer:e,ai:t,difficulty:n,triggeredByClick:r})}))}playAgainAndHideMenu({triggeredByClick:e=!0}={}){this.hideMenu(),this.handlerPlayAgain({triggeredByClick:e})}render(e){super.render(e)}};var en=new class extends nt{constructor(){super({root:"#overlay"})}show(){this.parentEl.classList.add("active")}hide(){this.parentEl.classList.remove("active")}};const tn="ArrowDown",nn="ArrowUp",rn="ArrowLeft",an="ArrowRight",on="Home",sn="Tab",ln="Escape",dn="Enter",cn="a[href], area[href], input[type='checkbox']:not([disabled]), [role='radiogroup']:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",pn=({activeElement:e,direction:t,elements:n,collapse:r})=>{if("left"!==t)if("right"!==t);else{const t=e.getAttribute("data-setting-id"),r=n.find((e=>Re(e,{attr:"data-parent-setting-id",val:t})));if(!r)return;hn({activeElement:e,nextElement:r})}else{const t=e.getAttribute("data-parent-setting-id"),r=n.find((e=>Re(e,{attr:"data-setting-id",val:t})));if(!r)return;hn({activeElement:e,nextElement:r})}},un=({activeElement:e,direction:t,elements:n,roving:r})=>{const i=n.findIndex((t=>t===e)),a=n.length-1;let o=i;if("forwards"!==t)if("backwards"!==t);else{if(i<=0){if(!r)return hn({nextElement:n[0],activeElement:e});o=a}else o--;for(let t=o;t>=0;t--){if("true"!==n[t].getAttribute("aria-disabled"))return void hn({nextElement:n[t],activeElement:e});0===t&&(t=a+1)}}else{if(i>=a){if(!r)return hn({nextElement:n[a],activeElement:e});o=0}else o++;for(let t=o;t<n.length;t++){if("true"!==n[t].getAttribute("aria-disabled"))return void hn({nextElement:n[t],activeElement:e});t===a&&(t=-1)}}},hn=({activeElement:e,nextElement:t,focus:n=!0})=>{e.setAttribute("tabindex","-1"),e.setAttribute("data-selected","false"),t.setAttribute("tabindex","0"),t.setAttribute("data-selected","true"),n&&t.focus()},yn=({e:e,selectedItem:t,type:n})=>{const r=Array.from(t.querySelectorAll(cn));"enter"!==n?r.length||(document.querySelector('[data-next-focus="true"]').focus(),e.stopPropagation(),e.preventDefault()):r.some((e=>Re(e,{attr:"role",val:"radiogroup"})?(Array.from(e.querySelectorAll("input")).some((e=>{if(e.checked)return e.focus(),!0})),!0):(e.focus(),!0)))},mn=e=>{const t=e.getAttribute("type");return!!t&&"radio"===t},gn=[{id:"gamePlay",level:1,tabindex:0,type:"section",content:"Gameplay",children:["firstMove","player2"]},{id:"firstMove",type:"group",groupType:"radio",content:"First Move",children:["alternateRadio","winnerRadio","loserRadio"],aria:{"aria-label":"Which player makes the first move at the start of each game"}},{id:"alternateRadio",type:"radio",name:"firstMove",content:"Alternate",dataAttributes:{settingInput:"true",type:"firstMove",value:"alternate"},checked:!0},{id:"winnerRadio",type:"radio",name:"firstMove",content:"Winner",dataAttributes:{settingInput:"true",type:"firstMove",value:"winner"}},{id:"loserRadio",type:"radio",name:"firstMove",content:"Loser",dataAttributes:{settingInput:"true",type:"firstMove",value:"loser"}},{id:"player2",type:"section",content:"Player 2",children:["toggleAi","aiDifficulty"]},{id:"toggleAi",type:"toggle",content:"Enable as Computer",dataAttributes:{settingId:"toggleAi",settingInput:"true",type:"aiEnabled",toggleOthers:"true"}},{id:"aiDifficulty",type:"group",groupType:"radio",content:"Difficulty",disabled:!0,children:["mediumRadio","hardRadio","cheaterRadio"],dataAttributes:{toggledBy:"toggleAi"}},{id:"mediumRadio",type:"radio",name:"difficulty",content:"Medium",disabled:!0,dataAttributes:{settingInput:"true",type:"aiDifficulty",value:"medium",toggledBy:"toggleAi"}},{id:"hardRadio",type:"radio",name:"difficulty",content:"Hard",disabled:!0,dataAttributes:{settingInput:"true",type:"aiDifficulty",value:"hard",toggledBy:"toggleAi"},checked:!0},{id:"cheaterRadio",type:"radio",name:"difficulty",content:"Cheater",disabled:!0,dataAttributes:{settingInput:"true",type:"aiDifficulty",value:"cheater",toggledBy:"toggleAi"}},{id:"site",level:1,type:"section",content:"Site",children:["toggleAnimations"]},{id:"toggleAnimations",type:"toggle",content:"Enable Animations",dataAttributes:{settingToggleId:"toggleAnimations",settingInput:"true",type:"animationsEnabled"},checked:!0}],vn=({parentId:e,item:t,ariaLevel:n,ariaSetsize:r,ariaPosinset:i})=>{switch(t.type){case"button":return Pn(t.content);case"radio":return Sn(t);case"toggle":return fn({parentId:e,item:Object.assign(Object.assign({},t),{content:bn(t)}),ariaLevel:n,ariaSetsize:r,ariaPosinset:i});case"group":case"section":return fn({parentId:e,item:t,ariaLevel:n,ariaSetsize:r,ariaPosinset:i})}},fn=({parentId:e,item:t,ariaLevel:n,ariaSetsize:r,ariaPosinset:i})=>{const a="section"===t.type?'aria-expanded="true"':"",o=t.id!==e?`data-parent-setting-id="${e}"`:"";let s="",l="",d="";return t.children&&(s=t.children.map(((e,r)=>{const i=gn.find((t=>t.id===e)),a="section"===t.type?t.children.length:i.children?i.children.length:0;return vn({parentId:t.id,item:i,ariaLevel:n+1,ariaSetsize:a,ariaPosinset:r+1})})).join("")),"section"===t.type&&(l=s,d=`\n      <div class="title">\n        ${t.content}\n      </div>\n      \n  `),"toggle"===t.type&&(d=`${t.content}`),"group"===t.type&&(d=kn({parentId:t.id,children:s,item:t,level:n+1})),`\n    <div\n     ${o}\n     data-setting-id="${t.id}"\n     class="section"\n     role="treeitem"\n     ${a}\n     aria-posinset="${i}"\n     aria-setsize="${r}"\n     aria-level="${n}"\n     data-level="${n}"\n     tabindex="${null==t.tabindex?"-1":t.tabindex}"\n    >\n      ${d}\n    </div>\n    ${l}\n  `},bn=e=>{const{content:t,dataAttributes:n,aria:r,checked:i}=e,a=De({type:"data",obj:n}),o=De({type:"aria",obj:r});return xn({label:t,aria:o,dataAttributes:a,checked:i})},kn=e=>{switch(e.item.groupType){case"button":return wn(e);case"radio":return En(e)}},wn=({parentId:e,children:t,item:n,level:r})=>`\n    <div class="group">\n      <div class="title">\n        ${n.content}\n      </div>\n      ${t}\n    </div>\n    `,En=({parentId:e,children:t,item:n,level:r})=>{let i=De({type:"aria",obj:n.aria});i=i||`aria-label="${n.content}"`;const a="radiogroup"+n.id,o=`<h${r+1} id="${a}" class="title" ${i}>${n.content}</h${r+1}>`,s=n.disabled?"disabled":"",l=n.dataAttributes&&n.dataAttributes.toggledBy;return`\n      <div role="radiogroup" class="radio-group group ${s}" ${l?`data-toggled-by="${l}"`:""} aria-labelledby="${a}" >\n        ${o}\n        ${t}\n      </div>\n    `},Sn=e=>{const{content:t,aria:n,checked:r,disabled:i,dataAttributes:a,name:o}=e,s=De({type:"data",obj:a}),l=De({type:"aria",obj:n}),d=a&&a.toggledBy;return Cn({value:t,checked:r,disabled:i,aria:l,dataAttributes:s,name:o,toggledBy:d?`data-toggled-by="${d}"`:""})},Pn=e=>`\n  <button>${e}</button>\n  `,Cn=({value:e,checked:t,name:n,disabled:r,dataAttributes:i,aria:a,toggledBy:o})=>{const s=e[0].toUpperCase()+e.slice(1).toLowerCase(),l=r?"disabled":"";return`\n    <div class="radio ${l}" ${i}>\n      <input type="radio" id="for-${e}" name="${n}" ${o} ${t?"checked":""} ${l}>\n      <label for="for-${e}" ${a}>\n        <span class="radio-icon">${Xe}</span>\n        <span class="label-content">\n          ${s}\n        </span> \n      </label>\n    </div>\n    `},xn=({label:e,dataAttributes:t,aria:n,disabled:r,checked:i})=>`\n  <div class="toggle-container">\n    <label class="toggle-control" ${n}>\n    ${e}\n      <span class="toggle-container">\n        <input ${t}  type="checkbox" ${i?"checked":""} ${r?"disabled":""}>\n        <span class="control"></span>\n      </span>\n    </label>\n  </div>\n  `;var Tn=new class extends nt{constructor(){super({root:"#settings"}),this.data={},this.settingsBtn={},this.settingsDropdown={},this.closeButton={},this.isOpen=!1,this.handlerSettings=()=>{},this.handlerMoveAi=()=>{}}markupDidGenerate(){this.updateFromLS(),this.updatePlayerSVGMark(this.data.players[1]),this.settingsBtn=this.parentEl.querySelector(".settings-btn"),this.settingsDropdown=this.parentEl.querySelector(".settings-dropdown"),this.closeButton=this.parentEl.querySelector(".btn-close"),Mt.subscribe({media:"(prefers-reduced-motion: reduce)",handler:({matches:e})=>{if(localStorage.getItem("(prefers-reduced-motion: reduce)"))return;const t=this.parentEl.querySelector('[data-setting-toggle-id="toggleAnimations"]');t&&(t.checked=!e)}}),this.settingsBtn.addEventListener("click",(()=>{ke({button:this.settingsBtn,run:this.openDropdown.bind(this),onExit:this.closeDropdown.bind(this),allow:[".settings-dropdown"],not:[".btn-close"]})})),this.closeButton.addEventListener("keydown",(e=>{"Tab"===e.key&&(this.parentEl.querySelector('.settings-tree [tabindex="0"]').focus(),e.preventDefault(),e.stopPropagation())})),this.settingsDropdown.addEventListener("keydown",(e=>{"Tab"===e.key&&document.activeElement===this.settingsDropdown&&(this.parentEl.querySelector('.settings-tree [tabindex="0"]').focus(),e.preventDefault(),e.stopPropagation())})),this.parentEl.addEventListener("change",(e=>{const t=e.target.closest("[data-setting-input='true']"),n=t.dataset.type,r=t.dataset.value?t.dataset.value:t.checked,i=t.dataset.settingId,a=t.dataset.toggleOthers;t&&this.handlerSettings({type:n,value:r,updatedFromSettingsView:!0}),"animationsEnabled"===n&&(localStorage.setItem("(prefers-reduced-motion: reduce)",`${!r}`),Mt.fire({media:"(prefers-reduced-motion: reduce)",matches:!r})),a&&this.toggleOthers({settingId:i,settingValue:r})})),(({el:e})=>{const t=Array.from(e.querySelectorAll('[role="treeitem"]')),n={innerWidgets:{selected:!1,lastItem:!1},prevFocusedTreeItem:t[0]};e.addEventListener("click",(e=>{const t=e.target,{prevFocusedTreeItem:r}=n,i=["input",'[role="radiogroup"]',"button","label"].some((e=>t.closest(e))),a=t.closest('[role="treeitem"]');n.innerWidgets.selected=!1,a!==r?hn({activeElement:r,nextElement:a,focus:!i}):a.setAttribute("data-selected","true")}));const r=()=>t.find((e=>{const t=e.getAttribute("data-selected");if(t)return"true"===t}));e.addEventListener("keyup",(e=>{const t=e.target;if(e.key!==sn)return;const n=r();return n&&n!==t.closest('[role="treeitem"]')?(n.focus(),void e.stopPropagation()):void 0})),e.addEventListener("keydown",(e=>{const n=e.target;if(i=e.key,![tn,nn,rn,an,on,"End",sn,dn,ln].includes(i))return;var i;if(!n.matches('[role="treeitem"]')){if(e.key===ln&&(r().focus(),e.stopPropagation()),e.key===sn){const t=r();if(t!==n.closest('[role="treeitem"]'))return t.focus(),e.stopPropagation(),void e.preventDefault();const i=Array.from(t.querySelectorAll(cn)),a=i.length-1,o=document.activeElement;let s=o;mn(o)&&(s=o.closest('[role="radiogroup"]')),i.indexOf(s)!==a&&i.length||(document.querySelector('[data-next-focus="true"]').focus(),e.stopPropagation(),e.preventDefault())}return}n.setAttribute("data-selected","true");const a=r();if(a)switch(e.key){case sn:yn({type:"tab",e:e,selectedItem:a});break;case dn:yn({type:"enter",e:e,selectedItem:a});break;case nn:un({activeElement:a,direction:"backwards",elements:t,roving:!1});break;case tn:un({activeElement:a,direction:"forwards",elements:t,roving:!1});break;case an:pn({activeElement:a,direction:"right",elements:t,collapse:!1});break;case rn:pn({activeElement:a,direction:"left",elements:t,collapse:!1});break;case on:hn({activeElement:a,nextElement:t[0]});break;case"End":hn({activeElement:a,nextElement:t[t.length-1]})}})),ue&&t.forEach((e=>{e.addEventListener("focusin",(t=>{e.setAttribute("data-focused","true")})),e.addEventListener("focusout",(t=>{e.removeAttribute("data-focused")}))}))})({el:this.parentEl.querySelector(".settings-tree")})}updateFromLS(){const e=localStorage.getItem("(prefers-reduced-motion: reduce)");if(e){const t="true"===e,n="toggleAnimations",r=this.parentEl.querySelector(`[data-setting-toggle-id="${n}"]`);if(!r)return;r.checked=!t,Mt.fire({media:"(prefers-reduced-motion: reduce)",matches:t})}}toggleOthers({settingId:e,settingValue:t}){Array.from(this.parentEl.querySelectorAll(`[data-toggled-by="${e}"]`)).forEach((e=>{if(t)return e.removeAttribute("disabled"),void e.classList.remove("disabled");e.setAttribute("disabled","true"),e.classList.add("disabled")}))}btnCloseMarkup(){return`\n    <button data-next-focus="true" class="btn-close" aria-label="close settings dropdown" title="close settings">\n      ${Qe}\n    </button>\n    `}settingsMarkup(){const{game:{difficulties:e}}=this.data;return`\n    <div class="settings-tree" role="tree" aria-label="Settings">\n    ${(()=>{const e=gn.filter((e=>1===e.level));return e.map(((t,n)=>vn({parentId:t.id,item:t,ariaLevel:1,ariaSetsize:e.length,ariaPosinset:n+1}))).join("")})()}\n    </div>\n    `}generateMarkup(){return`\n    <button class="btn settings-btn" aria-label="open settings" title="open settings">${Ye}</button>\n    <div class="settings-dropdown" style="display: none;" role="dialog" aria-label="settings" aria-hidden="true" tabindex="-1">\n      <div class="settings-inner">\n        ${this.settingsMarkup()}\n        ${this.btnCloseMarkup()}\n      </div>\n    </div>\n    `}openDropdown(){const{settingsDropdown:e}=this;mt({el:e,removeDisplayNone:!0,onStart:e=>{e.classList.add("active")}}),en.show(),e.setAttribute("aria-hidden","false"),e.focus()}closeDropdown(){const{settingsDropdown:e}=this;yt({el:e,displayNone:!0,onStart:e=>{e.classList.remove("active")}}),en.hide(),window.scrollTo({top:0}),e.setAttribute("aria-hidden","true"),this.handlerMoveAi({delay:200})}addHandlers({handlerSettings:e,handlerMoveAi:t}){this.handlerSettings=e,this.handlerMoveAi=t}updatePlayerSVGMark(e){const t=e.getSvgShape().replace(/filter="url\(#drop-shadow-filter\)"/g,""),n="mini-svg-mark",r=this.parentEl.querySelector('[data-setting-id="player2"] .title'),i=r.querySelector(`.${n}`);i?i.innerHTML=t:r.innerHTML=`${r.textContent} <span class="${n}">${t}</span>`}updateSettings({type:e,value:t}){if("boolean"==typeof t){const n=this.parentEl.querySelector(`[data-type="${e}"]`),r=n.dataset.settingId;return n.checked=t,"aiEnabled"===e?void this.toggleOthers({settingId:r,settingValue:t}):void 0}this.parentEl.querySelector(`[data-type="${e}"][data-value="${t.toLowerCase()}"] input`).checked=!0}},Mn=new class extends nt{constructor(){super({root:"#skip-to-game-menu"}),this.gameMenuExist=!0,this.btn={}}generateMarkup(){return'\n    <a class="btn" href="javascript:void(0)">Skip to Game Menu</a> \n    '}markupDidGenerate(){this.btn=this.parentEl.querySelector(".btn"),this.btn.addEventListener("click",(()=>{const e=document.querySelector("#game-menu [data-focus='true']"),t=document.querySelector('.board .cell[tabindex="0"]');this.gameMenuExist?e.focus():t.focus()}))}updateSkipBtnContent(){this.gameMenuExist=!1,this.btn.textContent="Skip to Game Board"}};const An=({type:e,value:t,updatedFromSettingsView:n=!1})=>{"aiDifficulty"===e&&ce.setAiDifficulty({id:"P2",difficulty:t}),"aiEnabled"===e&&($t.updatePlayAgainst({type:t?"vsAi":"vsHuman"}),$t.updateTooltipMessage(),ce.setPlayerAsHumanOrAI({id:"P2",ai:t})),"firstMove"===e&&ce.setFirstMove(t),n||Tn.updateSettings({type:e,value:t})};var Bn=new class extends nt{constructor(){super({root:"#game-status"})}announce({playerId:e,position:t={column:1,row:1},vs:n,state:r,onlineMultiplayer:i=!1}){this.parentEl.setAttribute("aria-live","assertive"),t.row+=1,t.column+=1;const a=`row ${t.row} column ${t.column}`;let o="P1"===e?"Player 1":"Player 2";"ai"===n&&(o="Computer"),(({currentPlayer:t,nextPlayer:r,state:i})=>{const o=`${t} has moved at ${a}`,s="ai"===n&&"P1"===e;if("move"===i){if(s)return;return"ai"===n&&"P2"===e?void(this.parentEl.textContent=`${o}. It's now Your turn`):void(this.parentEl.textContent=`${o} .It's now ${r}'s turn`)}"tie"===i?this.parentEl.textContent=s?"It's a Tie, game over":`${o}, it's a Tie, game over`:"win"===i&&(this.parentEl.textContent=s?"Congratulations, you won! Game Over!":`${o}, ${t} wins! Game Over!`)})({currentPlayer:o,nextPlayer:"P1"===e?"Player 2":"Player 1",state:r})}},$n=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const In=({column:e,row:t,userActionFromServer:n=!1})=>$n(void 0,void 0,void 0,(function*(){if(!ce.state.game.gameOver){if(Ln({column:e,row:t,userActionFromServer:n}),ce.state.game.gameOver)return Rn();if($t.updatePlayerIndicator(ce.getCurrentPlayer()),ce.getCurrentPlayer().isAI){if(yield Dn(),ce.state.game.gameOver)return Rn();$t.updatePlayerIndicator(ce.getCurrentPlayer())}}})),Ln=({column:e,row:t,userActionFromServer:n})=>{const r=ce.getCurrentPlayer();if(dt.preventPlayerToSelect(),ce.startTurn({column:e,row:t}),ce.state.onlineMultiplayer.active&&!n){const{room:n}=ce.state.onlineMultiplayer;n.send("move",{column:e,row:t})}dt.updateBoard({data:ce.state,player:r}),ce.clearMarkedPositions(),Bn.announce({playerId:r.id,state:"move",position:{column:e,row:t},vs:ce.state.game.hasAI?"ai":"human"}),ce.state.game.hasAI||(ce.state.onlineMultiplayer.active?n&&dt.allowPlayerToSelect():dt.allowPlayerToSelect()),ce.state.game.gameOver&&Bn.announce({playerId:r.id,state:ce.state.game.gameTie?"tie":"win",vs:ce.state.game.hasAI?"ai":"human"})},Dn=({delay:e}={})=>$n(void 0,void 0,void 0,(function*(){if(ce.state.game.gameOver)return;const t=ce.getCurrentPlayer();(t.isAI||"P1"===t.id)&&(dt.preventPlayerToSelect(),yield ce.goAI({delay:e}),dt.updateBoard({data:ce.state,player:t}),dt.allowPlayerToSelect(),Bn.announce({playerId:t.id,position:ce.state.game.markedPositions[0],state:"move",vs:"ai"}),ce.clearMarkedPositions(),ce.state.game.gameOver?Bn.announce({playerId:t.id,state:ce.state.game.gameTie?"tie":"win",vs:"ai"}):dt.allowPlayerToSelect())})),Rn=()=>{const e=ce.state.game.gameTie?800:1200,t=ce.getPlayerById(ce.state.onlineMultiplayer.mainPlayer),n=ce.getWinner(),r=ce.getLoser();let i=n,a="winner";ce.runGameOver(),dt.preventPlayerToSelect(),$t.resetPlayerIndicators(),ce.state.game.gameTie||(ce.increaseWinnerScore(),$t.updatePlayerScore(n)),ce.state.game.hasAI&&ce.getAiPlayer()===n&&(a="loser",i=r),ce.state.onlineMultiplayer.active&&t!==n&&(a="loser",i=r),setTimeout((()=>{Zt.renderGameOverMenu({declare:a,player:i,tie:ce.state.game.gameTie}),dt.preGame(),$t.updatePlayerBtnsOnPreGame()}),e)},Gn=({player:e,color:t,prevColor:n,userActionFromServer:r})=>{if(ce.state.onlineMultiplayer.active&&!r){const{room:r}=ce.state.onlineMultiplayer;return void r.send("pickSkin",{type:"color",value:t,prevValue:n,playerId:e.id})}ce.setPlayerCurrentColor({player:e,color:t}),Xt.updateShapeColors(ce.state.players),dt.updateWinnerSlashColor(e.color),ce.state.game.gameRunning&&ce.state.game.getCurrentPlayer()===e&&$t.updatePlayerIndicator(e);const i=$e({id:e.id,players:ce.state.players});$t.updateSkinDisabledInDropdown({id:i.id,type:"color",oppositePlayer:e})},On=({player:e,shape:t,prevShape:n,userActionFromServer:r})=>{if(ce.state.onlineMultiplayer.active&&!r){const{room:r}=ce.state.onlineMultiplayer;return void r.send("pickSkin",{type:"shape",value:t,prevValue:n,playerId:e.id})}ce.setPlayerCurrentShape({player:e,shape:t}),$t.updateSvgMark(e),dt.updateShapeInCells(e),Zt.updatePlayerMark(e),"P2"===e.id&&Tn.updatePlayerSVGMark(e);const i=$e({id:e.id,players:ce.state.players});$t.updateSkinDisabledInDropdown({id:i.id,type:"shape",oppositePlayer:e})};var qn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const _n=()=>{const{room:e}=ce.state.onlineMultiplayer;e&&(e.leave(),Kt.restartOpponentProps(),ce.exitMultiplayer(),$t.showInnerBtn({selectors:["playerOptionsIcon"]}))},Fn=({room:e})=>{e.onMessage("roomCode",(e=>{Ht.setData({roomCode:e}),Ht.transitionStages({type:"room-created"})})),e.onMessage("move",(({column:e,row:t})=>{if(ce.state.game.gameOver){let n=1500;if("visible"===document.visibilityState)return void In({column:e,row:t,userActionFromServer:!0});document.addEventListener("visibilitychange",(function r(){"visible"===document.visibilityState&&(setTimeout((()=>{In({column:e,row:t,userActionFromServer:!0})}),n),document.removeEventListener("visibilitychange",r))}))}else In({column:e,row:t,userActionFromServer:!0})})),e.onMessage("playAgain",(({firstMovePlayer:e})=>{"visible"!==document.visibilityState?document.addEventListener("visibilitychange",(function e(){"visible"===document.visibilityState&&(setTimeout((()=>{Zt.playAgainAndHideMenu()}),1e3),document.removeEventListener("visibilitychange",e))})):Zt.playAgainAndHideMenu()})),e.onMessage("pickSkinPreGame",(({success:e,skin:t,finishedFirst:n,playerId:r})=>{const i=ce.getPlayerById(r);r===ce.state.onlineMultiplayer.mainPlayer?(()=>{if("color"===t.type)return ce.setPlayerCurrentColor({player:i,color:t.value}),Xt.updateShapeColors(ce.state.players),Vt.setData({mainPlayer:ce.getPlayerById(r)}),void Kt.transitionPickSkin({type:"shape"});"shape"===t.type&&(n?Kt.transitionPreGameStage({type:"wait-for-opponent"}):Kt.transitionPreGameStage({type:"preparing-game"}))})():(()=>{const{pickedItems:e}=ce.state.onlineMultiplayer;if(e[t.type])if(e[t.type]===t.value)Kt.failedPick({type:t.type,value:t.value});else{if("color"===t.type)return ce.setPlayerCurrentColor({player:T(r),color:e[t.type]}),Xt.updateShapeColors(ce.state.players),Vt.setData({mainPlayer:T(r)}),void Kt.transitionPickSkin({type:"shape"});"shape"===t.type&&Kt.transitionPreGameStage({type:"preparing-game"})}Kt.showOpponentClaimedPick({type:t.type,item:t.value})})(),"color"===t.type&&ce.setPlayerCurrentColor({player:i,color:t.value}),"shape"===t.type&&ce.setPlayerCurrentShape({player:i,shape:t.value})})),e.onMessage("countDownPickSkin",(t=>{Kt.hasRendered&&(Kt.updateCountDown(t),0===t&&(e.send("prepareGame",!0),Kt.transitionPreGameStage({type:"preparing-game"})))})),e.onMessage("readyPlayers",(e=>qn(void 0,void 0,void 0,(function*(){const{id:t,isHost:n,roomType:r}=e,i=t,a="P1"===t?"P2":"P1";ce.setMultiplayerPlayers({mainPlayer:i,opponentPlayer:a}),Hn(),Vt.setData({players:ce.state.players,mainPlayer:ce.getPlayerById(i)}),Kt.setData({joinBy:"public",players:ce.state.players,mainPlayer:ce.getPlayerById(i)}),"private"===r&&(n?Kt.setData({joinBy:"created-private"}):Kt.setData({joinBy:"private"}),yield Vt.transitionBetweenLobbyTypes({type:"enter-pre-game"})),Kt.transitionPreGameStage({type:"found-players"}),Kt.transitionPreGameStage({type:"pick-skins"}),$t.hideInnerBtn({selectors:["playerMark","playerOptionsIcon"]}),$t.disableBtns(),$t.updatePlayAgainst({type:"multiplayer"})})))),e.onMessage("declarePlayers",(e=>{if(!e)return;const t=ce.getPlayerById(ce.state.onlineMultiplayer.mainPlayer),n=ce.getPlayerById(ce.state.onlineMultiplayer.opponentPlayer);for(const t in e){const{color:n,shape:r}=e[t],i=ce.getPlayerById(t);ce.setPlayerCurrentColor({color:n,player:i}),ce.setPlayerCurrentShape({shape:r,player:i}),$t.updateSvgMark(i)}$t.updateSkinSelectionInDropdown({player:t,type:["color","shape"]}),$t.updateSkinDisabledInDropdown({id:t.id,oppositePlayer:n,type:["color","shape"]}),Xt.updateShapeColors(ce.state.players),Vt.hideAndRemoveCountDownMarkup({duration:50}),$t.enableBtn(t.id),$t.showInnerBtn({playerId:t.id,selectors:["playerMark","playerOptionsIcon"]}),$t.showInnerBtn({playerId:n.id,selectors:["playerMark"]}),$t.disableBtn(n.id),Vt.setData({players:ce.state.players,mainPlayer:t}),Xt.updateDropShadow("rgba(0,0,0, 0.3)"),Zt.changeMenuTheme("menu"),Zt.hideBtnNavigationBack(),Kt.transitionPreGameStage({type:"declare-players"}),setTimeout((()=>{Vt.destroy(),Zt.startGameAndHideMenu({firstMovePlayer:"P1"})}),3300)})),e.onMessage("busyPlayers",(e=>{e<=1||Kt.updateBusyPlayers(e)})),e.onMessage("pickSkin",(({playerId:e,skin:t,success:n})=>{const r=ce.getPlayerById(e),i=ce.getOppositePlayer(e);if(!n)return"color"===t.type&&(ce.setPlayerCurrentColor({player:r,color:t.value}),ce.setPlayerCurrentColor({player:i,color:t.value})),"shape"===t.type&&(ce.setPlayerCurrentShape({player:r,shape:t.value}),ce.setPlayerCurrentShape({player:i,shape:t.value})),$t.updateSkinSelectionInDropdown({player:r,type:t.type}),void $t.updateSkinDisabledInDropdown({id:i.id,oppositePlayer:r,type:t.type});"color"===t.type&&Gn({player:r,color:t.value,userActionFromServer:!0}),"shape"===t.type&&On({player:r,shape:t.value,userActionFromServer:!0})})),e.onMessage("opponentLeft",(()=>{if(Kt.hasRendered)return Zt.changeMenuTheme("lobby"),Kt.hideAndRemoveCountDownMarkup(),Kt.transitionPreGameStage({type:"player-left"}),void setTimeout((()=>{Kt.transitionPreGameStage({type:"find-players"})}),1e3);const e=ce.getPlayerById(ce.state.onlineMultiplayer.opponentPlayer);ce.runGameOver(),dt.preventPlayerToSelect(),$t.resetPlayerIndicators(),setTimeout((()=>{Zt.renderGameOverMenu({declare:"winner",player:e,playerLeft:!0}),dt.preGame(),$t.updatePlayerBtnsOnPreGame()}),800)}))},Hn=()=>{const{mainPlayer:e,opponentPlayer:t}=ce.state.onlineMultiplayer;[e,t].forEach((e=>{const t=ce.getPlayerById(e);ce.setPlayerCurrentColor({player:t,color:""}),ce.setPlayerCurrentShape({player:t,shape:""})}))};localStorage.clear(),ce.updateStateFromLS(),ce.setRoomCodeFromUrlParams(),ce.setShapes((e=>{const t={};return e.forEach((({id:e})=>{t[e]=(e=>{const t=["%primaryColor%","%secondaryColor%","#drop-shadow-filter"];return{circle:Be({svg:He,id:`-circle-${e}`,ignoreClass:["animate__circle-left","animate__circle-right"],ignoreUrl:t}),cross:Be({svg:je,id:`-cross-${e}`,ignoreClass:["animate__right-dot","animate__left-dot","animate__right-line","animate__left-line"],ignoreUrl:t}).replace("%primaryColor%",`#a-primaryColor-${e}`).replace("%secondaryColor%",`#a-secondaryColor-${e}`),triangle:Be({svg:Ne,id:`-triangle-${e}`,ignoreClass:["animate__first-line","animate__second-line","animate__third-line"],ignoreUrl:t}),heart:Be({svg:Ue,id:`-heart-${e}`,ignoreClass:["animate__heart"],ignoreUrl:t}),square:Be({svg:We,id:`-square-${e}`,ignoreClass:["animate__square-dot-1","animate__square-dot-2","animate__square-dot-3","animate__square-dot-4","animate__square-line-1","animate__square-line-2","animate__square-line-3","animate__square-line-4"],ignoreUrl:t}).replace(/%primaryColor%/g,`#a-primaryColor-${e}`).replace(/%secondaryColor%/g,`#a-secondaryColor-${e}`),kite:Be({svg:Ke,id:`-kite-${e}`,ignoreUrl:t}).replace(/%primaryColor%/g,`#a-primaryColor-${e}`)}})(e)})),t})(ce.state.players)),Nt.setData({roomCode:ce.state.onlineMultiplayer.roomCode}),Xt.render(ce.state.players),$t.render(ce.state),dt.render(ce.state),Zt.render({players:ce.state.players,roomCode:ce.state.onlineMultiplayer.roomCode}),Mn.render(),Tn.render(ce.state),$t.addHandlers({handlerChangeColor:Gn,handlerChangeShape:On}),Zt.addHandlers({handlerStartGame:({ai:e,firstMovePlayer:t,difficulty:n,triggeredByClick:r=!0})=>{ce.startGame(),ce.setPlayerAsHumanOrAI({id:"P2",ai:e}),ce.setAiDifficulty({id:"P2",difficulty:n}),ce.state.onlineMultiplayer.active||ce.setCurrentPlayer(t),$t.updatePlayerBtnsOnGameStart(),dt.startingGameTriggeredByKeyboard=!r,dt.startGame(),Xt.updateDropShadow("rgba(0, 0, 0, 0.35)"),e?dt.preventPlayerToSelect():dt.allowPlayerToSelect();const i=ce.getCurrentPlayer().id;ce.state.onlineMultiplayer.active&&(i===ce.state.onlineMultiplayer.mainPlayer?dt.allowPlayerToSelect():dt.preventPlayerToSelect()),$t.updatePlayerIndicator(ce.getCurrentPlayer()),Mn.updateSkipBtnContent(),e&&Dn()},handlerPlayAgain:({triggeredByClick:e=!0,firstMovePlayer:t})=>{return n=void 0,r=void 0,a=function*(){ce.state.onlineMultiplayer.active&&(({triggeredByClick:e})=>{const{room:t}=ce.state.onlineMultiplayer;t&&t.send("playAgainNow",!0)})({triggeredByClick:e}),ce.setNextPlayerForFirstMove({firstMovePlayer:t}),ce.resetForNextGame(),dt.clearBoard(),dt.startingGameTriggeredByKeyboard=!e,dt.startGame(),$t.updatePlayerBtnsOnGameStart();const n=ce.getAiPlayer(),r=ce.getCurrentPlayer();if(ce.state.game.hasAI){const e=ce.getOppositePlayer(n.id);ce.randomChangePlayerSkin(n),Xt.updateShapeColors(ce.state.players),$t.updateSvgMark(n),Tn.updatePlayerSVGMark(n),$t.updateSkinSelectionInDropdown({type:["color","shape"],player:n}),$t.updateSkinDisabledInDropdown({id:e.id,type:["color","shape"],oppositePlayer:n})}if(r.isAI?dt.preventPlayerToSelect():dt.allowPlayerToSelect(),ce.state.onlineMultiplayer.active&&(r.id===ce.state.onlineMultiplayer.mainPlayer?dt.allowPlayerToSelect():dt.preventPlayerToSelect()),r.isAI)return $t.updatePlayerIndicator(ce.getAiPlayer()),yield Dn(),void $t.updatePlayerIndicator(ce.getCurrentPlayer());$t.updatePlayerIndicator(r)},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a},handlerSettings:An,handlerLeaveGame:()=>{ce.resetForNextGame(),ce.resetPlayersScore(),dt.clearBoard(),ce.state.players.forEach((e=>{$t.updatePlayerScore(e)}))},handlerExitMultiplayer:_n}),Vt.addHandlers({handlerCreateRoom:()=>qn(void 0,void 0,void 0,(function*(){try{const e=new((yield Promise.all([i.e(767),i.e(48)]).then(i.bind(i,767))).Client)("ws://multiplayer-3nrow.onrender.com"),t=yield e.create("private",{isPrivate:!0});ce.setRoom(t),Fn({room:t})}catch(e){}})),handlerJoinRoom:({type:e,password:t})=>qn(void 0,void 0,void 0,(function*(){try{const n=new((yield Promise.all([i.e(767),i.e(48)]).then(i.bind(i,767))).Client)(ce.state.onlineMultiplayer.serverWS);let r=null;if("public"===e&&(r=yield n.joinOrCreate(e)),"private"===e&&(r=yield n.join(e,{password:t})),ce.setRoom(r),Fn({room:r}),"private"===e)return;Kt.transitionPreGameStage({type:"find-players"})}catch(t){if(console.error(t),"private"===e){const e=t="Room doesn't exist";return Nt.setData({isLocating:!1}),void setTimeout((()=>{Nt.displayRoomError(e),Nt.displaySubmitArea({type:"join-btn"})}),500)}}})),handlerPickSkin:({type:e,item:t})=>{const{room:n,pickedItems:r}=ce.state.onlineMultiplayer,i=ce.getPlayerById(ce.state.onlineMultiplayer.mainPlayer),a=ce.state.onlineMultiplayer.opponentPlayer,o=ce.getPlayerById(a);n&&(ce.setPickedSkinInLobby({type:e,item:t}),"color"===e&&o.color&&(ce.setPlayerCurrentColor({player:i,color:t}),Xt.updateShapeColors(ce.state.players),Kt.setData({mainPlayer:i}),Kt.transitionPickSkin({type:"shape"})),"shape"===e&&o.shape&&Kt.transitionPreGameStage({type:"preparing-game"}),n.send("pickSkinPreGame",{type:e,value:t,playerId:ce.state.onlineMultiplayer.mainPlayer}))},handlerExitMultiplayer:_n,handlerConnectServer:()=>{return e=void 0,t=void 0,r=function*(){const e=`${ce.state.onlineMultiplayer.serverUrl}/is-online`;try{const t=yield fetch(e);if(!(yield t.json()).success)throw new Error;if(!Vt.hasRendered)return;Vt.transitionSection({type:"menuBtns"})}catch(e){if(!Vt.hasRendered)return}},new((n=void 0)||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}));var e,t,n,r}}),Tn.addHandlers({handlerSettings:An,handlerMoveAi:Dn}),dt.addHandlerCell(In),Gt.runResizeListener(),Gt.revealAfterPageLoad()}();